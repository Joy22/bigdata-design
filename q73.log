22/07/26 14:21:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
22/07/26 14:21:07 INFO SparkContext: Running Spark version 3.1.1
22/07/26 14:21:07 INFO ResourceUtils: ==============================================================
22/07/26 14:21:07 INFO ResourceUtils: No custom resources configured for spark.driver.
22/07/26 14:21:07 INFO ResourceUtils: ==============================================================
22/07/26 14:21:07 INFO SparkContext: Submitted application: test-sql-context
22/07/26 14:21:07 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 3072, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
22/07/26 14:21:07 INFO ResourceProfile: Limiting resource is cpu
22/07/26 14:21:07 INFO ResourceProfileManager: Added ResourceProfile id: 0
22/07/26 14:21:07 INFO SecurityManager: Changing view acls to: root
22/07/26 14:21:07 INFO SecurityManager: Changing modify acls to: root
22/07/26 14:21:07 INFO SecurityManager: Changing view acls groups to: 
22/07/26 14:21:07 INFO SecurityManager: Changing modify acls groups to: 
22/07/26 14:21:07 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
22/07/26 14:21:08 INFO Utils: Successfully started service 'sparkDriver' on port 46707.
22/07/26 14:21:08 INFO SparkEnv: Registering MapOutputTracker
22/07/26 14:21:08 INFO SparkEnv: Registering BlockManagerMaster
22/07/26 14:21:08 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
22/07/26 14:21:08 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
22/07/26 14:21:08 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
22/07/26 14:21:08 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-444ccc21-54c0-448e-9837-f02307f4f12f
22/07/26 14:21:08 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
22/07/26 14:21:08 INFO SparkEnv: Registering OutputCommitCoordinator
22/07/26 14:21:08 INFO Utils: Successfully started service 'SparkUI' on port 4040.
22/07/26 14:21:08 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://szcdoc01:4040
22/07/26 14:21:08 INFO SparkContext: Added JAR file:///data/app/spark-tpcds-datagen/spark-core_2.12-3.1.1-tests.jar at spark://szcdoc01:46707/jars/spark-core_2.12-3.1.1-tests.jar with timestamp 1658816467840
22/07/26 14:21:08 INFO SparkContext: Added JAR file:///data/app/spark-tpcds-datagen/spark-catalyst_2.12-3.1.1-tests.jar at spark://szcdoc01:46707/jars/spark-catalyst_2.12-3.1.1-tests.jar with timestamp 1658816467840
22/07/26 14:21:08 INFO SparkContext: Added JAR file:/data/app/spark-tpcds-datagen/spark-sql_2.12-3.1.1-tests.jar at spark://szcdoc01:46707/jars/spark-sql_2.12-3.1.1-tests.jar with timestamp 1658816467840
22/07/26 14:21:08 INFO Executor: Starting executor ID driver on host szcdoc01
22/07/26 14:21:08 INFO Executor: Fetching spark://szcdoc01:46707/jars/spark-sql_2.12-3.1.1-tests.jar with timestamp 1658816467840
22/07/26 14:21:08 INFO TransportClientFactory: Successfully created connection to szcdoc01/172.16.0.12:46707 after 26 ms (0 ms spent in bootstraps)
22/07/26 14:21:08 INFO Utils: Fetching spark://szcdoc01:46707/jars/spark-sql_2.12-3.1.1-tests.jar to /tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d/userFiles-d58230f6-1f80-44fc-b69b-92aae948934a/fetchFileTemp3790784391402588382.tmp
22/07/26 14:21:09 INFO Executor: Adding file:/tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d/userFiles-d58230f6-1f80-44fc-b69b-92aae948934a/spark-sql_2.12-3.1.1-tests.jar to class loader
22/07/26 14:21:09 INFO Executor: Fetching spark://szcdoc01:46707/jars/spark-catalyst_2.12-3.1.1-tests.jar with timestamp 1658816467840
22/07/26 14:21:09 INFO Utils: Fetching spark://szcdoc01:46707/jars/spark-catalyst_2.12-3.1.1-tests.jar to /tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d/userFiles-d58230f6-1f80-44fc-b69b-92aae948934a/fetchFileTemp8829077870405364527.tmp
22/07/26 14:21:09 INFO Executor: Adding file:/tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d/userFiles-d58230f6-1f80-44fc-b69b-92aae948934a/spark-catalyst_2.12-3.1.1-tests.jar to class loader
22/07/26 14:21:09 INFO Executor: Fetching spark://szcdoc01:46707/jars/spark-core_2.12-3.1.1-tests.jar with timestamp 1658816467840
22/07/26 14:21:09 INFO Utils: Fetching spark://szcdoc01:46707/jars/spark-core_2.12-3.1.1-tests.jar to /tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d/userFiles-d58230f6-1f80-44fc-b69b-92aae948934a/fetchFileTemp1085390888884251899.tmp
22/07/26 14:21:09 INFO Executor: Adding file:/tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d/userFiles-d58230f6-1f80-44fc-b69b-92aae948934a/spark-core_2.12-3.1.1-tests.jar to class loader
22/07/26 14:21:09 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 37657.
22/07/26 14:21:09 INFO NettyBlockTransferService: Server created on szcdoc01:37657
22/07/26 14:21:09 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
22/07/26 14:21:09 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, szcdoc01, 37657, None)
22/07/26 14:21:09 INFO BlockManagerMasterEndpoint: Registering block manager szcdoc01:37657 with 366.3 MiB RAM, BlockManagerId(driver, szcdoc01, 37657, None)
22/07/26 14:21:09 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, szcdoc01, 37657, None)
22/07/26 14:21:09 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, szcdoc01, 37657, None)
22/07/26 14:21:09 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/data/app/spark-tpcds-datagen/spark-warehouse').
22/07/26 14:21:09 INFO SharedState: Warehouse path is 'file:/data/app/spark-tpcds-datagen/spark-warehouse'.
22/07/26 14:21:10 INFO InMemoryFileIndex: It took 31 ms to list leaf files for 1 paths.
22/07/26 14:21:10 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:10 INFO DAGScheduler: Got job 0 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:10 INFO DAGScheduler: Final stage: ResultStage 0 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:10 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:10 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:10 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[1] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:10 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 74.3 KiB, free 366.2 MiB)
22/07/26 14:21:10 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 366.2 MiB)
22/07/26 14:21:10 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.3 MiB)
22/07/26 14:21:10 INFO SparkContext: Created broadcast 0 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:10 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[1] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:10 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
22/07/26 14:21:11 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4705 bytes) taskResourceAssignments Map()
22/07/26 14:21:11 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
22/07/26 14:21:11 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2129 bytes result sent to driver
22/07/26 14:21:11 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 474 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:11 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
22/07/26 14:21:11 INFO DAGScheduler: ResultStage 0 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.627 s
22/07/26 14:21:11 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:11 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
22/07/26 14:21:11 INFO DAGScheduler: Job 0 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.674873 s
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:11 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.160785917 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:12 INFO BlockManagerInfo: Removed broadcast_0_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.3 MiB)
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.003618536 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.08714831 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [catalog_page], [], false   SubqueryAlias catalog_page
!                                                +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [catalog_page], [], false   SubqueryAlias catalog_page
!                                                +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
          
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.010662594 seconds
Total number of effective runs: 1
Total time of effective runs: 0.003930734 seconds
      
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#37L]                                                                                                                                                               Aggregate [count(1) AS count#37L]
 +- SubqueryAlias catalog_page                                                                                                                                                                   +- SubqueryAlias catalog_page
    +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet      +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#37L]                                                                                                                                                               Aggregate [count(1) AS count#37L]
 +- SubqueryAlias catalog_page                                                                                                                                                                   +- SubqueryAlias catalog_page
    +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet      +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
          
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.096777036 seconds
Total number of effective runs: 1
Total time of effective runs: 6.83889E-4 seconds
      
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#37L]                                                                                                                                                               Aggregate [count(1) AS count#37L]
!+- SubqueryAlias catalog_page                                                                                                                                                                   +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
!   +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet   
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#37L]                                                                                                                                                               Aggregate [count(1) AS count#37L]
!+- SubqueryAlias catalog_page                                                                                                                                                                   +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
!   +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet   
          
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#37L]                                                                                                                                                            Aggregate [count(1) AS count#37L]
!+- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet   +- Project
!                                                                                                                                                                                                +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#37L]                                                                                                                                                            Aggregate [count(1) AS count#37L]
!+- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet   +- Project
!                                                                                                                                                                                                +- Relation[cp_catalog_page_sk#0,cp_catalog_page_id#1,cp_start_date_sk#2,cp_end_date_sk#3,cp_department#4,cp_catalog_number#5,cp_catalog_page_number#6,cp_description#7,cp_type#8] parquet
          
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.039057866 seconds
Total number of effective runs: 2
Total time of effective runs: 0.001260849 seconds
      
22/07/26 14:21:13 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:13 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:13 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#37L])                                                                                                                                                                       HashAggregate(keys=[], functions=[count(1)], output=[count#37L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#13]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#37L])                                                                                                                                                                          HashAggregate(keys=[], functions=[count(1)], output=[count#37L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#13]                                                                                                                                                                                +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#17]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])                                                                                                                                                               +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#37L])                                                                                                                                                                             *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#37L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#17]                                                                                                                                                                                   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#23]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])                                                                                                                                                                  +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])
!      +- ColumnarToRow                                                                                                                                                                                                                             +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:13 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#37L])                                                                                                                                                                       *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#37L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#23]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#40L])
!                                                                                                                                                                                                                                             +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:14 INFO CodeGenerator: Code generated in 223.24376 ms
22/07/26 14:21:14 INFO CodeGenerator: Code generated in 19.920033 ms
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 292.3 KiB, free 366.0 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 366.0 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.3 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 1 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:14 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4889417 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:14 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:14 INFO DAGScheduler: Registering RDD 5 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 0
22/07/26 14:21:14 INFO DAGScheduler: Got job 1 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:14 INFO DAGScheduler: Final stage: ResultStage 2 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:14 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 1)
22/07/26 14:21:14 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 1)
22/07/26 14:21:14 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[5] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 14.7 KiB, free 366.0 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 366.0 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.3 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:14 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[5] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:14 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
22/07/26 14:21:14 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4945 bytes) taskResourceAssignments Map()
22/07/26 14:21:14 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
22/07/26 14:21:14 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_page/part-00000-0b42869d-ab36-4d35-8e9b-1b6a6e59c576-c000.snappy.parquet, range: 0-695113, partition values: [empty row]
22/07/26 14:21:14 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 2175 bytes result sent to driver
22/07/26 14:21:14 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 185 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:14 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
22/07/26 14:21:14 INFO DAGScheduler: ShuffleMapStage 1 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.215 s
22/07/26 14:21:14 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:14 INFO DAGScheduler: running: Set()
22/07/26 14:21:14 INFO DAGScheduler: waiting: Set(ResultStage 2)
22/07/26 14:21:14 INFO DAGScheduler: failed: Set()
22/07/26 14:21:14 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[8] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 10.1 KiB, free 366.0 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 366.0 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.3 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:14 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[8] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:14 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks resource profile 0
22/07/26 14:21:14 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 2) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:14 INFO Executor: Running task 0.0 in stage 2.0 (TID 2)
22/07/26 14:21:14 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:14 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 8 ms
22/07/26 14:21:14 INFO Executor: Finished task 0.0 in stage 2.0 (TID 2). 2648 bytes result sent to driver
22/07/26 14:21:14 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 2) in 55 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:14 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
22/07/26 14:21:14 INFO DAGScheduler: ResultStage 2 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.068 s
22/07/26 14:21:14 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:14 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
22/07/26 14:21:14 INFO DAGScheduler: Job 1 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.310049 s
22/07/26 14:21:14 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:14 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:14 INFO DAGScheduler: Got job 2 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:14 INFO DAGScheduler: Final stage: ResultStage 3 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:14 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:14 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:14 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[10] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 74.3 KiB, free 365.9 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.9 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:14 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[10] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:14 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
22/07/26 14:21:14 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4708 bytes) taskResourceAssignments Map()
22/07/26 14:21:14 INFO Executor: Running task 0.0 in stage 3.0 (TID 3)
22/07/26 14:21:14 INFO Executor: Finished task 0.0 in stage 3.0 (TID 3). 3565 bytes result sent to driver
22/07/26 14:21:14 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 20 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:14 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
22/07/26 14:21:14 INFO DAGScheduler: ResultStage 3 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.034 s
22/07/26 14:21:14 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:14 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
22/07/26 14:21:14 INFO DAGScheduler: Job 2 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.037620 s
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.002247127 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001131315 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001429707 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:14 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [catalog_returns], [], false   SubqueryAlias catalog_returns
!                                                   +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [catalog_returns], [], false   SubqueryAlias catalog_returns
!                                                   +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
          
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.002169303 seconds
Total number of effective runs: 1
Total time of effective runs: 1.11482E-4 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Aggregate [count(1) AS count#150L]
 +- SubqueryAlias catalog_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias catalog_returns
    +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet      +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Aggregate [count(1) AS count#150L]
 +- SubqueryAlias catalog_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias catalog_returns
    +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet      +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
          
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.002761406 seconds
Total number of effective runs: 1
Total time of effective runs: 4.2119E-5 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Aggregate [count(1) AS count#150L]
!+- SubqueryAlias catalog_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
!   +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet   
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Aggregate [count(1) AS count#150L]
!+- SubqueryAlias catalog_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
!   +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet   
          
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Aggregate [count(1) AS count#150L]
!+- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Aggregate [count(1) AS count#150L]
!+- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Relation[cr_returned_date_sk#41,cr_returned_time_sk#42,cr_item_sk#43,cr_refunded_customer_sk#44,cr_refunded_cdemo_sk#45,cr_refunded_hdemo_sk#46,cr_refunded_addr_sk#47,cr_returning_customer_sk#48,cr_returning_cdemo_sk#49,cr_returning_hdemo_sk#50,cr_returning_addr_sk#51,cr_call_center_sk#52,cr_catalog_page_sk#53,cr_ship_mode_sk#54,cr_warehouse_sk#55,cr_reason_sk#56,cr_order_number#57,cr_return_quantity#58,cr_return_amount#59,cr_return_tax#60,cr_return_amt_inc_tax#61,cr_fee#62,cr_return_ship_cost#63,cr_refunded_cash#64,... 3 more fields] parquet
          
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.00837318 seconds
Total number of effective runs: 2
Total time of effective runs: 3.236E-4 seconds
      
22/07/26 14:21:14 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:14 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:14 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#150L])                                                                                                                                                                         HashAggregate(keys=[], functions=[count(1)], output=[count#150L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#40]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#150L])                                                                                                                                                                            HashAggregate(keys=[], functions=[count(1)], output=[count#150L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#40]                                                                                                                                                                                   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#44]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])                                                                                                                                                                 +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#150L])                                                                                                                                                                               *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#150L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#44]                                                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#50]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])                                                                                                                                                                    +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])
!      +- ColumnarToRow                                                                                                                                                                                                                                +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#150L])                                                                                                                                                                         *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#150L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#50]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#153L])
!                                                                                                                                                                                                                                                +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 292.3 KiB, free 365.6 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.5 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 5 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:14 INFO FileSourceScanExec: Planning scan with bin packing, max size: 14574465 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:14 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:14 INFO DAGScheduler: Registering RDD 14 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 1
22/07/26 14:21:14 INFO DAGScheduler: Got job 3 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:14 INFO DAGScheduler: Final stage: ResultStage 5 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:14 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
22/07/26 14:21:14 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 4)
22/07/26 14:21:14 INFO DAGScheduler: Submitting ShuffleMapStage 4 (MapPartitionsRDD[14] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 14.7 KiB, free 365.5 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.5 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:14 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 4 (MapPartitionsRDD[14] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:14 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
22/07/26 14:21:14 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 4) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4948 bytes) taskResourceAssignments Map()
22/07/26 14:21:14 INFO Executor: Running task 0.0 in stage 4.0 (TID 4)
22/07/26 14:21:14 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_returns/part-00000-ad72d709-fc75-4278-8ff9-653e422afe8c-c000.snappy.parquet, range: 0-10380161, partition values: [empty row]
22/07/26 14:21:14 INFO Executor: Finished task 0.0 in stage 4.0 (TID 4). 2132 bytes result sent to driver
22/07/26 14:21:14 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 4) in 21 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:14 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
22/07/26 14:21:14 INFO DAGScheduler: ShuffleMapStage 4 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.028 s
22/07/26 14:21:14 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:14 INFO DAGScheduler: running: Set()
22/07/26 14:21:14 INFO DAGScheduler: waiting: Set(ResultStage 5)
22/07/26 14:21:14 INFO DAGScheduler: failed: Set()
22/07/26 14:21:14 INFO DAGScheduler: Submitting ResultStage 5 (MapPartitionsRDD[17] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 10.1 KiB, free 365.5 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.5 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:14 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 5 (MapPartitionsRDD[17] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:14 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
22/07/26 14:21:14 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 5) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:14 INFO Executor: Running task 0.0 in stage 5.0 (TID 5)
22/07/26 14:21:14 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:14 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:14 INFO Executor: Finished task 0.0 in stage 5.0 (TID 5). 2648 bytes result sent to driver
22/07/26 14:21:14 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 5) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:14 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
22/07/26 14:21:14 INFO DAGScheduler: ResultStage 5 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.015 s
22/07/26 14:21:14 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:14 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
22/07/26 14:21:14 INFO DAGScheduler: Job 3 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.049222 s
22/07/26 14:21:14 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:14 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:14 INFO DAGScheduler: Got job 4 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:14 INFO DAGScheduler: Final stage: ResultStage 6 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:14 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:14 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:14 INFO DAGScheduler: Submitting ResultStage 6 (MapPartitionsRDD[19] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 74.3 KiB, free 365.4 MiB)
22/07/26 14:21:14 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.4 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:14 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 6 (MapPartitionsRDD[19] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:14 INFO TaskSchedulerImpl: Adding task set 6.0 with 1 tasks resource profile 0
22/07/26 14:21:14 INFO TaskSetManager: Starting task 0.0 in stage 6.0 (TID 6) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4701 bytes) taskResourceAssignments Map()
22/07/26 14:21:14 INFO Executor: Running task 0.0 in stage 6.0 (TID 6)
22/07/26 14:21:14 INFO BlockManagerInfo: Removed broadcast_7_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Removed broadcast_4_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO Executor: Finished task 0.0 in stage 6.0 (TID 6). 2498 bytes result sent to driver
22/07/26 14:21:14 INFO BlockManagerInfo: Removed broadcast_6_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO TaskSetManager: Finished task 0.0 in stage 6.0 (TID 6) in 34 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:14 INFO TaskSchedulerImpl: Removed TaskSet 6.0, whose tasks have all completed, from pool 
22/07/26 14:21:14 INFO DAGScheduler: ResultStage 6 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.049 s
22/07/26 14:21:14 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:14 INFO TaskSchedulerImpl: Killing all running tasks in stage 6: Stage finished
22/07/26 14:21:14 INFO DAGScheduler: Job 4 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.051886 s
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001527124 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:14 INFO BlockManagerInfo: Removed broadcast_2_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:14 INFO BlockManagerInfo: Removed broadcast_3_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 INFO BlockManagerInfo: Removed broadcast_5_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 9.81496E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001440387 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [customer], [], false   SubqueryAlias customer
!                                            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [customer], [], false   SubqueryAlias customer
!                                            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:14 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.001373436 seconds
Total number of effective runs: 1
Total time of effective runs: 1.03387E-4 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#227L]                                                                                                                                                                                                                                                                                                                                                               Aggregate [count(1) AS count#227L]
 +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                        +- SubqueryAlias customer
    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet      +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#227L]                                                                                                                                                                                                                                                                                                                                                               Aggregate [count(1) AS count#227L]
 +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                        +- SubqueryAlias customer
    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet      +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001936315 seconds
Total number of effective runs: 1
Total time of effective runs: 3.5102E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#227L]                                                                                                                                                                                                                                                                                                                                                               Aggregate [count(1) AS count#227L]
!+- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!   +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet   
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#227L]                                                                                                                                                                                                                                                                                                                                                               Aggregate [count(1) AS count#227L]
!+- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!   +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet   
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#227L]                                                                                                                                                                                                                                                                                                                                                            Aggregate [count(1) AS count#227L]
!+- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                 +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#227L]                                                                                                                                                                                                                                                                                                                                                            Aggregate [count(1) AS count#227L]
!+- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                 +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.006078206 seconds
Total number of effective runs: 2
Total time of effective runs: 2.49008E-4 seconds
      
22/07/26 14:21:15 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#227L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#227L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#67]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])
!                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#227L])                                                                                                                                                                     HashAggregate(keys=[], functions=[count(1)], output=[count#227L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#67]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#71]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])                                                                                                                                                          +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#227L])                                                                                                                                                                        *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#227L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#71]                                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#77]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])                                                                                                                                                             +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])
!      +- ColumnarToRow                                                                                                                                                                                                                         +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#227L])                                                                                                                                                                  *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#227L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#77]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#230L])
!                                                                                                                                                                                                                                         +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 292.3 KiB, free 365.6 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.6 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 9 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 9766600 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Registering RDD 23 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 2
22/07/26 14:21:15 INFO DAGScheduler: Got job 5 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 8 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 7)
22/07/26 14:21:15 INFO DAGScheduler: Submitting ShuffleMapStage 7 (MapPartitionsRDD[23] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 14.7 KiB, free 365.6 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.6 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 7 (MapPartitionsRDD[23] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 7) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4941 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 7.0 (TID 7)
22/07/26 14:21:15 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer/part-00000-16283de9-1d2e-49c8-993a-bc0ba4e0a35b-c000.snappy.parquet, range: 0-5572296, partition values: [empty row]
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 7.0 (TID 7). 2132 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 7) in 19 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ShuffleMapStage 7 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.026 s
22/07/26 14:21:15 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:15 INFO DAGScheduler: running: Set()
22/07/26 14:21:15 INFO DAGScheduler: waiting: Set(ResultStage 8)
22/07/26 14:21:15 INFO DAGScheduler: failed: Set()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[26] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 10.1 KiB, free 365.6 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.5 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[26] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 8) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 8.0 (TID 8)
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 8.0 (TID 8). 2648 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 8) in 6 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 8 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:15 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 5 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.042983 s
22/07/26 14:21:15 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Got job 6 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 9 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[28] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 74.3 KiB, free 365.5 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.4 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[28] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 9) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4709 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 9.0 (TID 9)
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 9.0 (TID 9). 2594 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 9) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 9 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.025 s
22/07/26 14:21:15 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 6 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.028538 s
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001548967 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.92293E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001290528 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [customer_address], [], false   SubqueryAlias customer_address
!                                                    +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [customer_address], [], false   SubqueryAlias customer_address
!                                                    +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.001307241 seconds
Total number of effective runs: 1
Total time of effective runs: 1.02922E-4 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#284L]                                                                                                                                                                                                                   Aggregate [count(1) AS count#284L]
 +- SubqueryAlias customer_address                                                                                                                                                                                                                    +- SubqueryAlias customer_address
    +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet      +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#284L]                                                                                                                                                                                                                   Aggregate [count(1) AS count#284L]
 +- SubqueryAlias customer_address                                                                                                                                                                                                                    +- SubqueryAlias customer_address
    +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet      +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001566644 seconds
Total number of effective runs: 1
Total time of effective runs: 3.7498E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#284L]                                                                                                                                                                                                                   Aggregate [count(1) AS count#284L]
!+- SubqueryAlias customer_address                                                                                                                                                                                                                    +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
!   +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet   
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#284L]                                                                                                                                                                                                                   Aggregate [count(1) AS count#284L]
!+- SubqueryAlias customer_address                                                                                                                                                                                                                    +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
!   +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet   
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#284L]                                                                                                                                                                                                                Aggregate [count(1) AS count#284L]
!+- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet   +- Project
!                                                                                                                                                                                                                                                     +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#284L]                                                                                                                                                                                                                Aggregate [count(1) AS count#284L]
!+- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet   +- Project
!                                                                                                                                                                                                                                                     +- Relation[ca_address_sk#231,ca_address_id#232,ca_street_number#233,ca_street_name#234,ca_street_type#235,ca_suite_number#236,ca_city#237,ca_county#238,ca_state#239,ca_zip#240,ca_country#241,ca_gmt_offset#242,ca_location_type#243] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.005399542 seconds
Total number of effective runs: 2
Total time of effective runs: 4.70569E-4 seconds
      
22/07/26 14:21:15 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#284L])                                                                                                                                                                          HashAggregate(keys=[], functions=[count(1)], output=[count#284L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#94]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])
!                                                                                                                                                                                                                                                 +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#284L])                                                                                                                                                                             HashAggregate(keys=[], functions=[count(1)], output=[count#284L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#94]                                                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#98]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])                                                                                                                                                                  +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                       +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#284L])                                                                                                                                                                                *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#284L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#98]                                                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#104]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])                                                                                                                                                                     +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])
!      +- ColumnarToRow                                                                                                                                                                                                                                 +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#284L])                                                                                                                                                                          *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#284L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#104]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#287L])
!                                                                                                                                                                                                                                                 +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                    +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 292.3 KiB, free 365.2 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 13 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 5254093 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Registering RDD 32 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 3
22/07/26 14:21:15 INFO DAGScheduler: Got job 7 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 11 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 10)
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 10)
22/07/26 14:21:15 INFO DAGScheduler: Submitting ShuffleMapStage 10 (MapPartitionsRDD[32] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 14.7 KiB, free 365.1 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 10 (MapPartitionsRDD[32] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 10) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4949 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 10.0 (TID 10)
22/07/26 14:21:15 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer_address/part-00000-3a295961-9d87-444e-b976-a84a348b4436-c000.snappy.parquet, range: 0-1059789, partition values: [empty row]
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 10.0 (TID 10). 2132 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 10) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ShuffleMapStage 10 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.019 s
22/07/26 14:21:15 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:15 INFO DAGScheduler: running: Set()
22/07/26 14:21:15 INFO DAGScheduler: waiting: Set(ResultStage 11)
22/07/26 14:21:15 INFO DAGScheduler: failed: Set()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 11 (MapPartitionsRDD[35] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 10.1 KiB, free 365.1 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 11 (MapPartitionsRDD[35] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 11.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 11) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 11.0 (TID 11)
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 11.0 (TID 11). 2648 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 11) in 6 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 11 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:15 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 11: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 7 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.034971 s
22/07/26 14:21:15 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Got job 8 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 12 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 12 (MapPartitionsRDD[37] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 74.3 KiB, free 365.0 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.0 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 16 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 12 (MapPartitionsRDD[37] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 12.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 12.0 (TID 12) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4714 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 12.0 (TID 12)
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 12.0 (TID 12). 2048 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 12.0 (TID 12) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 12.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 12 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.024 s
22/07/26 14:21:15 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 12: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 8 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.026028 s
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001168427 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.31388E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001252531 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [customer_demographics], [], false   SubqueryAlias customer_demographics
!                                                         +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [customer_demographics], [], false   SubqueryAlias customer_demographics
!                                                         +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.00122963 seconds
Total number of effective runs: 1
Total time of effective runs: 1.00379E-4 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#325L]                                                                                                                                                                                     Aggregate [count(1) AS count#325L]
 +- SubqueryAlias customer_demographics                                                                                                                                                                                 +- SubqueryAlias customer_demographics
    +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet      +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#325L]                                                                                                                                                                                     Aggregate [count(1) AS count#325L]
 +- SubqueryAlias customer_demographics                                                                                                                                                                                 +- SubqueryAlias customer_demographics
    +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet      +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001471865 seconds
Total number of effective runs: 1
Total time of effective runs: 2.8939E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#325L]                                                                                                                                                                                     Aggregate [count(1) AS count#325L]
!+- SubqueryAlias customer_demographics                                                                                                                                                                                 +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
!   +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet   
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#325L]                                                                                                                                                                                     Aggregate [count(1) AS count#325L]
!+- SubqueryAlias customer_demographics                                                                                                                                                                                 +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
!   +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet   
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#325L]                                                                                                                                                                                  Aggregate [count(1) AS count#325L]
!+- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet   +- Project
!                                                                                                                                                                                                                       +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#325L]                                                                                                                                                                                  Aggregate [count(1) AS count#325L]
!+- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet   +- Project
!                                                                                                                                                                                                                       +- Relation[cd_demo_sk#288,cd_gender#289,cd_marital_status#290,cd_education_status#291,cd_purchase_estimate#292,cd_credit_rating#293,cd_dep_count#294,cd_dep_employed_count#295,cd_dep_college_count#296] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.005502844 seconds
Total number of effective runs: 2
Total time of effective runs: 1.72723E-4 seconds
      
22/07/26 14:21:15 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#325L])                                                                                                                                                                               HashAggregate(keys=[], functions=[count(1)], output=[count#325L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])                                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#121]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])
!                                                                                                                                                                                                                                                      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#325L])                                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#325L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#121]                                                                                                                                                                                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#125]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])                                                                                                                                                                       +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#325L])                                                                                                                                                                                     *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#325L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#125]                                                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#131]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])                                                                                                                                                                          +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])
!      +- ColumnarToRow                                                                                                                                                                                                                                      +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#325L])                                                                                                                                                                               *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#325L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])                                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#131]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#328L])
!                                                                                                                                                                                                                                                      +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 292.3 KiB, free 364.7 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.7 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 17 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11959856 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Registering RDD 41 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 4
22/07/26 14:21:15 INFO DAGScheduler: Got job 9 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 14 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 13)
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 13)
22/07/26 14:21:15 INFO DAGScheduler: Submitting ShuffleMapStage 13 (MapPartitionsRDD[41] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 14.7 KiB, free 364.7 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.7 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 13 (MapPartitionsRDD[41] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 13) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4954 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 13.0 (TID 13)
22/07/26 14:21:15 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer_demographics/part-00000-cc3107bd-d55d-4933-839c-93dea4b7adc1-c000.snappy.parquet, range: 0-7765552, partition values: [empty row]
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 13.0 (TID 13). 2132 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 13) in 18 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ShuffleMapStage 13 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.024 s
22/07/26 14:21:15 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:15 INFO DAGScheduler: running: Set()
22/07/26 14:21:15 INFO DAGScheduler: waiting: Set(ResultStage 14)
22/07/26 14:21:15 INFO DAGScheduler: failed: Set()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[44] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_19 stored as values in memory (estimated size 10.1 KiB, free 364.7 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_19_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.7 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_19_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 19 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[44] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 14) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 14.0 (TID 14)
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 14.0 (TID 14). 2648 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 14) in 6 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 14 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:15 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 9 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.040337 s
22/07/26 14:21:15 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Got job 10 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 15 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 15 (MapPartitionsRDD[46] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_20 stored as values in memory (estimated size 74.3 KiB, free 364.6 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_20_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.6 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_20_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 20 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 15 (MapPartitionsRDD[46] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 15.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 15.0 (TID 15) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4701 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 15.0 (TID 15)
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 15.0 (TID 15). 2849 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 15.0 (TID 15) in 13 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 15.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 15 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.027 s
22/07/26 14:21:15 INFO DAGScheduler: Job 10 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 15: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 10 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.029571 s
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001461247 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.11124E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001153083 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [date_dim], [], false   SubqueryAlias date_dim
!                                            +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [date_dim], [], false   SubqueryAlias date_dim
!                                            +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.001165553 seconds
Total number of effective runs: 1
Total time of effective runs: 8.0943E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#442L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#442L]
 +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                              +- SubqueryAlias date_dim
    +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet      +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#442L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#442L]
 +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                              +- SubqueryAlias date_dim
    +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet      +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001632213 seconds
Total number of effective runs: 1
Total time of effective runs: 4.1675E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#442L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#442L]
!+- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!   +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet   
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#442L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#442L]
!+- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!   +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet   
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#442L]                                                                                                                                                                                                                                                                                                                                                                                  Aggregate [count(1) AS count#442L]
!+- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#442L]                                                                                                                                                                                                                                                                                                                                                                                  Aggregate [count(1) AS count#442L]
!+- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.005739656 seconds
Total number of effective runs: 2
Total time of effective runs: 2.6666E-4 seconds
      
22/07/26 14:21:15 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#442L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#442L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#148]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])
!                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#442L])                                                                                                                                                                     HashAggregate(keys=[], functions=[count(1)], output=[count#442L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#148]                                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#152]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])                                                                                                                                                          +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#442L])                                                                                                                                                                        *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#442L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#152]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#158]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])                                                                                                                                                             +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])
!      +- ColumnarToRow                                                                                                                                                                                                                         +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#442L])                                                                                                                                                                  *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#442L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#158]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#445L])
!                                                                                                                                                                                                                                         +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_21 stored as values in memory (estimated size 292.3 KiB, free 364.3 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_21_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.2 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_21_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 21 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 6037354 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Registering RDD 50 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 5
22/07/26 14:21:15 INFO DAGScheduler: Got job 11 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 17 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 16)
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 16)
22/07/26 14:21:15 INFO DAGScheduler: Submitting ShuffleMapStage 16 (MapPartitionsRDD[50] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_22 stored as values in memory (estimated size 14.7 KiB, free 364.2 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_22_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.2 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_22_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 22 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 16 (MapPartitionsRDD[50] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 16) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4941 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 16.0 (TID 16)
22/07/26 14:21:15 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim/part-00000-a413da45-d7c8-4f70-a93b-7e518b0efa89-c000.snappy.parquet, range: 0-1843050, partition values: [empty row]
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 16.0 (TID 16). 2132 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 16) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ShuffleMapStage 16 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.019 s
22/07/26 14:21:15 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:15 INFO DAGScheduler: running: Set()
22/07/26 14:21:15 INFO DAGScheduler: waiting: Set(ResultStage 17)
22/07/26 14:21:15 INFO DAGScheduler: failed: Set()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 17 (MapPartitionsRDD[53] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_23 stored as values in memory (estimated size 10.1 KiB, free 364.2 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_23_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.2 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_23_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 23 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 17 (MapPartitionsRDD[53] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 17.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 17.0 (TID 17) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 17.0 (TID 17)
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 17.0 (TID 17). 2648 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 17.0 (TID 17) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 17.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 17 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:15 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 17: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 11 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.035400 s
22/07/26 14:21:15 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Got job 12 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 18 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 18 (MapPartitionsRDD[55] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_24 stored as values in memory (estimated size 74.3 KiB, free 364.1 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_24_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_24_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 24 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 18 (MapPartitionsRDD[55] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 18.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 18.0 (TID 18) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4715 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 18.0 (TID 18)
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 18.0 (TID 18). 1851 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 18.0 (TID 18) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 18.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 18 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.020 s
22/07/26 14:21:15 INFO DAGScheduler: Job 12 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 18: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 12 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.022234 s
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 8.53797E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.80308E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001115028 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [household_demographics], [], false   SubqueryAlias household_demographics
!                                                          +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [household_demographics], [], false   SubqueryAlias household_demographics
!                                                          +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.001103854 seconds
Total number of effective runs: 1
Total time of effective runs: 7.4736E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#467L]                                                                                        Aggregate [count(1) AS count#467L]
 +- SubqueryAlias household_demographics                                                                                   +- SubqueryAlias household_demographics
    +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet      +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#467L]                                                                                        Aggregate [count(1) AS count#467L]
 +- SubqueryAlias household_demographics                                                                                   +- SubqueryAlias household_demographics
    +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet      +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001352827 seconds
Total number of effective runs: 1
Total time of effective runs: 3.9151E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#467L]                                                                                        Aggregate [count(1) AS count#467L]
!+- SubqueryAlias household_demographics                                                                                   +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!   +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet   
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#467L]                                                                                        Aggregate [count(1) AS count#467L]
!+- SubqueryAlias household_demographics                                                                                   +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!   +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet   
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#467L]                                                                                     Aggregate [count(1) AS count#467L]
!+- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet   +- Project
!                                                                                                                          +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#467L]                                                                                     Aggregate [count(1) AS count#467L]
!+- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet   +- Project
!                                                                                                                          +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.00445453 seconds
Total number of effective runs: 2
Total time of effective runs: 1.63039E-4 seconds
      
22/07/26 14:21:15 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#467L])                                                                                                                                                                                HashAggregate(keys=[], functions=[count(1)], output=[count#467L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])                                                                                                                                                                     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#175]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])
!                                                                                                                                                                                                                                                       +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#467L])                                                                                                                                                                                   HashAggregate(keys=[], functions=[count(1)], output=[count#467L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#175]                                                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#179]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])                                                                                                                                                                        +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#467L])                                                                                                                                                                                      *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#467L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#179]                                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#185]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])                                                                                                                                                                           +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])
!      +- ColumnarToRow                                                                                                                                                                                                                                       +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#467L])                                                                                                                                                                                *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#467L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])                                                                                                                                                                     +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#185]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#470L])
!                                                                                                                                                                                                                                                       +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_25 stored as values in memory (estimated size 292.3 KiB, free 363.8 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_25_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.8 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_25_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 25 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4225251 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Registering RDD 59 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 6
22/07/26 14:21:15 INFO DAGScheduler: Got job 13 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 20 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 19)
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 19)
22/07/26 14:21:15 INFO DAGScheduler: Submitting ShuffleMapStage 19 (MapPartitionsRDD[59] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_26 stored as values in memory (estimated size 14.7 KiB, free 363.8 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_26_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.8 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_26_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 26 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 19 (MapPartitionsRDD[59] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 19.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 19.0 (TID 19) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4955 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 19.0 (TID 19)
22/07/26 14:21:15 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics/part-00000-329cd03e-c442-4b83-aa62-907c29e73e1c-c000.snappy.parquet, range: 0-30947, partition values: [empty row]
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 19.0 (TID 19). 2132 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 19.0 (TID 19) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 19.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ShuffleMapStage 19 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.017 s
22/07/26 14:21:15 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:15 INFO DAGScheduler: running: Set()
22/07/26 14:21:15 INFO DAGScheduler: waiting: Set(ResultStage 20)
22/07/26 14:21:15 INFO DAGScheduler: failed: Set()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 20 (MapPartitionsRDD[62] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_27 stored as values in memory (estimated size 10.1 KiB, free 363.8 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_27_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.8 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_27_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 27 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 20 (MapPartitionsRDD[62] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 20.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 20.0 (TID 20) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 20.0 (TID 20)
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:15 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 20.0 (TID 20). 2648 bytes result sent to driver
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 20.0 (TID 20) in 5 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 20.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 20 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.010 s
22/07/26 14:21:15 INFO DAGScheduler: Job 13 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 20: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 13 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.030957 s
22/07/26 14:21:15 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:15 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO DAGScheduler: Got job 14 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:15 INFO DAGScheduler: Final stage: ResultStage 21 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:15 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:15 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:15 INFO DAGScheduler: Submitting ResultStage 21 (MapPartitionsRDD[64] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_28 stored as values in memory (estimated size 74.3 KiB, free 363.7 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_28_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 363.7 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_28_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 365.9 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 28 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 21 (MapPartitionsRDD[64] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:15 INFO TaskSchedulerImpl: Adding task set 21.0 with 1 tasks resource profile 0
22/07/26 14:21:15 INFO TaskSetManager: Starting task 0.0 in stage 21.0 (TID 21) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4702 bytes) taskResourceAssignments Map()
22/07/26 14:21:15 INFO Executor: Running task 0.0 in stage 21.0 (TID 21)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_27_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 365.9 MiB)
22/07/26 14:21:15 INFO Executor: Finished task 0.0 in stage 21.0 (TID 21). 1755 bytes result sent to driver
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_8_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO TaskSetManager: Finished task 0.0 in stage 21.0 (TID 21) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:15 INFO TaskSchedulerImpl: Removed TaskSet 21.0, whose tasks have all completed, from pool 
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_16_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:15 INFO DAGScheduler: ResultStage 21 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.040 s
22/07/26 14:21:15 INFO DAGScheduler: Job 14 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 21: Stage finished
22/07/26 14:21:15 INFO DAGScheduler: Job 14 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.042709 s
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 9.70092E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.37411E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_17_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001280065 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [inventory], [], false   SubqueryAlias inventory
!                                             +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [inventory], [], false   SubqueryAlias inventory
!                                             +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 9.65821E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 7.1904E-5 seconds
      
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#488L]                                                                      Aggregate [count(1) AS count#488L]
 +- SubqueryAlias inventory                                                                              +- SubqueryAlias inventory
    +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet      +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#488L]                                                                      Aggregate [count(1) AS count#488L]
 +- SubqueryAlias inventory                                                                              +- SubqueryAlias inventory
    +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet      +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001327489 seconds
Total number of effective runs: 1
Total time of effective runs: 2.9012E-5 seconds
      
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_22_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#488L]                                                                      Aggregate [count(1) AS count#488L]
!+- SubqueryAlias inventory                                                                              +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
!   +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet   
           
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_24_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#488L]                                                                      Aggregate [count(1) AS count#488L]
!+- SubqueryAlias inventory                                                                              +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
!   +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet   
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#488L]                                                                   Aggregate [count(1) AS count#488L]
!+- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet   +- Project
!                                                                                                        +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
           
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_26_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#488L]                                                                   Aggregate [count(1) AS count#488L]
!+- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet   +- Project
!                                                                                                        +- Relation[inv_date_sk#471,inv_item_sk#472,inv_warehouse_sk#473,inv_quantity_on_hand#474] parquet
          
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.005977302 seconds
Total number of effective runs: 2
Total time of effective runs: 1.5518E-4 seconds
      
22/07/26 14:21:15 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:15 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#488L])                                                                                                                                                                   HashAggregate(keys=[], functions=[count(1)], output=[count#488L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])                                                                                                                                                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#202]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])
!                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#488L])                                                                                                                                                                      HashAggregate(keys=[], functions=[count(1)], output=[count#488L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#202]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#206]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])                                                                                                                                                           +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_15_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#488L])                                                                                                                                                                         *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#488L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#206]                                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#212]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])                                                                                                                                                              +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])
!      +- ColumnarToRow                                                                                                                                                                                                                          +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:15 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#488L])                                                                                                                                                                   *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#488L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])                                                                                                                                                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#212]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#491L])
!                                                                                                                                                                                                                                          +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/inventory], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_23_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_13_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_11_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_19_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_29 stored as values in memory (estimated size 292.3 KiB, free 364.4 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_21_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_18_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_9_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO MemoryStore: Block broadcast_29_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.1 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_14_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:15 INFO BlockManagerInfo: Added broadcast_29_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:15 INFO SparkContext: Created broadcast 29 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 39975269 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:15 INFO BlockManagerInfo: Removed broadcast_12_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_10_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_25_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_20_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 68 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 7
22/07/26 14:21:16 INFO DAGScheduler: Got job 15 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 23 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 22)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 22)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 22 (MapPartitionsRDD[68] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_30 stored as values in memory (estimated size 14.7 KiB, free 365.6 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_30_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.6 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_30_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 30 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 22 (MapPartitionsRDD[68] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 22.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 22.0 (TID 22) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4942 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 22.0 (TID 22)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/inventory/part-00000-966be9bb-62cb-498d-8632-e640d0ffebb7-c000.snappy.parquet, range: 0-35780965, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 22.0 (TID 22). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 22.0 (TID 22) in 21 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 22.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 22 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.029 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:16 INFO DAGScheduler: waiting: Set(ResultStage 23)
22/07/26 14:21:16 INFO DAGScheduler: failed: Set()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 23 (MapPartitionsRDD[71] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_31 stored as values in memory (estimated size 10.1 KiB, free 365.6 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_31_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.5 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_31_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 31 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 23 (MapPartitionsRDD[71] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 23.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 23.0 (TID 23) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 23.0 (TID 23)
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 23.0 (TID 23). 2648 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 23.0 (TID 23) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 23.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 23 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:16 INFO DAGScheduler: Job 15 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 23: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 15 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.044404 s
22/07/26 14:21:16 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Got job 16 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 24 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 24 (MapPartitionsRDD[73] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_32 stored as values in memory (estimated size 74.3 KiB, free 365.5 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_32_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.4 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_32_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 32 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 24 (MapPartitionsRDD[73] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 24.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 24.0 (TID 24) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4697 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 24.0 (TID 24)
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 24.0 (TID 24). 3038 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 24.0 (TID 24) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 24.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 24 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.021 s
22/07/26 14:21:16 INFO DAGScheduler: Job 16 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 24: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 16 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.024607 s
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.00165987 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.81798E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001334754 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [item], [], false   SubqueryAlias item
!                                        +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [item], [], false   SubqueryAlias item
!                                        +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.001097197 seconds
Total number of effective runs: 1
Total time of effective runs: 6.5127E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#581L]                                                                                                                                                                                                                                                                                                                                                      Aggregate [count(1) AS count#581L]
 +- SubqueryAlias item                                                                                                                                                                                                                                                                                                                                                                   +- SubqueryAlias item
    +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet      +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#581L]                                                                                                                                                                                                                                                                                                                                                      Aggregate [count(1) AS count#581L]
 +- SubqueryAlias item                                                                                                                                                                                                                                                                                                                                                                   +- SubqueryAlias item
    +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet      +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.00141884 seconds
Total number of effective runs: 1
Total time of effective runs: 2.6452E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#581L]                                                                                                                                                                                                                                                                                                                                                      Aggregate [count(1) AS count#581L]
!+- SubqueryAlias item                                                                                                                                                                                                                                                                                                                                                                   +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
!   +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet   
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#581L]                                                                                                                                                                                                                                                                                                                                                      Aggregate [count(1) AS count#581L]
!+- SubqueryAlias item                                                                                                                                                                                                                                                                                                                                                                   +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
!   +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet   
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#581L]                                                                                                                                                                                                                                                                                                                                                   Aggregate [count(1) AS count#581L]
!+- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#581L]                                                                                                                                                                                                                                                                                                                                                   Aggregate [count(1) AS count#581L]
!+- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[i_item_sk#492,i_item_id#493,i_rec_start_date#494,i_rec_end_date#495,i_item_desc#496,i_current_price#497,i_wholesale_cost#498,i_brand_id#499,i_brand#500,i_class_id#501,i_class#502,i_category_id#503,i_category#504,i_manufact_id#505,i_manufact#506,i_size#507,i_formulation#508,i_color#509,i_units#510,i_container#511,i_manager_id#512,i_product_name#513] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.008564109 seconds
Total number of effective runs: 2
Total time of effective runs: 2.45266E-4 seconds
      
22/07/26 14:21:16 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#581L])                                                                                                                                                              HashAggregate(keys=[], functions=[count(1)], output=[count#581L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])                                                                                                                                                   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#229]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])
!                                                                                                                                                                                                                                     +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#581L])                                                                                                                                                                 HashAggregate(keys=[], functions=[count(1)], output=[count#581L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#229]                                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#233]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])                                                                                                                                                      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                           +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#581L])                                                                                                                                                                    *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#581L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#233]                                                                                                                                                                          +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#239]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])                                                                                                                                                         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])
!      +- ColumnarToRow                                                                                                                                                                                                                     +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#581L])                                                                                                                                                              *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#581L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])                                                                                                                                                   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#239]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#584L])
!                                                                                                                                                                                                                                     +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                        +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/item], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_33 stored as values in memory (estimated size 292.3 KiB, free 365.2 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_33_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_33_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 33 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 5969446 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 77 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 8
22/07/26 14:21:16 INFO DAGScheduler: Got job 17 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 26 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 25)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 25)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 25 (MapPartitionsRDD[77] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_34 stored as values in memory (estimated size 14.7 KiB, free 365.1 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_34_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_34_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 34 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 25 (MapPartitionsRDD[77] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 25.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 25.0 (TID 25) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4937 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 25.0 (TID 25)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/item/part-00000-f6bcf2a7-9f88-4b2c-a7fc-20f138606b1a-c000.snappy.parquet, range: 0-1775142, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 25.0 (TID 25). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 25.0 (TID 25) in 13 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 25.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 25 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:16 INFO DAGScheduler: waiting: Set(ResultStage 26)
22/07/26 14:21:16 INFO DAGScheduler: failed: Set()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 26 (MapPartitionsRDD[80] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_35 stored as values in memory (estimated size 10.1 KiB, free 365.1 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_35_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_35_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 35 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 26 (MapPartitionsRDD[80] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 26.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 26.0 (TID 26) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 26.0 (TID 26)
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 26.0 (TID 26). 2648 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 26.0 (TID 26) in 6 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 26.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 26 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.011 s
22/07/26 14:21:16 INFO DAGScheduler: Job 17 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 26: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 17 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.033641 s
22/07/26 14:21:16 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Got job 18 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 27 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 27 (MapPartitionsRDD[82] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_36 stored as values in memory (estimated size 74.3 KiB, free 365.0 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_36_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.0 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_36_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 36 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 27 (MapPartitionsRDD[82] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 27.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 27.0 (TID 27) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4702 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 27.0 (TID 27)
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 27.0 (TID 27). 2881 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 27.0 (TID 27) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 27.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 27 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.021 s
22/07/26 14:21:16 INFO DAGScheduler: Job 18 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 27: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 18 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.022694 s
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001140516 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 6.31174E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001123617 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [promotion], [], false   SubqueryAlias promotion
!                                             +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [promotion], [], false   SubqueryAlias promotion
!                                             +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 0.001026347 seconds
Total number of effective runs: 1
Total time of effective runs: 6.5921E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#662L]                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#662L]
 +- SubqueryAlias promotion                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias promotion
    +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet      +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#662L]                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#662L]
 +- SubqueryAlias promotion                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias promotion
    +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet      +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001329828 seconds
Total number of effective runs: 1
Total time of effective runs: 3.0578E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#662L]                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#662L]
!+- SubqueryAlias promotion                                                                                                                                                                                                                                                                                                                                                            +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
!   +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet   
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#662L]                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#662L]
!+- SubqueryAlias promotion                                                                                                                                                                                                                                                                                                                                                            +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
!   +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet   
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#662L]                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#662L]
!+- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                      +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#662L]                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#662L]
!+- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                      +- Relation[p_promo_sk#585,p_promo_id#586,p_start_date_sk#587,p_end_date_sk#588,p_item_sk#589,p_cost#590,p_response_target#591,p_promo_name#592,p_channel_dmail#593,p_channel_email#594,p_channel_catalog#595,p_channel_tv#596,p_channel_radio#597,p_channel_press#598,p_channel_event#599,p_channel_demo#600,p_channel_details#601,p_purpose#602,p_discount_active#603] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.004793852 seconds
Total number of effective runs: 2
Total time of effective runs: 1.78728E-4 seconds
      
22/07/26 14:21:16 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#662L])                                                                                                                                                                   HashAggregate(keys=[], functions=[count(1)], output=[count#662L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])                                                                                                                                                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#256]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])
!                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#662L])                                                                                                                                                                      HashAggregate(keys=[], functions=[count(1)], output=[count#662L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#256]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#260]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])                                                                                                                                                           +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#662L])                                                                                                                                                                         *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#662L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#260]                                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#266]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])                                                                                                                                                              +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])
!      +- ColumnarToRow                                                                                                                                                                                                                          +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#662L])                                                                                                                                                                   *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#662L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])                                                                                                                                                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#266]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#665L])
!                                                                                                                                                                                                                                          +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/promotion], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_37 stored as values in memory (estimated size 292.3 KiB, free 364.7 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_37_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.7 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_37_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 37 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4215907 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 86 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 9
22/07/26 14:21:16 INFO DAGScheduler: Got job 19 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 29 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 28)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 28)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 28 (MapPartitionsRDD[86] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_38 stored as values in memory (estimated size 14.7 KiB, free 364.7 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_38_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.7 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_38_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 38 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 28 (MapPartitionsRDD[86] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 28.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 28.0 (TID 28) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4942 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 28.0 (TID 28)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/promotion/part-00000-06263dcc-24ed-4639-a749-3ffaf7e31eaf-c000.snappy.parquet, range: 0-21603, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 28.0 (TID 28). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 28.0 (TID 28) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 28.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 28 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.015 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:16 INFO DAGScheduler: waiting: Set(ResultStage 29)
22/07/26 14:21:16 INFO DAGScheduler: failed: Set()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 29 (MapPartitionsRDD[89] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_39 stored as values in memory (estimated size 10.1 KiB, free 364.7 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_39_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.7 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_39_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 39 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 29 (MapPartitionsRDD[89] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 29.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 29.0 (TID 29) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 29.0 (TID 29)
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 29.0 (TID 29). 2648 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 29.0 (TID 29) in 5 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 29.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 29 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.010 s
22/07/26 14:21:16 INFO DAGScheduler: Job 19 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 29: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 19 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.028414 s
22/07/26 14:21:16 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Got job 20 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 30 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 30 (MapPartitionsRDD[91] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_40 stored as values in memory (estimated size 74.3 KiB, free 364.6 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_40_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.6 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_40_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 40 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 30 (MapPartitionsRDD[91] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 30.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 30.0 (TID 30) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4698 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 30.0 (TID 30)
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 30.0 (TID 30). 3372 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 30.0 (TID 30) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 30.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 30 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.019 s
22/07/26 14:21:16 INFO DAGScheduler: Job 20 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 30: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 20 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.020987 s
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001480314 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.25012E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 0.001104914 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [store], [], false   SubqueryAlias store
!                                         +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [store], [], false   SubqueryAlias store
!                                         +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 9.1073E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 6.7913E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#783L]                                                                                                                                                                                                                                                                                                                                                                                                                                                   Aggregate [count(1) AS count#783L]
 +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias store
    +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet      +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#783L]                                                                                                                                                                                                                                                                                                                                                                                                                                                   Aggregate [count(1) AS count#783L]
 +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias store
    +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet      +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001651994 seconds
Total number of effective runs: 1
Total time of effective runs: 3.433E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#783L]                                                                                                                                                                                                                                                                                                                                                                                                                                                   Aggregate [count(1) AS count#783L]
!+- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!   +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet   
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#783L]                                                                                                                                                                                                                                                                                                                                                                                                                                                   Aggregate [count(1) AS count#783L]
!+- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!   +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet   
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#783L]                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#783L]
!+- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#783L]                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#783L]
!+- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.004816699 seconds
Total number of effective runs: 2
Total time of effective runs: 2.03831E-4 seconds
      
22/07/26 14:21:16 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#783L])                                                                                                                                                               HashAggregate(keys=[], functions=[count(1)], output=[count#783L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#283]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])
!                                                                                                                                                                                                                                      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#783L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#783L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#283]                                                                                                                                                                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#287]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])                                                                                                                                                       +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#783L])                                                                                                                                                                     *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#783L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#287]                                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#293]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])                                                                                                                                                          +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])
!      +- ColumnarToRow                                                                                                                                                                                                                      +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#783L])                                                                                                                                                               *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#783L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#293]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#786L])
!                                                                                                                                                                                                                                      +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_41 stored as values in memory (estimated size 292.3 KiB, free 364.3 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_41_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_41_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 41 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4203787 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 95 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 10
22/07/26 14:21:16 INFO DAGScheduler: Got job 21 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 32 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 31)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 31)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 31 (MapPartitionsRDD[95] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_42 stored as values in memory (estimated size 14.7 KiB, free 364.2 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_42_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_42_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 42 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 31 (MapPartitionsRDD[95] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 31.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 31.0 (TID 31) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4938 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 31.0 (TID 31)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store/part-00000-995b273e-5695-4f66-bbbf-e1737ae46f7e-c000.snappy.parquet, range: 0-9483, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 31.0 (TID 31). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 31.0 (TID 31) in 11 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 31.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 31 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.016 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:16 INFO DAGScheduler: waiting: Set(ResultStage 32)
22/07/26 14:21:16 INFO DAGScheduler: failed: Set()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 32 (MapPartitionsRDD[98] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_43 stored as values in memory (estimated size 10.1 KiB, free 364.2 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_43_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_43_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 43 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 32 (MapPartitionsRDD[98] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 32.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 32.0 (TID 32) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 32.0 (TID 32)
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 32.0 (TID 32). 2648 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 32.0 (TID 32) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 32.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 32 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:16 INFO DAGScheduler: Job 21 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 32: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 21 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.027395 s
22/07/26 14:21:16 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Got job 22 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 33 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 33 (MapPartitionsRDD[100] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_44 stored as values in memory (estimated size 74.3 KiB, free 364.1 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_44_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_44_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 44 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 33 (MapPartitionsRDD[100] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 33.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 33.0 (TID 33) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4706 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 33.0 (TID 33)
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 33.0 (TID 33). 3125 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 33.0 (TID 33) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 33.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 33 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:16 INFO DAGScheduler: Job 22 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 33: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 22 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.020113 s
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001022955 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.89453E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 8.87977E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [store_returns], [], false   SubqueryAlias store_returns
!                                                 +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [store_returns], [], false   SubqueryAlias store_returns
!                                                 +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 7.35069E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.5826E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#868L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#868L]
 +- SubqueryAlias store_returns                                                                                                                                                                                                                                                                                                                                                                                         +- SubqueryAlias store_returns
    +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet      +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#868L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#868L]
 +- SubqueryAlias store_returns                                                                                                                                                                                                                                                                                                                                                                                         +- SubqueryAlias store_returns
    +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet      +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001253893 seconds
Total number of effective runs: 1
Total time of effective runs: 2.5523E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#868L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#868L]
!+- SubqueryAlias store_returns                                                                                                                                                                                                                                                                                                                                                                                         +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
!   +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet   
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#868L]                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#868L]
!+- SubqueryAlias store_returns                                                                                                                                                                                                                                                                                                                                                                                         +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
!   +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet   
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#868L]                                                                                                                                                                                                                                                                                                                                                                                  Aggregate [count(1) AS count#868L]
!+- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#868L]                                                                                                                                                                                                                                                                                                                                                                                  Aggregate [count(1) AS count#868L]
!+- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[sr_returned_date_sk#787,sr_return_time_sk#788,sr_item_sk#789,sr_customer_sk#790,sr_cdemo_sk#791,sr_hdemo_sk#792,sr_addr_sk#793,sr_store_sk#794,sr_reason_sk#795,sr_ticket_number#796,sr_return_quantity#797,sr_return_amt#798,sr_return_tax#799,sr_return_amt_inc_tax#800,sr_fee#801,sr_return_ship_cost#802,sr_refunded_cash#803,sr_reversed_charge#804,sr_store_credit#805,sr_net_loss#806] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.004849481 seconds
Total number of effective runs: 2
Total time of effective runs: 1.4322E-4 seconds
      
22/07/26 14:21:16 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#868L])                                                                                                                                                                       HashAggregate(keys=[], functions=[count(1)], output=[count#868L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#310]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])
!                                                                                                                                                                                                                                              +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#868L])                                                                                                                                                                          HashAggregate(keys=[], functions=[count(1)], output=[count#868L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#310]                                                                                                                                                                                +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#314]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])                                                                                                                                                               +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                    +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#868L])                                                                                                                                                                             *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#868L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#314]                                                                                                                                                                                   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#320]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])                                                                                                                                                                  +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])
!      +- ColumnarToRow                                                                                                                                                                                                                              +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#868L])                                                                                                                                                                       *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#868L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#320]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#871L])
!                                                                                                                                                                                                                                              +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                 +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_45 stored as values in memory (estimated size 292.3 KiB, free 363.8 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_45_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.8 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_45_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 45 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 18857844 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 104 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 11
22/07/26 14:21:16 INFO DAGScheduler: Got job 23 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 35 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 34)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 34)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 34 (MapPartitionsRDD[104] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_46 stored as values in memory (estimated size 14.7 KiB, free 363.8 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_46_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.8 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_46_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 46 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 34 (MapPartitionsRDD[104] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 34.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 34.0 (TID 34) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4946 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 34.0 (TID 34)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store_returns/part-00000-6f6d32ed-3463-4469-8d30-e265dccb08b0-c000.snappy.parquet, range: 0-14663540, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 34.0 (TID 34). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 34.0 (TID 34) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 34.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 34 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:16 INFO DAGScheduler: waiting: Set(ResultStage 35)
22/07/26 14:21:16 INFO DAGScheduler: failed: Set()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 35 (MapPartitionsRDD[107] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_47 stored as values in memory (estimated size 10.1 KiB, free 363.8 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_47_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.8 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_47_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 47 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 35 (MapPartitionsRDD[107] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 35.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 35.0 (TID 35) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 35.0 (TID 35)
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 35.0 (TID 35). 2648 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 35.0 (TID 35) in 5 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 35.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 35 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.009 s
22/07/26 14:21:16 INFO DAGScheduler: Job 23 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 35: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 23 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.030555 s
22/07/26 14:21:16 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_47_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_28_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Got job 24 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 36 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_46_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 36 (MapPartitionsRDD[109] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_35_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_43_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_37_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_29_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_48 stored as values in memory (estimated size 74.3 KiB, free 364.5 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_30_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_48_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.5 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_48_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 48 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 36 (MapPartitionsRDD[109] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 36.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_33_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 36.0 (TID 36) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4706 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 36.0 (TID 36)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_39_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_36_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_31_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_42_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_34_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 36.0 (TID 36). 3988 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 36.0 (TID 36) in 11 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 36.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_40_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 36 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.024 s
22/07/26 14:21:16 INFO DAGScheduler: Job 24 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 36: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 24 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.025836 s
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_38_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.0020441 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_32_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_44_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Removed broadcast_41_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.60499E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 9.43274E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [catalog_sales], [], false   SubqueryAlias catalog_sales
!                                                 +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [catalog_sales], [], false   SubqueryAlias catalog_sales
!                                                 +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 8.91214E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.276E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1009L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#1009L]
 +- SubqueryAlias catalog_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- SubqueryAlias catalog_sales
    +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet      +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1009L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#1009L]
 +- SubqueryAlias catalog_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- SubqueryAlias catalog_sales
    +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet      +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001164375 seconds
Total number of effective runs: 1
Total time of effective runs: 2.1544E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1009L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#1009L]
!+- SubqueryAlias catalog_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
!   +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet   
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1009L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Aggregate [count(1) AS count#1009L]
!+- SubqueryAlias catalog_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
!   +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet   
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1009L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#1009L]
!+- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1009L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#1009L]
!+- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[cs_sold_date_sk#872,cs_sold_time_sk#873,cs_ship_date_sk#874,cs_bill_customer_sk#875,cs_bill_cdemo_sk#876,cs_bill_hdemo_sk#877,cs_bill_addr_sk#878,cs_ship_customer_sk#879,cs_ship_cdemo_sk#880,cs_ship_hdemo_sk#881,cs_ship_addr_sk#882,cs_call_center_sk#883,cs_catalog_page_sk#884,cs_ship_mode_sk#885,cs_warehouse_sk#886,cs_item_sk#887,cs_promo_sk#888,cs_order_number#889,cs_quantity#890,cs_wholesale_cost#891,cs_list_price#892,cs_sales_price#893,cs_ext_discount_amt#894,cs_ext_sales_price#895,... 10 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.004184422 seconds
Total number of effective runs: 2
Total time of effective runs: 1.76996E-4 seconds
      
22/07/26 14:21:16 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])                                                                                                                                                                      HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#337]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])
!                                                                                                                                                                                                                                              +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])                                                                                                                                                                         HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#337]                                                                                                                                                                                +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#341]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])                                                                                                                                                              +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                    +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])                                                                                                                                                                            *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#341]                                                                                                                                                                                   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#347]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])                                                                                                                                                                 +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])
!      +- ColumnarToRow                                                                                                                                                                                                                              +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])                                                                                                                                                                      *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1009L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#347]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1012L])
!                                                                                                                                                                                                                                              +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                                 +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_49 stored as values in memory (estimated size 292.3 KiB, free 365.3 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_49_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.3 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_49_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 49 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 100763528 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 113 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 12
22/07/26 14:21:16 INFO DAGScheduler: Got job 25 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 38 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 37)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 37)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 37 (MapPartitionsRDD[113] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_50 stored as values in memory (estimated size 14.7 KiB, free 365.3 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_50_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.3 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_50_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 50 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 37 (MapPartitionsRDD[113] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 37.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 37.0 (TID 37) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4946 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 37.0 (TID 37)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/catalog_sales/part-00000-9851a85f-8a5f-4922-82dc-1f87f411bc66-c000.snappy.parquet, range: 0-96569224, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 37.0 (TID 37). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 37.0 (TID 37) in 13 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 37.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 37 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:16 INFO DAGScheduler: waiting: Set(ResultStage 38)
22/07/26 14:21:16 INFO DAGScheduler: failed: Set()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 38 (MapPartitionsRDD[116] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_51 stored as values in memory (estimated size 10.1 KiB, free 365.2 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_51_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.2 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_51_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 51 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 38 (MapPartitionsRDD[116] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 38.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 38.0 (TID 38) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 38.0 (TID 38)
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:16 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 38.0 (TID 38). 2648 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 38.0 (TID 38) in 6 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 38.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 38 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.010 s
22/07/26 14:21:16 INFO DAGScheduler: Job 25 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 38: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 25 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.031915 s
22/07/26 14:21:16 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Got job 26 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 39 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:16 INFO DAGScheduler: Submitting ResultStage 39 (MapPartitionsRDD[118] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_52 stored as values in memory (estimated size 74.3 KiB, free 365.2 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_52_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.1 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_52_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 52 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 39 (MapPartitionsRDD[118] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 39.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 39.0 (TID 39) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4702 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 39.0 (TID 39)
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 39.0 (TID 39). 3981 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 39.0 (TID 39) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 39.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ResultStage 39 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.022 s
22/07/26 14:21:16 INFO DAGScheduler: Job 26 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 39: Stage finished
22/07/26 14:21:16 INFO DAGScheduler: Job 26 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.024126 s
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001264815 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.45808E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 8.04738E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [web_sales], [], false   SubqueryAlias web_sales
!                                             +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [web_sales], [], false   SubqueryAlias web_sales
!                                             +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 8.21871E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.1355E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#1150L]
 +- SubqueryAlias web_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- SubqueryAlias web_sales
    +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet      +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#1150L]
 +- SubqueryAlias web_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- SubqueryAlias web_sales
    +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet      +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001134942 seconds
Total number of effective runs: 1
Total time of effective runs: 2.2305E-5 seconds
      
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#1150L]
!+- SubqueryAlias web_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
!   +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet   
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Aggregate [count(1) AS count#1150L]
!+- SubqueryAlias web_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
!   +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet   
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Aggregate [count(1) AS count#1150L]
!+- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1150L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Aggregate [count(1) AS count#1150L]
!+- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[ws_sold_date_sk#1013,ws_sold_time_sk#1014,ws_ship_date_sk#1015,ws_item_sk#1016,ws_bill_customer_sk#1017,ws_bill_cdemo_sk#1018,ws_bill_hdemo_sk#1019,ws_bill_addr_sk#1020,ws_ship_customer_sk#1021,ws_ship_cdemo_sk#1022,ws_ship_hdemo_sk#1023,ws_ship_addr_sk#1024,ws_web_page_sk#1025,ws_web_site_sk#1026,ws_ship_mode_sk#1027,ws_warehouse_sk#1028,ws_promo_sk#1029,ws_order_number#1030,ws_quantity#1031,ws_wholesale_cost#1032,ws_list_price#1033,ws_sales_price#1034,ws_ext_discount_amt#1035,ws_ext_sales_price#1036,... 10 more fields] parquet
          
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.004007975 seconds
Total number of effective runs: 2
Total time of effective runs: 1.59342E-4 seconds
      
22/07/26 14:21:16 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:16 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#364]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])
!                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])                                                                                                                                                                     HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#364]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#368]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])                                                                                                                                                          +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])                                                                                                                                                                        *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#368]                                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#374]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])                                                                                                                                                             +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])
!      +- ColumnarToRow                                                                                                                                                                                                                          +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:16 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])                                                                                                                                                                  *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1150L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#374]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1153L])
!                                                                                                                                                                                                                                          +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_53 stored as values in memory (estimated size 292.3 KiB, free 364.9 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_53_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.8 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_53_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 53 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 48694286 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:16 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:16 INFO DAGScheduler: Registering RDD 122 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 13
22/07/26 14:21:16 INFO DAGScheduler: Got job 27 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:16 INFO DAGScheduler: Final stage: ResultStage 41 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:16 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 40)
22/07/26 14:21:16 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 40)
22/07/26 14:21:16 INFO DAGScheduler: Submitting ShuffleMapStage 40 (MapPartitionsRDD[122] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_54 stored as values in memory (estimated size 14.7 KiB, free 364.8 MiB)
22/07/26 14:21:16 INFO MemoryStore: Block broadcast_54_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.8 MiB)
22/07/26 14:21:16 INFO BlockManagerInfo: Added broadcast_54_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:16 INFO SparkContext: Created broadcast 54 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:16 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 40 (MapPartitionsRDD[122] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:16 INFO TaskSchedulerImpl: Adding task set 40.0 with 1 tasks resource profile 0
22/07/26 14:21:16 INFO TaskSetManager: Starting task 0.0 in stage 40.0 (TID 40) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4942 bytes) taskResourceAssignments Map()
22/07/26 14:21:16 INFO Executor: Running task 0.0 in stage 40.0 (TID 40)
22/07/26 14:21:16 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/web_sales/part-00000-06dc4a91-40d4-488b-b203-7fb75009ace4-c000.snappy.parquet, range: 0-44499982, partition values: [empty row]
22/07/26 14:21:16 INFO Executor: Finished task 0.0 in stage 40.0 (TID 40). 2132 bytes result sent to driver
22/07/26 14:21:16 INFO TaskSetManager: Finished task 0.0 in stage 40.0 (TID 40) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:16 INFO TaskSchedulerImpl: Removed TaskSet 40.0, whose tasks have all completed, from pool 
22/07/26 14:21:16 INFO DAGScheduler: ShuffleMapStage 40 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.015 s
22/07/26 14:21:16 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:16 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 41)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 41 (MapPartitionsRDD[125] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_55 stored as values in memory (estimated size 10.1 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_55_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_55_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 55 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 41 (MapPartitionsRDD[125] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 41.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 41.0 (TID 41) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 41.0 (TID 41)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 41.0 (TID 41). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 41.0 (TID 41) in 5 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 41.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 41 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:17 INFO DAGScheduler: Job 27 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 41: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 27 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.026851 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 28 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 42 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 42 (MapPartitionsRDD[127] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_56 stored as values in memory (estimated size 74.3 KiB, free 364.7 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_56_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.7 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_56_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 56 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 42 (MapPartitionsRDD[127] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 42.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 42.0 (TID 42) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4704 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 42.0 (TID 42)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 42.0 (TID 42). 3344 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 42.0 (TID 42) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 42.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 42 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:17 INFO DAGScheduler: Job 28 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 42: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 28 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.020689 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 9.55458E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.82007E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 8.34141E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [store_sales], [], false   SubqueryAlias store_sales
!                                               +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [store_sales], [], false   SubqueryAlias store_sales
!                                               +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 7.46927E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.2231E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1247L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#1247L]
 +- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- SubqueryAlias store_sales
    +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet      +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1247L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#1247L]
 +- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- SubqueryAlias store_sales
    +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet      +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001662253 seconds
Total number of effective runs: 1
Total time of effective runs: 2.5894E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1247L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#1247L]
!+- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!   +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1247L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Aggregate [count(1) AS count#1247L]
!+- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!   +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1247L]                                                                                                                                                                                                                                                                                                                                                                                                                                                              Aggregate [count(1) AS count#1247L]
!+- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1247L]                                                                                                                                                                                                                                                                                                                                                                                                                                                              Aggregate [count(1) AS count#1247L]
!+- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003472028 seconds
Total number of effective runs: 2
Total time of effective runs: 1.42663E-4 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#391]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])                                                                                                                                                                       HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#391]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#395]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])                                                                                                                                                            +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                  +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])                                                                                                                                                                          *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#395]                                                                                                                                                                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#401]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])                                                                                                                                                               +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])
!      +- ColumnarToRow                                                                                                                                                                                                                            +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])                                                                                                                                                                    *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1247L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#401]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1250L])
!                                                                                                                                                                                                                                            +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_57 stored as values in memory (estimated size 292.3 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_57_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_57_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 57 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 124086532 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 131 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 14
22/07/26 14:21:17 INFO DAGScheduler: Got job 29 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 44 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 43)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 43)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 43 (MapPartitionsRDD[131] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_58 stored as values in memory (estimated size 14.7 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_58_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_58_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 58 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 43 (MapPartitionsRDD[131] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 43.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 43.0 (TID 43) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 43.0 (TID 43)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales/part-00000-83a64231-9071-4db5-b73a-3b9af3882d7f-c000.snappy.parquet, range: 0-119892228, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 43.0 (TID 43). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 43.0 (TID 43) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 43.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 43 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 44)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 44 (MapPartitionsRDD[134] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_59 stored as values in memory (estimated size 10.1 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_59_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.3 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_59_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 59 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 44 (MapPartitionsRDD[134] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 44.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 44.0 (TID 44) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 44.0 (TID 44)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 44.0 (TID 44). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 44.0 (TID 44) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 44.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 44 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:17 INFO DAGScheduler: Job 29 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 44: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 29 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.029476 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 30 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 45 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 45 (MapPartitionsRDD[136] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_60 stored as values in memory (estimated size 74.3 KiB, free 364.3 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_60_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.2 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_60_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 60 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 45 (MapPartitionsRDD[136] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 45.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 45.0 (TID 45) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4704 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 45.0 (TID 45)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 45.0 (TID 45). 3377 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 45.0 (TID 45) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 45.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 45 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.019 s
22/07/26 14:21:17 INFO DAGScheduler: Job 30 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 45: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 30 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.020941 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.00119858 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.60512E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 9.41201E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [web_returns], [], false   SubqueryAlias web_returns
!                                               +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [web_returns], [], false   SubqueryAlias web_returns
!                                               +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 9.32387E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.4947E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1348L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1348L]
 +- SubqueryAlias web_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- SubqueryAlias web_returns
    +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet      +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1348L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1348L]
 +- SubqueryAlias web_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- SubqueryAlias web_returns
    +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet      +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001050188 seconds
Total number of effective runs: 1
Total time of effective runs: 2.7256E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1348L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1348L]
!+- SubqueryAlias web_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
!   +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1348L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1348L]
!+- SubqueryAlias web_returns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
!   +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1348L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1348L]
!+- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1348L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1348L]
!+- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Relation[wr_returned_date_sk#1251,wr_returned_time_sk#1252,wr_item_sk#1253,wr_refunded_customer_sk#1254,wr_refunded_cdemo_sk#1255,wr_refunded_hdemo_sk#1256,wr_refunded_addr_sk#1257,wr_returning_customer_sk#1258,wr_returning_cdemo_sk#1259,wr_returning_hdemo_sk#1260,wr_returning_addr_sk#1261,wr_web_page_sk#1262,wr_reason_sk#1263,wr_order_number#1264,wr_return_quantity#1265,wr_return_amt#1266,wr_return_tax#1267,wr_return_amt_inc_tax#1268,wr_fee#1269,wr_return_ship_cost#1270,wr_refunded_cash#1271,wr_reversed_charge#1272,wr_account_credit#1273,wr_net_loss#1274] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003536532 seconds
Total number of effective runs: 2
Total time of effective runs: 1.42136E-4 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#418]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])                                                                                                                                                                       HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#418]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#422]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])                                                                                                                                                            +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                  +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])                                                                                                                                                                          *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#422]                                                                                                                                                                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#428]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])                                                                                                                                                               +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])
!      +- ColumnarToRow                                                                                                                                                                                                                            +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])                                                                                                                                                                    *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1348L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#428]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1351L])
!                                                                                                                                                                                                                                            +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_61 stored as values in memory (estimated size 292.3 KiB, free 364.0 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_61_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.9 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_61_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 61 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 9462479 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 140 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 15
22/07/26 14:21:17 INFO DAGScheduler: Got job 31 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 47 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 46)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 46)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 46 (MapPartitionsRDD[140] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_62 stored as values in memory (estimated size 14.7 KiB, free 363.9 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_62_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.9 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_62_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 62 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 46 (MapPartitionsRDD[140] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 46.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 46.0 (TID 46) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 46.0 (TID 46)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/web_returns/part-00000-31f590ba-7d32-4342-8b12-d2dde82bbfdb-c000.snappy.parquet, range: 0-5268175, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 46.0 (TID 46). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 46.0 (TID 46) in 11 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 46.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 46 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.015 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 47)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 47 (MapPartitionsRDD[143] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_63 stored as values in memory (estimated size 10.1 KiB, free 363.9 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_63_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.9 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_63_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 63 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 47 (MapPartitionsRDD[143] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 47.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 47.0 (TID 47) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 47.0 (TID 47)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 47.0 (TID 47). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 47.0 (TID 47) in 5 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 47.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 47 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.009 s
22/07/26 14:21:17 INFO DAGScheduler: Job 31 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 47: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 31 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.027096 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 32 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 48 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 48 (MapPartitionsRDD[145] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_64 stored as values in memory (estimated size 74.3 KiB, free 363.8 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_64_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 363.8 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_64_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 64 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 48 (MapPartitionsRDD[145] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 48.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 48.0 (TID 48) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4701 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 48.0 (TID 48)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 48.0 (TID 48). 3265 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 48.0 (TID 48) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 48.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 48 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:17 INFO DAGScheduler: Job 32 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 48: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 32 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.019747 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.0013502 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.78499E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 7.53616E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [web_site], [], false   SubqueryAlias web_site
!                                            +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [web_site], [], false   SubqueryAlias web_site
!                                            +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 8.84839E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.2318E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1457L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1457L]
 +- SubqueryAlias web_site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- SubqueryAlias web_site
    +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet      +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1457L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1457L]
 +- SubqueryAlias web_site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- SubqueryAlias web_site
    +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet      +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001232623 seconds
Total number of effective runs: 1
Total time of effective runs: 3.9512E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1457L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1457L]
!+- SubqueryAlias web_site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
!   +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1457L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1457L]
!+- SubqueryAlias web_site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
!   +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1457L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Aggregate [count(1) AS count#1457L]
!+- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1457L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Aggregate [count(1) AS count#1457L]
!+- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Relation[web_site_sk#1352,web_site_id#1353,web_rec_start_date#1354,web_rec_end_date#1355,web_name#1356,web_open_date_sk#1357,web_close_date_sk#1358,web_class#1359,web_manager#1360,web_mkt_id#1361,web_mkt_class#1362,web_mkt_desc#1363,web_market_manager#1364,web_company_id#1365,web_company_name#1366,web_street_number#1367,web_street_name#1368,web_street_type#1369,web_suite_number#1370,web_city#1371,web_county#1372,web_state#1373,web_zip#1374,web_country#1375,... 2 more fields] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003918059 seconds
Total number of effective runs: 2
Total time of effective runs: 1.73125E-4 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])                                                                                                                                                                 HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#445]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])
!                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#445]                                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#449]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])                                                                                                                                                         +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])                                                                                                                                                                       *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#449]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#455]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])                                                                                                                                                            +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])
!      +- ColumnarToRow                                                                                                                                                                                                                         +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])                                                                                                                                                                 *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1457L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#455]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1460L])
!                                                                                                                                                                                                                                         +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_site], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_65 stored as values in memory (estimated size 292.3 KiB, free 363.5 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_65_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.5 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_65_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 65 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4205935 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 149 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 16
22/07/26 14:21:17 INFO DAGScheduler: Got job 33 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 50 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 49)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 49)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 49 (MapPartitionsRDD[149] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_66 stored as values in memory (estimated size 14.7 KiB, free 363.5 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_66_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.5 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_66_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 66 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 49 (MapPartitionsRDD[149] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 49.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 49.0 (TID 49) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4941 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 49.0 (TID 49)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/web_site/part-00000-320c0517-4a73-48bd-8197-a6be776eadb8-c000.snappy.parquet, range: 0-11631, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 49.0 (TID 49). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 49.0 (TID 49) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 49.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 49 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.014 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 50)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 50 (MapPartitionsRDD[152] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_67 stored as values in memory (estimated size 10.1 KiB, free 363.5 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_67_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.5 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_67_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 67 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 50 (MapPartitionsRDD[152] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 50.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 50.0 (TID 50) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 50.0 (TID 50)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 50.0 (TID 50). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 50.0 (TID 50) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 50.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 50 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:17 INFO DAGScheduler: Job 33 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 50: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 33 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.024540 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 34 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 51 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 51 (MapPartitionsRDD[154] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_68 stored as values in memory (estimated size 74.3 KiB, free 363.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_68_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 363.4 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_68_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 68 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 51 (MapPartitionsRDD[154] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 51.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 51.0 (TID 51) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4699 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 51.0 (TID 51)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 51.0 (TID 51). 1751 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 51.0 (TID 51) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 51.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 51 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.019 s
22/07/26 14:21:17 INFO DAGScheduler: Job 34 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 51: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 34 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.021483 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 6.45502E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.44986E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 8.08037E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [reason], [], false   SubqueryAlias reason
!                                          +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [reason], [], false   SubqueryAlias reason
!                                          +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 6.26805E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 4.7184E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1474L]                                            Aggregate [count(1) AS count#1474L]
 +- SubqueryAlias reason                                                        +- SubqueryAlias reason
    +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet      +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1474L]                                            Aggregate [count(1) AS count#1474L]
 +- SubqueryAlias reason                                                        +- SubqueryAlias reason
    +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet      +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 8.44278E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 1.9933E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1474L]                                            Aggregate [count(1) AS count#1474L]
!+- SubqueryAlias reason                                                        +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
!   +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1474L]                                            Aggregate [count(1) AS count#1474L]
!+- SubqueryAlias reason                                                        +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
!   +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1474L]                                         Aggregate [count(1) AS count#1474L]
!+- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet   +- Project
!                                                                               +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1474L]                                         Aggregate [count(1) AS count#1474L]
!+- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet   +- Project
!                                                                               +- Relation[r_reason_sk#1461,r_reason_id#1462,r_reason_desc#1463] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003484685 seconds
Total number of effective runs: 2
Total time of effective runs: 1.0555E-4 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])                                                                                                                                                               HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#472]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])
!                                                                                                                                                                                                                                       +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#472]                                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#476]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])                                                                                                                                                       +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])                                                                                                                                                                     *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#476]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#482]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])                                                                                                                                                          +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])
!      +- ColumnarToRow                                                                                                                                                                                                                       +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])                                                                                                                                                               *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1474L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])                                                                                                                                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#482]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1477L])
!                                                                                                                                                                                                                                       +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/reason], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_69 stored as values in memory (estimated size 292.3 KiB, free 363.1 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_69_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_69_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 69 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4196659 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 158 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 17
22/07/26 14:21:17 INFO DAGScheduler: Got job 35 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 53 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 52)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 52)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 52 (MapPartitionsRDD[158] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_70 stored as values in memory (estimated size 14.7 KiB, free 363.0 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_70_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_70_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 70 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 52 (MapPartitionsRDD[158] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 52.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 52.0 (TID 52) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4939 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 52.0 (TID 52)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/reason/part-00000-7028bd2a-b0eb-4fca-9d95-309bc6222aec-c000.snappy.parquet, range: 0-2355, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 52.0 (TID 52). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 52.0 (TID 52) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 52.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 52 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.014 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 53)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 53 (MapPartitionsRDD[161] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_71 stored as values in memory (estimated size 10.1 KiB, free 363.0 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_71_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_71_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 71 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 53 (MapPartitionsRDD[161] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 53.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 53.0 (TID 53) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 53.0 (TID 53)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 53.0 (TID 53). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 53.0 (TID 53) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 53.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 53 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.009 s
22/07/26 14:21:17 INFO DAGScheduler: Job 35 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 53: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 35 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.026001 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_62_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO DAGScheduler: Got job 36 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 54 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 54 (MapPartitionsRDD[163] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_65_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_45_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_51_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 365.9 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_49_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_56_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_68_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_72 stored as values in memory (estimated size 74.3 KiB, free 364.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_70_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_72_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_72_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 72 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 54 (MapPartitionsRDD[163] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 54.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 54.0 (TID 54) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4704 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_71_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 54.0 (TID 54)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_58_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_59_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_66_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_52_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_54_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_63_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 54.0 (TID 54). 3461 bytes result sent to driver
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_48_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 54.0 (TID 54) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 54.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 54 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.019 s
22/07/26 14:21:17 INFO DAGScheduler: Job 36 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 54: Stage finished
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_67_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO DAGScheduler: Job 36 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.021168 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_55_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001145904 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_53_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_57_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_50_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_64_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_61_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.51377E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 INFO BlockManagerInfo: Removed broadcast_60_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 8.56322E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [call_center], [], false   SubqueryAlias call_center
!                                               +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [call_center], [], false   SubqueryAlias call_center
!                                               +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 7.97379E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.0115E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1603L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1603L]
 +- SubqueryAlias call_center                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- SubqueryAlias call_center
    +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet      +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1603L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1603L]
 +- SubqueryAlias call_center                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- SubqueryAlias call_center
    +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet      +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001029364 seconds
Total number of effective runs: 1
Total time of effective runs: 2.2749E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1603L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1603L]
!+- SubqueryAlias call_center                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
!   +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1603L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Aggregate [count(1) AS count#1603L]
!+- SubqueryAlias call_center                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
!   +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1603L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1603L]
!+- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1603L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Aggregate [count(1) AS count#1603L]
!+- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet   +- Project
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Relation[cc_call_center_sk#1478,cc_call_center_id#1479,cc_rec_start_date#1480,cc_rec_end_date#1481,cc_closed_date_sk#1482,cc_open_date_sk#1483,cc_name#1484,cc_class#1485,cc_employees#1486,cc_sq_ft#1487,cc_hours#1488,cc_manager#1489,cc_mkt_id#1490,cc_mkt_class#1491,cc_mkt_desc#1492,cc_market_manager#1493,cc_division#1494,cc_division_name#1495,cc_company#1496,cc_company_name#1497,cc_street_number#1498,cc_street_name#1499,cc_street_type#1500,cc_suite_number#1501,... 7 more fields] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003660303 seconds
Total number of effective runs: 2
Total time of effective runs: 1.24133E-4 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#499]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])                                                                                                                                                                       HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#499]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#503]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])                                                                                                                                                            +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                  +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])                                                                                                                                                                          *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#503]                                                                                                                                                                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#509]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])                                                                                                                                                               +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])
!      +- ColumnarToRow                                                                                                                                                                                                                            +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])                                                                                                                                                                    *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1603L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#509]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1606L])
!                                                                                                                                                                                                                                            +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/call_center], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_73 stored as values in memory (estimated size 292.3 KiB, free 365.3 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_73_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 365.3 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_73_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.2 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 73 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4204207 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 167 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 18
22/07/26 14:21:17 INFO DAGScheduler: Got job 37 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 56 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 55)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 55)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 55 (MapPartitionsRDD[167] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_74 stored as values in memory (estimated size 14.7 KiB, free 365.3 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_74_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 365.3 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_74_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 74 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 55 (MapPartitionsRDD[167] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 55.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 55.0 (TID 55) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 55.0 (TID 55)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/call_center/part-00000-ac81dc0f-2ae2-4682-a4d0-3e6a9fb1ec78-c000.snappy.parquet, range: 0-9903, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 55.0 (TID 55). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 55.0 (TID 55) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 55.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 55 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.013 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 56)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 56 (MapPartitionsRDD[170] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_75 stored as values in memory (estimated size 10.1 KiB, free 365.2 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_75_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 365.2 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_75_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 75 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 56 (MapPartitionsRDD[170] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 56.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 56.0 (TID 56) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 56.0 (TID 56)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 56.0 (TID 56). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 56.0 (TID 56) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 56.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 56 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.007 s
22/07/26 14:21:17 INFO DAGScheduler: Job 37 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 56: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 37 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.024307 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 38 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 57 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 57 (MapPartitionsRDD[172] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_76 stored as values in memory (estimated size 74.3 KiB, free 365.2 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_76_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 365.1 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_76_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 76 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 57 (MapPartitionsRDD[172] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 57.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 57.0 (TID 57) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4702 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 57.0 (TID 57)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 57.0 (TID 57). 2634 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 57.0 (TID 57) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 57.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 57 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:17 INFO DAGScheduler: Job 38 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 57: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 38 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.020534 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 8.10062E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.98477E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 7.5463E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [warehouse], [], false   SubqueryAlias warehouse
!                                             +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [warehouse], [], false   SubqueryAlias warehouse
!                                             +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 7.13811E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.1709E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1664L]                                                                                                                                                                                                                                              Aggregate [count(1) AS count#1664L]
 +- SubqueryAlias warehouse                                                                                                                                                                                                                                                       +- SubqueryAlias warehouse
    +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet      +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1664L]                                                                                                                                                                                                                                              Aggregate [count(1) AS count#1664L]
 +- SubqueryAlias warehouse                                                                                                                                                                                                                                                       +- SubqueryAlias warehouse
    +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet      +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 9.91729E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 2.4019E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1664L]                                                                                                                                                                                                                                              Aggregate [count(1) AS count#1664L]
!+- SubqueryAlias warehouse                                                                                                                                                                                                                                                       +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
!   +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1664L]                                                                                                                                                                                                                                              Aggregate [count(1) AS count#1664L]
!+- SubqueryAlias warehouse                                                                                                                                                                                                                                                       +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
!   +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1664L]                                                                                                                                                                                                                                           Aggregate [count(1) AS count#1664L]
!+- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet   +- Project
!                                                                                                                                                                                                                                                                                 +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1664L]                                                                                                                                                                                                                                           Aggregate [count(1) AS count#1664L]
!+- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet   +- Project
!                                                                                                                                                                                                                                                                                 +- Relation[w_warehouse_sk#1607,w_warehouse_id#1608,w_warehouse_name#1609,w_warehouse_sq_ft#1610,w_street_number#1611,w_street_name#1612,w_street_type#1613,w_suite_number#1614,w_city#1615,w_county#1616,w_state#1617,w_zip#1618,w_country#1619,w_gmt_offset#1620] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003219292 seconds
Total number of effective runs: 2
Total time of effective runs: 1.00656E-4 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#526]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])
!                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])                                                                                                                                                                     HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#526]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#530]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])                                                                                                                                                          +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])                                                                                                                                                                        *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#530]                                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#536]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])                                                                                                                                                             +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])
!      +- ColumnarToRow                                                                                                                                                                                                                          +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])                                                                                                                                                                  *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1664L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#536]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1667L])
!                                                                                                                                                                                                                                          +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_77 stored as values in memory (estimated size 292.3 KiB, free 364.9 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_77_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_77_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 77 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4198541 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 176 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 19
22/07/26 14:21:17 INFO DAGScheduler: Got job 39 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 59 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 58)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 58)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 58 (MapPartitionsRDD[176] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_78 stored as values in memory (estimated size 14.7 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_78_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_78_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 78 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 58 (MapPartitionsRDD[176] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 58.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 58.0 (TID 58) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4942 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 58.0 (TID 58)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/warehouse/part-00000-eb67ef30-77e8-4b8a-bc00-352ba72f876f-c000.snappy.parquet, range: 0-4237, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 58.0 (TID 58). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 58.0 (TID 58) in 9 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 58.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 58 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.015 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 59)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 59 (MapPartitionsRDD[179] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_79 stored as values in memory (estimated size 10.1 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_79_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.8 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_79_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 79 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 59 (MapPartitionsRDD[179] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 59.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 59.0 (TID 59) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 59.0 (TID 59)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 59.0 (TID 59). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 59.0 (TID 59) in 5 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 59.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 59 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:17 INFO DAGScheduler: Job 39 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 59: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 39 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.025989 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 40 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 60 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 60 (MapPartitionsRDD[181] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_80 stored as values in memory (estimated size 74.3 KiB, free 364.7 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_80_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.7 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_80_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 80 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 60 (MapPartitionsRDD[181] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 60.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 60.0 (TID 60) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4702 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 60.0 (TID 60)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 60.0 (TID 60). 1876 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 60.0 (TID 60) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 60.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 60 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.016 s
22/07/26 14:21:17 INFO DAGScheduler: Job 40 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 60: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 40 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.018334 s
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 6.96531E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.50223E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 9.13269E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [ship_mode], [], false   SubqueryAlias ship_mode
!                                             +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [ship_mode], [], false   SubqueryAlias ship_mode
!                                             +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 6.72208E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 5.3611E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1693L]                                                                                            Aggregate [count(1) AS count#1693L]
 +- SubqueryAlias ship_mode                                                                                                     +- SubqueryAlias ship_mode
    +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet      +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1693L]                                                                                            Aggregate [count(1) AS count#1693L]
 +- SubqueryAlias ship_mode                                                                                                     +- SubqueryAlias ship_mode
    +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet      +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 8.64961E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 2.1296E-5 seconds
      
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1693L]                                                                                            Aggregate [count(1) AS count#1693L]
!+- SubqueryAlias ship_mode                                                                                                     +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
!   +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet   
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1693L]                                                                                            Aggregate [count(1) AS count#1693L]
!+- SubqueryAlias ship_mode                                                                                                     +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
!   +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet   
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1693L]                                                                                         Aggregate [count(1) AS count#1693L]
!+- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet   +- Project
!                                                                                                                               +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1693L]                                                                                         Aggregate [count(1) AS count#1693L]
!+- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet   +- Project
!                                                                                                                               +- Relation[sm_ship_mode_sk#1668,sm_ship_mode_id#1669,sm_type#1670,sm_code#1671,sm_carrier#1672,sm_contract#1673] parquet
          
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.002951337 seconds
Total number of effective runs: 2
Total time of effective runs: 9.6525E-5 seconds
      
22/07/26 14:21:17 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:17 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])                                                                                                                                                                  HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#553]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])
!                                                                                                                                                                                                                                          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])                                                                                                                                                                     HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#553]                                                                                                                                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#557]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])                                                                                                                                                          +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])                                                                                                                                                                        *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#557]                                                                                                                                                                               +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#563]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])                                                                                                                                                             +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])
!      +- ColumnarToRow                                                                                                                                                                                                                          +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:17 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])                                                                                                                                                                  *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1693L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])                                                                                                                                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#563]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1696L])
!                                                                                                                                                                                                                                          +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                             +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_81 stored as values in memory (estimated size 292.3 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_81_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_81_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 81 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4197051 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Registering RDD 185 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 20
22/07/26 14:21:17 INFO DAGScheduler: Got job 41 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 62 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 61)
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 61)
22/07/26 14:21:17 INFO DAGScheduler: Submitting ShuffleMapStage 61 (MapPartitionsRDD[185] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_82 stored as values in memory (estimated size 14.7 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_82_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_82_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 82 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 61 (MapPartitionsRDD[185] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 61.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 61.0 (TID 61) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4942 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 61.0 (TID 61)
22/07/26 14:21:17 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/ship_mode/part-00000-c7237fcf-e950-4477-984c-a2336f0c318d-c000.snappy.parquet, range: 0-2747, partition values: [empty row]
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 61.0 (TID 61). 2132 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 61.0 (TID 61) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 61.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ShuffleMapStage 61 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.013 s
22/07/26 14:21:17 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:17 INFO DAGScheduler: running: Set()
22/07/26 14:21:17 INFO DAGScheduler: waiting: Set(ResultStage 62)
22/07/26 14:21:17 INFO DAGScheduler: failed: Set()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 62 (MapPartitionsRDD[188] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_83 stored as values in memory (estimated size 10.1 KiB, free 364.4 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_83_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 364.3 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_83_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 83 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 62 (MapPartitionsRDD[188] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 62.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 62.0 (TID 62) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 62.0 (TID 62)
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:17 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 62.0 (TID 62). 2648 bytes result sent to driver
22/07/26 14:21:17 INFO TaskSetManager: Finished task 0.0 in stage 62.0 (TID 62) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:17 INFO TaskSchedulerImpl: Removed TaskSet 62.0, whose tasks have all completed, from pool 
22/07/26 14:21:17 INFO DAGScheduler: ResultStage 62 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:17 INFO DAGScheduler: Job 41 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 62: Stage finished
22/07/26 14:21:17 INFO DAGScheduler: Job 41 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.023682 s
22/07/26 14:21:17 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:17 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:17 INFO DAGScheduler: Got job 42 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:17 INFO DAGScheduler: Final stage: ResultStage 63 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:17 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:17 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:17 INFO DAGScheduler: Submitting ResultStage 63 (MapPartitionsRDD[190] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_84 stored as values in memory (estimated size 74.3 KiB, free 364.3 MiB)
22/07/26 14:21:17 INFO MemoryStore: Block broadcast_84_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 364.2 MiB)
22/07/26 14:21:17 INFO BlockManagerInfo: Added broadcast_84_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:17 INFO SparkContext: Created broadcast 84 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 63 (MapPartitionsRDD[190] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:17 INFO TaskSchedulerImpl: Adding task set 63.0 with 1 tasks resource profile 0
22/07/26 14:21:17 INFO TaskSetManager: Starting task 0.0 in stage 63.0 (TID 63) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4704 bytes) taskResourceAssignments Map()
22/07/26 14:21:17 INFO Executor: Running task 0.0 in stage 63.0 (TID 63)
22/07/26 14:21:17 INFO Executor: Finished task 0.0 in stage 63.0 (TID 63). 1711 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 63.0 (TID 63) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 63.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ResultStage 63 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:18 INFO DAGScheduler: Job 42 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 63: Stage finished
22/07/26 14:21:18 INFO DAGScheduler: Job 42 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.019632 s
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 6.48689E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.52922E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 9.60005E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [income_band], [], false   SubqueryAlias income_band
!                                               +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [income_band], [], false   SubqueryAlias income_band
!                                               +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 7.04793E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 6.5719E-5 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1710L]                                                      Aggregate [count(1) AS count#1710L]
 +- SubqueryAlias income_band                                                             +- SubqueryAlias income_band
    +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet      +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1710L]                                                      Aggregate [count(1) AS count#1710L]
 +- SubqueryAlias income_band                                                             +- SubqueryAlias income_band
    +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet      +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 9.77943E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 3.6237E-5 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1710L]                                                      Aggregate [count(1) AS count#1710L]
!+- SubqueryAlias income_band                                                             +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
!   +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet   
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1710L]                                                      Aggregate [count(1) AS count#1710L]
!+- SubqueryAlias income_band                                                             +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
!   +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet   
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1710L]                                                   Aggregate [count(1) AS count#1710L]
!+- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet   +- Project
!                                                                                         +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1710L]                                                   Aggregate [count(1) AS count#1710L]
!+- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet   +- Project
!                                                                                         +- Relation[ib_income_band_sk#1697,ib_lower_bound#1698,ib_upper_bound#1699] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.002928299 seconds
Total number of effective runs: 2
Total time of effective runs: 1.30111E-4 seconds
      
22/07/26 14:21:18 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:18 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:18 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#580]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])                                                                                                                                                                       HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#580]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#584]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])                                                                                                                                                            +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                                  +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])                                                                                                                                                                          *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#584]                                                                                                                                                                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#590]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])                                                                                                                                                               +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])
!      +- ColumnarToRow                                                                                                                                                                                                                            +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])                                                                                                                                                                    *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1710L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])                                                                                                                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#590]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1713L])
!                                                                                                                                                                                                                                            +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/income_band], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_85 stored as values in memory (estimated size 292.3 KiB, free 364.0 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_85_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.9 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_85_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 85 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4195484 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:18 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO DAGScheduler: Registering RDD 194 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 21
22/07/26 14:21:18 INFO DAGScheduler: Got job 43 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:18 INFO DAGScheduler: Final stage: ResultStage 65 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:18 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 64)
22/07/26 14:21:18 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 64)
22/07/26 14:21:18 INFO DAGScheduler: Submitting ShuffleMapStage 64 (MapPartitionsRDD[194] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_86 stored as values in memory (estimated size 14.7 KiB, free 363.9 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_86_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.9 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_86_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 86 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 64 (MapPartitionsRDD[194] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 64.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 64.0 (TID 64) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 64.0 (TID 64)
22/07/26 14:21:18 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/income_band/part-00000-599c2a33-2d5a-4a45-83c8-0de9b84ed03c-c000.snappy.parquet, range: 0-1180, partition values: [empty row]
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 64.0 (TID 64). 2132 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 64.0 (TID 64) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ShuffleMapStage 64 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.011 s
22/07/26 14:21:18 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:18 INFO DAGScheduler: running: Set()
22/07/26 14:21:18 INFO DAGScheduler: waiting: Set(ResultStage 65)
22/07/26 14:21:18 INFO DAGScheduler: failed: Set()
22/07/26 14:21:18 INFO DAGScheduler: Submitting ResultStage 65 (MapPartitionsRDD[197] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_87 stored as values in memory (estimated size 10.1 KiB, free 363.9 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_87_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.9 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_87_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 87 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 65 (MapPartitionsRDD[197] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 65.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 65.0 (TID 65) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 65.0 (TID 65)
22/07/26 14:21:18 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:18 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 65.0 (TID 65). 2648 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 65.0 (TID 65) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 65.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ResultStage 65 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:18 INFO DAGScheduler: Job 43 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 65: Stage finished
22/07/26 14:21:18 INFO DAGScheduler: Job 43 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.022754 s
22/07/26 14:21:18 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:18 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO DAGScheduler: Got job 44 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:18 INFO DAGScheduler: Final stage: ResultStage 66 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:18 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:18 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:18 INFO DAGScheduler: Submitting ResultStage 66 (MapPartitionsRDD[199] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_88 stored as values in memory (estimated size 74.3 KiB, free 363.8 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_88_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 363.8 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_88_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 88 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 66 (MapPartitionsRDD[199] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 66.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 66.0 (TID 66) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4701 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 66.0 (TID 66)
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 66.0 (TID 66). 2017 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 66.0 (TID 66) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 66.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ResultStage 66 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.018 s
22/07/26 14:21:18 INFO DAGScheduler: Job 44 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 66: Stage finished
22/07/26 14:21:18 INFO DAGScheduler: Job 44 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.018803 s
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 7.07452E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 4.36449E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 6.67145E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [time_dim], [], false   SubqueryAlias time_dim
!                                            +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [time_dim], [], false   SubqueryAlias time_dim
!                                            +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 6.13816E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 6.5761E-5 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1755L]                                                                                                                                     Aggregate [count(1) AS count#1755L]
 +- SubqueryAlias time_dim                                                                                                                                               +- SubqueryAlias time_dim
    +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet      +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1755L]                                                                                                                                     Aggregate [count(1) AS count#1755L]
 +- SubqueryAlias time_dim                                                                                                                                               +- SubqueryAlias time_dim
    +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet      +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 8.3514E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 2.2056E-5 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1755L]                                                                                                                                     Aggregate [count(1) AS count#1755L]
!+- SubqueryAlias time_dim                                                                                                                                               +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
!   +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet   
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1755L]                                                                                                                                     Aggregate [count(1) AS count#1755L]
!+- SubqueryAlias time_dim                                                                                                                                               +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
!   +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet   
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1755L]                                                                                                                                  Aggregate [count(1) AS count#1755L]
!+- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet   +- Project
!                                                                                                                                                                        +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1755L]                                                                                                                                  Aggregate [count(1) AS count#1755L]
!+- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet   +- Project
!                                                                                                                                                                        +- Relation[t_time_sk#1714,t_time_id#1715,t_time#1716,t_hour#1717,t_minute#1718,t_second#1719,t_am_pm#1720,t_shift#1721,t_sub_shift#1722,t_meal_time#1723] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.002736124 seconds
Total number of effective runs: 2
Total time of effective runs: 7.9911E-5 seconds
      
22/07/26 14:21:18 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:18 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:18 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])                                                                                                                                                                 HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#607]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])
!                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#607]                                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#611]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])                                                                                                                                                         +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])                                                                                                                                                                       *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#611]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#617]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])                                                                                                                                                            +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])
!      +- ColumnarToRow                                                                                                                                                                                                                         +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])                                                                                                                                                                 *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1755L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#617]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1758L])
!                                                                                                                                                                                                                                         +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_89 stored as values in memory (estimated size 292.3 KiB, free 363.5 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_89_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.5 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_89_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 89 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 5322828 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:18 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO DAGScheduler: Registering RDD 203 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 22
22/07/26 14:21:18 INFO DAGScheduler: Got job 45 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:18 INFO DAGScheduler: Final stage: ResultStage 68 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:18 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 67)
22/07/26 14:21:18 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 67)
22/07/26 14:21:18 INFO DAGScheduler: Submitting ShuffleMapStage 67 (MapPartitionsRDD[203] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_90 stored as values in memory (estimated size 14.7 KiB, free 363.5 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_90_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.5 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_90_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 90 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 67 (MapPartitionsRDD[203] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 67.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 67.0 (TID 67) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4941 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 67.0 (TID 67)
22/07/26 14:21:18 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/time_dim/part-00000-dbd4ab3a-6a12-462e-8f1e-f4be1a0a40d1-c000.snappy.parquet, range: 0-1128524, partition values: [empty row]
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 67.0 (TID 67). 2132 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 67.0 (TID 67) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 67.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ShuffleMapStage 67 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:18 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:18 INFO DAGScheduler: running: Set()
22/07/26 14:21:18 INFO DAGScheduler: waiting: Set(ResultStage 68)
22/07/26 14:21:18 INFO DAGScheduler: failed: Set()
22/07/26 14:21:18 INFO DAGScheduler: Submitting ResultStage 68 (MapPartitionsRDD[206] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_91 stored as values in memory (estimated size 10.1 KiB, free 363.5 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_91_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.5 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_91_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 91 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 68 (MapPartitionsRDD[206] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 68.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 68.0 (TID 68) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 68.0 (TID 68)
22/07/26 14:21:18 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:18 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 68.0 (TID 68). 2648 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 68.0 (TID 68) in 3 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 68.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ResultStage 68 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.008 s
22/07/26 14:21:18 INFO DAGScheduler: Job 45 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 68: Stage finished
22/07/26 14:21:18 INFO DAGScheduler: Job 45 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.023021 s
22/07/26 14:21:18 INFO InMemoryFileIndex: It took 0 ms to list leaf files for 1 paths.
22/07/26 14:21:18 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO DAGScheduler: Got job 46 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:18 INFO DAGScheduler: Final stage: ResultStage 69 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:18 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:18 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:18 INFO DAGScheduler: Submitting ResultStage 69 (MapPartitionsRDD[208] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_92 stored as values in memory (estimated size 74.3 KiB, free 363.4 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_92_piece0 stored as bytes in memory (estimated size 26.7 KiB, free 363.4 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_92_piece0 in memory on szcdoc01:37657 (size: 26.7 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 92 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 69 (MapPartitionsRDD[208] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 69.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 69.0 (TID 69) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4701 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 69.0 (TID 69)
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 69.0 (TID 69). 2303 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 69.0 (TID 69) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 69.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ResultStage 69 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.017 s
22/07/26 14:21:18 INFO DAGScheduler: Job 46 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 69: Stage finished
22/07/26 14:21:18 INFO DAGScheduler: Job 46 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.018275 s
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.002775747 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 5.1942E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Finish Analysis has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization before Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 145
Total time: 7.12483E-4 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Preparations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
!'UnresolvedRelation [web_page], [], false   SubqueryAlias web_page
!                                            +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'UnresolvedRelation [web_page], [], false   SubqueryAlias web_page
!                                            +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 149
Total time: 6.78725E-4 seconds
Total number of effective runs: 1
Total time of effective runs: 6.0215E-5 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Aggregate [count(1) AS count#1816L]                                                                                                                                                                                                                                                                            Aggregate [count(1) AS count#1816L]
 +- SubqueryAlias web_page                                                                                                                                                                                                                                                                                      +- SubqueryAlias web_page
    +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet      +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Aggregate [count(1) AS count#1816L]                                                                                                                                                                                                                                                                            Aggregate [count(1) AS count#1816L]
 +- SubqueryAlias web_page                                                                                                                                                                                                                                                                                      +- SubqueryAlias web_page
    +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet      +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 87
Total time: 0.001041711 seconds
Total number of effective runs: 1
Total time of effective runs: 2.5856E-5 seconds
      
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 Aggregate [count(1) AS count#1816L]                                                                                                                                                                                                                                                                            Aggregate [count(1) AS count#1816L]
!+- SubqueryAlias web_page                                                                                                                                                                                                                                                                                      +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
!   +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet   
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 Aggregate [count(1) AS count#1816L]                                                                                                                                                                                                                                                                            Aggregate [count(1) AS count#1816L]
!+- SubqueryAlias web_page                                                                                                                                                                                                                                                                                      +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
!   +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet   
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 Aggregate [count(1) AS count#1816L]                                                                                                                                                                                                                                                                         Aggregate [count(1) AS count#1816L]
!+- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet   +- Project
!                                                                                                                                                                                                                                                                                                               +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 Aggregate [count(1) AS count#1816L]                                                                                                                                                                                                                                                                         Aggregate [count(1) AS count#1816L]
!+- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet   +- Project
!                                                                                                                                                                                                                                                                                                               +- Relation[wp_web_page_sk#1759,wp_web_page_id#1760,wp_rec_start_date#1761,wp_rec_end_date#1762,wp_creation_date_sk#1763,wp_access_date_sk#1764,wp_autogen_flag#1765,wp_customer_sk#1766,wp_url#1767,wp_type#1768,wp_char_count#1769,wp_link_count#1770,wp_image_count#1771,wp_max_ad_count#1772] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Infer Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Operator Optimization after Inferring Filters has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch RewriteSubquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 186
Total time: 0.003258998 seconds
Total number of effective runs: 2
Total time of effective runs: 9.6314E-5 seconds
      
22/07/26 14:21:18 INFO FileSourceStrategy: Pushed Filters: 
22/07/26 14:21:18 INFO FileSourceStrategy: Post-Scan Filters: 
22/07/26 14:21:18 INFO FileSourceStrategy: Output Data Schema: struct<>
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])                                                                                                                                                                 HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#634]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])
!                                                                                                                                                                                                                                         +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])                                                                                                                                                                    HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#634]                                                                                                                                                                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#638]
    +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])                                                                                                                                                         +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])
!      +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>         +- ColumnarToRow
!                                                                                                                                                                                                                                               +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])                                                                                                                                                                       *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])
!+- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#638]                                                                                                                                                                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#644]
!   +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])                                                                                                                                                            +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])
!      +- ColumnarToRow                                                                                                                                                                                                                         +- *(1) ColumnarToRow
          +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
!HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])                                                                                                                                                                 *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#1816L])
!+- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])                                                                                                                                                      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#644]
!   +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>      +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#1819L])
!                                                                                                                                                                                                                                         +- *(1) ColumnarToRow
!                                                                                                                                                                                                                                            +- FileScan parquet [] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/web_page], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>
          
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_93 stored as values in memory (estimated size 292.3 KiB, free 363.1 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_93_piece0 stored as bytes in memory (estimated size 24.7 KiB, free 363.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_93_piece0 in memory on szcdoc01:37657 (size: 24.7 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 93 from runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4199818 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:18 INFO SparkContext: Starting job: runBenchmarkSuite at BenchmarkBase.scala:58
22/07/26 14:21:18 INFO DAGScheduler: Registering RDD 212 (runBenchmarkSuite at BenchmarkBase.scala:58) as input to shuffle 23
22/07/26 14:21:18 INFO DAGScheduler: Got job 47 (runBenchmarkSuite at BenchmarkBase.scala:58) with 1 output partitions
22/07/26 14:21:18 INFO DAGScheduler: Final stage: ResultStage 71 (runBenchmarkSuite at BenchmarkBase.scala:58)
22/07/26 14:21:18 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 70)
22/07/26 14:21:18 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 70)
22/07/26 14:21:18 INFO DAGScheduler: Submitting ShuffleMapStage 70 (MapPartitionsRDD[212] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_94 stored as values in memory (estimated size 14.7 KiB, free 363.0 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_94_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 363.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_94_piece0 in memory on szcdoc01:37657 (size: 7.0 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 94 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 70 (MapPartitionsRDD[212] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 70.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 70.0 (TID 70) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4941 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 70.0 (TID 70)
22/07/26 14:21:18 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/web_page/part-00000-839160cf-2fba-447c-8eba-878824455c6a-c000.snappy.parquet, range: 0-5514, partition values: [empty row]
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 70.0 (TID 70). 2132 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 70.0 (TID 70) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 70.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ShuffleMapStage 70 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.012 s
22/07/26 14:21:18 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:18 INFO DAGScheduler: running: Set()
22/07/26 14:21:18 INFO DAGScheduler: waiting: Set(ResultStage 71)
22/07/26 14:21:18 INFO DAGScheduler: failed: Set()
22/07/26 14:21:18 INFO DAGScheduler: Submitting ResultStage 71 (MapPartitionsRDD[215] at runBenchmarkSuite at BenchmarkBase.scala:58), which has no missing parents
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_95 stored as values in memory (estimated size 10.1 KiB, free 363.0 MiB)
22/07/26 14:21:18 INFO MemoryStore: Block broadcast_95_piece0 stored as bytes in memory (estimated size 5.0 KiB, free 363.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Added broadcast_95_piece0 in memory on szcdoc01:37657 (size: 5.0 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO SparkContext: Created broadcast 95 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 71 (MapPartitionsRDD[215] at runBenchmarkSuite at BenchmarkBase.scala:58) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:18 INFO TaskSchedulerImpl: Adding task set 71.0 with 1 tasks resource profile 0
22/07/26 14:21:18 INFO TaskSetManager: Starting task 0.0 in stage 71.0 (TID 71) (szcdoc01, executor driver, partition 0, NODE_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:18 INFO Executor: Running task 0.0 in stage 71.0 (TID 71)
22/07/26 14:21:18 INFO ShuffleBlockFetcherIterator: Getting 1 (60.0 B) non-empty blocks including 1 (60.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:18 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:18 INFO Executor: Finished task 0.0 in stage 71.0 (TID 71). 2648 bytes result sent to driver
22/07/26 14:21:18 INFO TaskSetManager: Finished task 0.0 in stage 71.0 (TID 71) in 4 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:18 INFO TaskSchedulerImpl: Removed TaskSet 71.0, whose tasks have all completed, from pool 
22/07/26 14:21:18 INFO DAGScheduler: ResultStage 71 (runBenchmarkSuite at BenchmarkBase.scala:58) finished in 0.007 s
22/07/26 14:21:18 INFO DAGScheduler: Job 47 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 71: Stage finished
22/07/26 14:21:18 INFO DAGScheduler: Job 47 finished: runBenchmarkSuite at BenchmarkBase.scala:58, took 0.022941 s
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1820]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1820]
          :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1820]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1820]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                                                                                                                                                     :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                                                                                                                                                       :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_73_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_90_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_85_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 365.9 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_76_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_91_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_95_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_84_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_89_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_79_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.0 MiB)
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1820]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_78_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.0 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_72_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_75_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_81_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_77_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_83_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_74_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_88_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.1 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_80_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_86_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_92_piece0 on szcdoc01:37657 in memory (size: 26.7 KiB, free: 366.2 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_82_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_87_piece0 on szcdoc01:37657 in memory (size: 5.0 KiB, free: 366.2 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_94_piece0 on szcdoc01:37657 in memory (size: 7.0 KiB, free: 366.2 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_69_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.3 MiB)
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$Division ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$CaseWhenCoercion ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= 1) AND (cnt#1820L <= 5)))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= 1) AND (cnt#1820L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= 1) AND (cnt#1820L <= 5)))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= 1) AND (cnt#1820L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Sort [cnt#1820L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 Sort [cnt#1820L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1820L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Sort [cnt#1820L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1820]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Sort [cnt#1820L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1820L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Sort [cnt#1820L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1820L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1820L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1820L >= cast(1 as bigint)) AND (cnt#1820L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1820L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 339
Total time: 0.143480747 seconds
Total number of effective runs: 13
Total time of effective runs: 0.054368135 seconds
      
Running benchmark: TPCDS Snappy
  Running case: q73
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_93_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.3 MiB)
22/07/26 14:21:18 INFO BlockManagerInfo: Removed broadcast_1_piece0 on szcdoc01:37657 in memory (size: 24.7 KiB, free: 366.3 MiB)
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1828]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1828]
          :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1828]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1828]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                                                                                                                                                     :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                                                                                                                                                       :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1828]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$Division ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$CaseWhenCoercion ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= 1) AND (cnt#1828L <= 5)))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= 1) AND (cnt#1828L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= 1) AND (cnt#1828L <= 5)))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= 1) AND (cnt#1828L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Sort [cnt#1828L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1828L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Sort [cnt#1828L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1828]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1828L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1828L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:18 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 339
Total time: 0.049093291 seconds
Total number of effective runs: 13
Total time of effective runs: 0.01927218 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.003015804 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
          
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ReorderJoin ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
             :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                        :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                     :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                          :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :- Filter ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint)))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!            :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                      :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))                                                                                                                                                                                                                                                                                                                                                                         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                           :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!         :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                           :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                  :           :     :     +- Project [d_date_sk#329]
!         :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!         +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.NullPropagation ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
          :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ConstantFolding ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))                                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1828L >= cast(1 as bigint)) AND (cnt#1828L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                       :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.InferFiltersFromConstraints ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Result of Batch Infer Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter (((cnt#1828L >= 1) AND (cnt#1828L <= 5)) AND isnotnull(ss_customer_sk#1157))
!         :  +- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Project [d_date_sk#329]
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     +- Project [s_store_sk#666]
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter (((cnt#1828L >= 1) AND (cnt#1828L <= 5)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
          :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Project [d_date_sk#329]
          :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
          :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [hd_demo_sk#446]
          :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                             +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                             :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     +- Project [s_store_sk#666]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           +- Project [hd_demo_sk#446]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                +- Filter isnotnull(c_customer_sk#154)
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                 
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization after Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!         :  +- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    +- Filter isnotnull(c_customer_sk#154)
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
          
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.RewritePredicateSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Result of Batch RewriteSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1828L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1828L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1828L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:19 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 309
Total time: 0.169013898 seconds
Total number of effective runs: 11
Total time of effective runs: 0.036542981 seconds
      
22/07/26 14:21:19 INFO FileSourceStrategy: Pushed Filters: IsNotNull(ss_sold_date_sk),IsNotNull(ss_store_sk),IsNotNull(ss_hdemo_sk),IsNotNull(ss_customer_sk)
22/07/26 14:21:19 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(ss_sold_date_sk#1154),isnotnull(ss_store_sk#1161),isnotnull(ss_hdemo_sk#1159),isnotnull(ss_customer_sk#1157)
22/07/26 14:21:19 INFO FileSourceStrategy: Output Data Schema: struct<ss_sold_date_sk: int, ss_customer_sk: int, ss_hdemo_sk: int, ss_store_sk: int, ss_ticket_number: int ... 3 more fields>
22/07/26 14:21:19 INFO FileSourceStrategy: Pushed Filters: IsNotNull(d_dom),GreaterThanOrEqual(d_dom,1),LessThanOrEqual(d_dom,2),In(d_year, [1999,2000,2001]),IsNotNull(d_date_sk)
22/07/26 14:21:19 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(d_dom#338),(d_dom#338 >= 1),(d_dom#338 <= 2),d_year#335 IN (1999,2000,2001),isnotnull(d_date_sk#329)
22/07/26 14:21:19 INFO FileSourceStrategy: Output Data Schema: struct<d_date_sk: int, d_year: int, d_dom: int ... 1 more fields>
22/07/26 14:21:19 INFO FileSourceStrategy: Pushed Filters: In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]),IsNotNull(s_store_sk)
22/07/26 14:21:19 INFO FileSourceStrategy: Post-Scan Filters: s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County),isnotnull(s_store_sk#666)
22/07/26 14:21:19 INFO FileSourceStrategy: Output Data Schema: struct<s_store_sk: int, s_county: string>
22/07/26 14:21:19 INFO FileSourceStrategy: Pushed Filters: IsNotNull(hd_vehicle_count),Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknown)),GreaterThan(hd_vehicle_count,0),IsNotNull(hd_demo_sk)
22/07/26 14:21:19 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(hd_vehicle_count#450),((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)),(hd_vehicle_count#450 > 0),(CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0),isnotnull(hd_demo_sk#446)
22/07/26 14:21:19 INFO FileSourceStrategy: Output Data Schema: struct<hd_demo_sk: int, hd_buy_potential: string, hd_dep_count: int, hd_vehicle_count: int ... 2 more fields>
22/07/26 14:21:19 INFO FileSourceStrategy: Pushed Filters: IsNotNull(c_customer_sk)
22/07/26 14:21:19 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(c_customer_sk#154)
22/07/26 14:21:19 INFO FileSourceStrategy: Output Data Schema: struct<c_customer_sk: int, c_salutation: string, c_first_name: string, c_last_name: string, c_preferred_cust_flag: string ... 3 more fields>
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.RemoveRedundantProjects ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd
 +- Sort [cnt#1828L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1828L DESC NULLS LAST], true, 0
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
       +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
          :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
          :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])
          :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])
          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
          :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
          :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>            :              :     :     +- Project [d_date_sk#329]
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :              :     +- Project [s_store_sk#666]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :              +- Project [hd_demo_sk#446]
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   +- Filter isnotnull(c_customer_sk#154)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                   
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd                                                                                                                                                                                                                                                                                                                                                                                                                                                         OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd
 +- Sort [cnt#1828L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Sort [cnt#1828L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Exchange rangepartitioning(cnt#1828L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#772]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
!         :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#764]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#751]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :        +- Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#755]
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                 :        +- Project [s_store_sk#666]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#759]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                    +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#768]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd
 +- Sort [cnt#1828L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Sort [cnt#1828L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1828L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#772]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Exchange rangepartitioning(cnt#1828L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#804]
       +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
          +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
             :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
             :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#764]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#796]
             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])
             :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
             :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
             :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
             :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
             :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
             :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :  +- ColumnarToRow
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#751]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#780]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :        +- Project [d_date_sk#329]
!            :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#755]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :              +- ColumnarToRow
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#786]
!            :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :        +- Project [s_store_sk#666]
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#759]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :              +- ColumnarToRow
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                 :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#792]
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#768]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                    +- Project [hd_demo_sk#446]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                  +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                          +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#801]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd
!+- Sort [cnt#1828L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- *(7) Sort [cnt#1828L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1828L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#804]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Exchange rangepartitioning(cnt#1828L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#852]
!      +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
!         +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!            :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- *(6) Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!            :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#796]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#839]
!            :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])
!            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!            :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :  +- *(4) ColumnarToRow
             :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#780]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#815]
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :        +- *(1) Project [d_date_sk#329]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :              +- *(1) ColumnarToRow
             :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#786]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#824]
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :        +- *(2) Project [s_store_sk#666]
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                 :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :              +- *(2) ColumnarToRow
             :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#792]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#833]
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                    +- *(3) Project [hd_demo_sk#446]
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!            :                          +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                          +- *(3) ColumnarToRow
             :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#801]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#847]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- *(5) Filter isnotnull(c_customer_sk#154)
!                  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- *(5) ColumnarToRow
                      +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                                        +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@2e7a6dcd
!+- Sort [cnt#1828L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- *(7) Sort [cnt#1828L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Exchange rangepartitioning(cnt#1828L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#852]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1828L]
!         :- Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :- *(6) Filter ((cnt#1828L >= 1) AND (cnt#1828L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1828L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#839]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1843L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :     :     :  +- *(4) ColumnarToRow
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                         :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#815]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :        +- *(1) Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                             :                 :     :              +- *(1) ColumnarToRow
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                       :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#824]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                      :                 :        +- *(2) Project [s_store_sk#666]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- *(2) ColumnarToRow
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#833]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                    +- *(3) Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                          +- *(3) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#847]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(5) Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- *(5) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
          
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 4
Total time: 0.002285499 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 4
Total time: 0.002285499 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 4
Total time: 0.002285499 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.002E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.028E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 7
Total time: 0.002301783 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 3
Total time: 1.5108E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.492E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.1474E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 3
Total time: 2.2792E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.766E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.0412E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.225E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.961E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.034E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 22.761824 ms
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 21.932742 ms
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 25.239414 ms
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_96 stored as values in memory (estimated size 293.1 KiB, free 366.0 MiB)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_97 stored as values in memory (estimated size 292.8 KiB, free 365.7 MiB)
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 8.075E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.593E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 43.335879 ms
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_96_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 365.7 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_96_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 366.3 MiB)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_98 stored as values in memory (estimated size 293.7 KiB, free 365.4 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 96 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_97_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 365.4 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_97_piece0 in memory on szcdoc01:37657 (size: 24.9 KiB, free: 366.3 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 97 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 40.309841 ms
22/07/26 14:21:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 6037354 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4203787 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_98_piece0 stored as bytes in memory (estimated size 25.1 KiB, free 365.4 MiB)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_99 stored as values in memory (estimated size 293.4 KiB, free 365.1 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_98_piece0 in memory on szcdoc01:37657 (size: 25.1 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 98 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 9766600 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:19 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_99_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 365.1 MiB)
22/07/26 14:21:19 INFO DAGScheduler: Got job 48 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_99_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO DAGScheduler: Final stage: ResultStage 72 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:19 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:19 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:19 INFO SparkContext: Created broadcast 99 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO DAGScheduler: Submitting ResultStage 72 (MapPartitionsRDD[223] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4225251 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_100 stored as values in memory (estimated size 14.3 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_100_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_100_piece0 in memory on szcdoc01:37657 (size: 6.0 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 100 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 72 (MapPartitionsRDD[223] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:19 INFO TaskSchedulerImpl: Adding task set 72.0 with 1 tasks resource profile 0
22/07/26 14:21:19 INFO DAGScheduler: Got job 49 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:19 INFO DAGScheduler: Final stage: ResultStage 73 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:19 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:19 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:19 INFO TaskSetManager: Starting task 0.0 in stage 72.0 (TID 72) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4949 bytes) taskResourceAssignments Map()
22/07/26 14:21:19 INFO DAGScheduler: Submitting ResultStage 73 (MapPartitionsRDD[221] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:19 INFO Executor: Running task 0.0 in stage 72.0 (TID 72)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_101 stored as values in memory (estimated size 14.7 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_101_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_101_piece0 in memory on szcdoc01:37657 (size: 6.1 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 101 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 73 (MapPartitionsRDD[221] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:19 INFO TaskSchedulerImpl: Adding task set 73.0 with 1 tasks resource profile 0
22/07/26 14:21:19 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store/part-00000-995b273e-5695-4f66-bbbf-e1737ae46f7e-c000.snappy.parquet, range: 0-9483, partition values: [empty row]
22/07/26 14:21:19 INFO DAGScheduler: Got job 50 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:19 INFO DAGScheduler: Final stage: ResultStage 74 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:19 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:19 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:19 INFO DAGScheduler: Submitting ResultStage 74 (MapPartitionsRDD[227] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_102 stored as values in memory (estimated size 14.5 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_102_piece0 stored as bytes in memory (estimated size 5.8 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_102_piece0 in memory on szcdoc01:37657 (size: 5.8 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 102 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 74 (MapPartitionsRDD[227] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:19 INFO TaskSchedulerImpl: Adding task set 74.0 with 1 tasks resource profile 0
22/07/26 14:21:19 INFO DAGScheduler: Got job 51 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:19 INFO DAGScheduler: Final stage: ResultStage 75 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:19 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:19 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:19 INFO DAGScheduler: Submitting ResultStage 75 (MapPartitionsRDD[231] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_103 stored as values in memory (estimated size 16.3 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_103_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 365.0 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_103_piece0 in memory on szcdoc01:37657 (size: 6.8 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 103 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 75 (MapPartitionsRDD[231] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:19 INFO TaskSchedulerImpl: Adding task set 75.0 with 1 tasks resource profile 0
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:19 INFO CodecPool: Got brand-new decompressor [.snappy]
22/07/26 14:21:19 INFO Executor: Finished task 0.0 in stage 72.0 (TID 72). 1872 bytes result sent to driver
22/07/26 14:21:19 INFO TaskSetManager: Starting task 0.0 in stage 73.0 (TID 73) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:19 INFO Executor: Running task 0.0 in stage 73.0 (TID 73)
22/07/26 14:21:19 INFO TaskSetManager: Finished task 0.0 in stage 72.0 (TID 72) in 231 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:19 INFO TaskSchedulerImpl: Removed TaskSet 72.0, whose tasks have all completed, from pool 
22/07/26 14:21:19 INFO DAGScheduler: ResultStage 72 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.237 s
22/07/26 14:21:19 INFO DAGScheduler: Job 48 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 72: Stage finished
22/07/26 14:21:19 INFO DAGScheduler: Job 48 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.238618 s
22/07/26 14:21:19 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim/part-00000-a413da45-d7c8-4f70-a93b-7e518b0efa89-c000.snappy.parquet, range: 0-1843050, partition values: [empty row]
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.8378E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 10.136636 ms
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_104 stored as values in memory (estimated size 1024.1 KiB, free 364.0 MiB)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_104_piece0 stored as bytes in memory (estimated size 325.0 B, free 364.0 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_104_piece0 in memory on szcdoc01:37657 (size: 325.0 B, free: 366.2 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 104 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO Executor: Finished task 0.0 in stage 73.0 (TID 73). 2124 bytes result sent to driver
22/07/26 14:21:19 INFO TaskSetManager: Starting task 0.0 in stage 74.0 (TID 74) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:19 INFO Executor: Running task 0.0 in stage 74.0 (TID 74)
22/07/26 14:21:19 INFO TaskSetManager: Finished task 0.0 in stage 73.0 (TID 73) in 44 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:19 INFO TaskSchedulerImpl: Removed TaskSet 73.0, whose tasks have all completed, from pool 
22/07/26 14:21:19 INFO DAGScheduler: ResultStage 73 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.275 s
22/07/26 14:21:19 INFO DAGScheduler: Job 49 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 73: Stage finished
22/07/26 14:21:19 INFO DAGScheduler: Job 49 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.277886 s
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.9915E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer/part-00000-16283de9-1d2e-49c8-993a-bc0ba4e0a35b-c000.snappy.parquet, range: 0-5572296, partition values: [empty row]
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_105 stored as values in memory (estimated size 1028.0 KiB, free 363.0 MiB)
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_105_piece0 stored as bytes in memory (estimated size 1446.0 B, free 363.0 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_105_piece0 in memory on szcdoc01:37657 (size: 1446.0 B, free: 366.2 MiB)
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 105 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:19 INFO MemoryStore: Block taskresult_74 stored as bytes in memory (estimated size 2.8 MiB, free 360.2 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Removed broadcast_100_piece0 on szcdoc01:37657 in memory (size: 6.0 KiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Added taskresult_74 in memory on szcdoc01:37657 (size: 2.8 MiB, free: 363.4 MiB)
22/07/26 14:21:19 INFO BlockManagerInfo: Removed broadcast_101_piece0 on szcdoc01:37657 in memory (size: 6.1 KiB, free: 363.4 MiB)
22/07/26 14:21:19 INFO Executor: Finished task 0.0 in stage 74.0 (TID 74). 2942684 bytes result sent via BlockManager)
22/07/26 14:21:19 INFO TaskSetManager: Starting task 0.0 in stage 75.0 (TID 75) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4966 bytes) taskResourceAssignments Map()
22/07/26 14:21:19 INFO Executor: Running task 0.0 in stage 75.0 (TID 75)
22/07/26 14:21:19 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics/part-00000-329cd03e-c442-4b83-aa62-907c29e73e1c-c000.snappy.parquet, range: 0-30947, partition values: [empty row]
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:19 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:19 INFO Executor: Finished task 0.0 in stage 75.0 (TID 75). 1705 bytes result sent to driver
22/07/26 14:21:19 INFO TaskSetManager: Finished task 0.0 in stage 75.0 (TID 75) in 15 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:19 INFO TaskSchedulerImpl: Removed TaskSet 75.0, whose tasks have all completed, from pool 
22/07/26 14:21:19 INFO DAGScheduler: ResultStage 75 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.422 s
22/07/26 14:21:19 INFO DAGScheduler: Job 51 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 75: Stage finished
22/07/26 14:21:19 INFO DAGScheduler: Job 51 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.424358 s
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_106 stored as values in memory (estimated size 24.0 B, free 360.2 MiB)
22/07/26 14:21:19 INFO MemoryStore: Block broadcast_106_piece0 stored as bytes in memory (estimated size 120.0 B, free 360.2 MiB)
22/07/26 14:21:19 INFO TransportClientFactory: Successfully created connection to szcdoc01/172.16.0.12:37657 after 3 ms (0 ms spent in bootstraps)
22/07/26 14:21:19 INFO BlockManagerInfo: Added broadcast_106_piece0 in memory on szcdoc01:37657 (size: 120.0 B, free: 363.4 MiB)
22/07/26 14:21:19 INFO SparkContext: Created broadcast 106 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:19 INFO TaskSetManager: Finished task 0.0 in stage 74.0 (TID 74) in 213 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:19 INFO TaskSchedulerImpl: Removed TaskSet 74.0, whose tasks have all completed, from pool 
22/07/26 14:21:19 INFO DAGScheduler: ResultStage 74 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.479 s
22/07/26 14:21:19 INFO BlockManagerInfo: Removed taskresult_74 on szcdoc01:37657 in memory (size: 2.8 MiB, free: 366.2 MiB)
22/07/26 14:21:19 INFO DAGScheduler: Job 50 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 74: Stage finished
22/07/26 14:21:19 INFO DAGScheduler: Job 50 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.485850 s
22/07/26 14:21:19 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:19 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.5797E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:19 INFO CodeGenerator: Code generated in 8.201916 ms
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_107 stored as values in memory (estimated size 16.8 MiB, free 346.2 MiB)
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_107_piece0 stored as bytes in memory (estimated size 3.4 MiB, free 342.9 MiB)
22/07/26 14:21:20 INFO BlockManagerInfo: Added broadcast_107_piece0 in memory on szcdoc01:37657 (size: 3.4 MiB, free: 362.8 MiB)
22/07/26 14:21:20 INFO SparkContext: Created broadcast 107 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 31.256944 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.238E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.69E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.42E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.632E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 40.461875 ms
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_108 stored as values in memory (estimated size 293.7 KiB, free 342.6 MiB)
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_108_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 342.6 MiB)
22/07/26 14:21:20 INFO BlockManagerInfo: Added broadcast_108_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 362.8 MiB)
22/07/26 14:21:20 INFO SparkContext: Created broadcast 108 from $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:20 INFO FileSourceScanExec: Planning scan with bin packing, max size: 124086532 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.5373E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 12.659168 ms
22/07/26 14:21:20 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:20 INFO DAGScheduler: Registering RDD 235 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 24
22/07/26 14:21:20 INFO DAGScheduler: Got job 52 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 4 output partitions
22/07/26 14:21:20 INFO DAGScheduler: Final stage: ResultStage 77 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 76)
22/07/26 14:21:20 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 76)
22/07/26 14:21:20 INFO DAGScheduler: Submitting ShuffleMapStage 76 (MapPartitionsRDD[235] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_109 stored as values in memory (estimated size 45.9 KiB, free 342.5 MiB)
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_109_piece0 stored as bytes in memory (estimated size 19.6 KiB, free 342.5 MiB)
22/07/26 14:21:20 INFO BlockManagerInfo: Added broadcast_109_piece0 in memory on szcdoc01:37657 (size: 19.6 KiB, free: 362.8 MiB)
22/07/26 14:21:20 INFO SparkContext: Created broadcast 109 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:20 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 76 (MapPartitionsRDD[235] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:20 INFO TaskSchedulerImpl: Adding task set 76.0 with 1 tasks resource profile 0
22/07/26 14:21:20 INFO TaskSetManager: Starting task 0.0 in stage 76.0 (TID 76) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 0.0 in stage 76.0 (TID 76)
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.1857E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 11.784319 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.0689E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 5.459318 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.178E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 6.25423 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 9.623E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 9.306E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.044E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 7.032569 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.3471E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales/part-00000-83a64231-9071-4db5-b73a-3b9af3882d7f-c000.snappy.parquet, range: 0-119892228, partition values: [empty row]
22/07/26 14:21:20 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:20 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:20 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:20 INFO Executor: Finished task 0.0 in stage 76.0 (TID 76). 5409 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Finished task 0.0 in stage 76.0 (TID 76) in 456 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:20 INFO TaskSchedulerImpl: Removed TaskSet 76.0, whose tasks have all completed, from pool 
22/07/26 14:21:20 INFO DAGScheduler: ShuffleMapStage 76 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.462 s
22/07/26 14:21:20 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:20 INFO DAGScheduler: running: Set()
22/07/26 14:21:20 INFO DAGScheduler: waiting: Set(ResultStage 77)
22/07/26 14:21:20 INFO DAGScheduler: failed: Set()
22/07/26 14:21:20 INFO DAGScheduler: Submitting ResultStage 77 (MapPartitionsRDD[240] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_110 stored as values in memory (estimated size 47.7 KiB, free 342.5 MiB)
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_110_piece0 stored as bytes in memory (estimated size 21.5 KiB, free 342.4 MiB)
22/07/26 14:21:20 INFO BlockManagerInfo: Added broadcast_110_piece0 in memory on szcdoc01:37657 (size: 21.5 KiB, free: 362.8 MiB)
22/07/26 14:21:20 INFO SparkContext: Created broadcast 110 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:20 INFO DAGScheduler: Submitting 4 missing tasks from ResultStage 77 (MapPartitionsRDD[240] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:20 INFO TaskSchedulerImpl: Adding task set 77.0 with 4 tasks resource profile 0
22/07/26 14:21:20 INFO TaskSetManager: Starting task 0.0 in stage 77.0 (TID 77) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 0.0 in stage 77.0 (TID 77)
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.174E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 6.716071 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.1406E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.625E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.02E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.707E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 0.0 in stage 77.0 (TID 77). 7730 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Starting task 1.0 in stage 77.0 (TID 78) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 1.0 in stage 77.0 (TID 78)
22/07/26 14:21:20 INFO TaskSetManager: Finished task 0.0 in stage 77.0 (TID 77) in 34 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.312E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.14E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.529E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.844E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.632E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 1.0 in stage 77.0 (TID 78). 7730 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Starting task 2.0 in stage 77.0 (TID 79) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 2.0 in stage 77.0 (TID 79)
22/07/26 14:21:20 INFO TaskSetManager: Finished task 1.0 in stage 77.0 (TID 78) in 9 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.542E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.29E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.268E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.638E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.355E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 2.0 in stage 77.0 (TID 79). 7730 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Starting task 3.0 in stage 77.0 (TID 80) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 3.0 in stage 77.0 (TID 80)
22/07/26 14:21:20 INFO TaskSetManager: Finished task 2.0 in stage 77.0 (TID 79) in 9 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.793E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.527E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.278E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.523E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.422E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 3.0 in stage 77.0 (TID 80). 7730 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Finished task 3.0 in stage 77.0 (TID 80) in 8 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:20 INFO TaskSchedulerImpl: Removed TaskSet 77.0, whose tasks have all completed, from pool 
22/07/26 14:21:20 INFO DAGScheduler: ResultStage 77 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.065 s
22/07/26 14:21:20 INFO DAGScheduler: Job 52 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:20 INFO TaskSchedulerImpl: Killing all running tasks in stage 77: Stage finished
22/07/26 14:21:20 INFO DAGScheduler: Job 52 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.531529 s
22/07/26 14:21:20 INFO OverwriteByExpressionExec: Start processing data source write support: org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1. The input RDD has 1 partitions.
22/07/26 14:21:20 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:20 INFO DAGScheduler: Registering RDD 241 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 25
22/07/26 14:21:20 INFO DAGScheduler: Got job 53 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 1 output partitions
22/07/26 14:21:20 INFO DAGScheduler: Final stage: ResultStage 80 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 79)
22/07/26 14:21:20 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 79)
22/07/26 14:21:20 INFO DAGScheduler: Submitting ShuffleMapStage 79 (MapPartitionsRDD[241] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_111 stored as values in memory (estimated size 47.4 KiB, free 342.4 MiB)
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_111_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 342.4 MiB)
22/07/26 14:21:20 INFO BlockManagerInfo: Added broadcast_111_piece0 in memory on szcdoc01:37657 (size: 21.4 KiB, free: 362.7 MiB)
22/07/26 14:21:20 INFO SparkContext: Created broadcast 111 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:20 INFO DAGScheduler: Submitting 4 missing tasks from ShuffleMapStage 79 (MapPartitionsRDD[241] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:20 INFO TaskSchedulerImpl: Adding task set 79.0 with 4 tasks resource profile 0
22/07/26 14:21:20 INFO TaskSetManager: Starting task 0.0 in stage 79.0 (TID 81) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 0.0 in stage 79.0 (TID 81)
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.4928E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.039E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.024E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.448E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.654E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.668E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 0.0 in stage 79.0 (TID 81). 7773 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Starting task 1.0 in stage 79.0 (TID 82) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO TaskSetManager: Finished task 0.0 in stage 79.0 (TID 81) in 15 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:20 INFO Executor: Running task 1.0 in stage 79.0 (TID 82)
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.1664E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.662E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.089E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.949E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.642E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.917E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 1.0 in stage 79.0 (TID 82). 7773 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Starting task 2.0 in stage 79.0 (TID 83) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 2.0 in stage 79.0 (TID 83)
22/07/26 14:21:20 INFO TaskSetManager: Finished task 1.0 in stage 79.0 (TID 82) in 10 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.7375E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.324E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.474E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.171E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.976E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.034E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 2.0 in stage 79.0 (TID 83). 7773 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Starting task 3.0 in stage 79.0 (TID 84) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO TaskSetManager: Finished task 2.0 in stage 79.0 (TID 83) in 11 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:20 INFO Executor: Running task 3.0 in stage 79.0 (TID 84)
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.0809E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.821E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.36E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.097E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.274E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.431E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO Executor: Finished task 3.0 in stage 79.0 (TID 84). 7773 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Finished task 3.0 in stage 79.0 (TID 84) in 11 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:20 INFO TaskSchedulerImpl: Removed TaskSet 79.0, whose tasks have all completed, from pool 
22/07/26 14:21:20 INFO DAGScheduler: ShuffleMapStage 79 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.053 s
22/07/26 14:21:20 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:20 INFO DAGScheduler: running: Set()
22/07/26 14:21:20 INFO DAGScheduler: waiting: Set(ResultStage 80)
22/07/26 14:21:20 INFO DAGScheduler: failed: Set()
22/07/26 14:21:20 INFO DAGScheduler: Submitting ResultStage 80 (MapPartitionsRDD[243] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_112 stored as values in memory (estimated size 41.6 KiB, free 342.3 MiB)
22/07/26 14:21:20 INFO MemoryStore: Block broadcast_112_piece0 stored as bytes in memory (estimated size 19.3 KiB, free 342.3 MiB)
22/07/26 14:21:20 INFO BlockManagerInfo: Added broadcast_112_piece0 in memory on szcdoc01:37657 (size: 19.3 KiB, free: 362.7 MiB)
22/07/26 14:21:20 INFO SparkContext: Created broadcast 112 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:20 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 80 (MapPartitionsRDD[243] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:20 INFO TaskSchedulerImpl: Adding task set 80.0 with 1 tasks resource profile 0
22/07/26 14:21:20 INFO TaskSetManager: Starting task 0.0 in stage 80.0 (TID 85) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:20 INFO Executor: Running task 0.0 in stage 80.0 (TID 85)
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:20 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.0803E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 6.172364 ms
22/07/26 14:21:20 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.4972E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:20 INFO CodeGenerator: Code generated in 5.952553 ms
22/07/26 14:21:20 INFO DataWritingSparkTask: Writer for partition 0 is committing.
22/07/26 14:21:20 INFO DataWritingSparkTask: Committed partition 0 (task 85, attempt 0, stage 80.0)
22/07/26 14:21:20 INFO Executor: Finished task 0.0 in stage 80.0 (TID 85). 8551 bytes result sent to driver
22/07/26 14:21:20 INFO TaskSetManager: Finished task 0.0 in stage 80.0 (TID 85) in 52 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:20 INFO TaskSchedulerImpl: Removed TaskSet 80.0, whose tasks have all completed, from pool 
22/07/26 14:21:20 INFO DAGScheduler: ResultStage 80 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.058 s
22/07/26 14:21:20 INFO DAGScheduler: Job 53 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:20 INFO TaskSchedulerImpl: Killing all running tasks in stage 80: Stage finished
22/07/26 14:21:20 INFO DAGScheduler: Job 53 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.113824 s
22/07/26 14:21:20 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 is committing.
22/07/26 14:21:20 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 committed.
22/07/26 14:21:20 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1844]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1844]
          :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1844]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1844]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                                                                                                                                                     :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                                                                                                                                                       :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1844]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$Division ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$CaseWhenCoercion ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:20 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= 1) AND (cnt#1844L <= 5)))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= 1) AND (cnt#1844L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= 1) AND (cnt#1844L <= 5)))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= 1) AND (cnt#1844L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Sort [cnt#1844L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1844L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Sort [cnt#1844L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1844]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1844L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1844L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 339
Total time: 0.036739663 seconds
Total number of effective runs: 13
Total time of effective runs: 0.014267477 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001311275 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
          
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ReorderJoin ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
             :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                        :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                     :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                          :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :- Filter ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint)))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!            :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                      :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))                                                                                                                                                                                                                                                                                                                                                                         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                           :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!         :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                           :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                  :           :     :     +- Project [d_date_sk#329]
!         :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!         +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.NullPropagation ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
          :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ConstantFolding ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))                                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_102_piece0 on szcdoc01:37657 in memory (size: 5.8 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_112_piece0 on szcdoc01:37657 in memory (size: 19.3 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_109_piece0 on szcdoc01:37657 in memory (size: 19.6 KiB, free: 362.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_110_piece0 on szcdoc01:37657 in memory (size: 21.5 KiB, free: 362.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_111_piece0 on szcdoc01:37657 in memory (size: 21.4 KiB, free: 362.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_103_piece0 on szcdoc01:37657 in memory (size: 6.8 KiB, free: 362.8 MiB)
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1844L >= cast(1 as bigint)) AND (cnt#1844L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                       :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.InferFiltersFromConstraints ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Infer Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter (((cnt#1844L >= 1) AND (cnt#1844L <= 5)) AND isnotnull(ss_customer_sk#1157))
!         :  +- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Project [d_date_sk#329]
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     +- Project [s_store_sk#666]
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter (((cnt#1844L >= 1) AND (cnt#1844L <= 5)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
          :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Project [d_date_sk#329]
          :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
          :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [hd_demo_sk#446]
          :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                             +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                             :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     +- Project [s_store_sk#666]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           +- Project [hd_demo_sk#446]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                +- Filter isnotnull(c_customer_sk#154)
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                 
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization after Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!         :  +- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    +- Filter isnotnull(c_customer_sk#154)
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
          
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.RewritePredicateSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch RewriteSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1844L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1844L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1844L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 309
Total time: 0.078532167 seconds
Total number of effective runs: 11
Total time of effective runs: 0.007915223 seconds
      
22/07/26 14:21:21 INFO FileSourceStrategy: Pushed Filters: IsNotNull(ss_sold_date_sk),IsNotNull(ss_store_sk),IsNotNull(ss_hdemo_sk),IsNotNull(ss_customer_sk)
22/07/26 14:21:21 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(ss_sold_date_sk#1154),isnotnull(ss_store_sk#1161),isnotnull(ss_hdemo_sk#1159),isnotnull(ss_customer_sk#1157)
22/07/26 14:21:21 INFO FileSourceStrategy: Output Data Schema: struct<ss_sold_date_sk: int, ss_customer_sk: int, ss_hdemo_sk: int, ss_store_sk: int, ss_ticket_number: int ... 3 more fields>
22/07/26 14:21:21 INFO FileSourceStrategy: Pushed Filters: IsNotNull(d_dom),GreaterThanOrEqual(d_dom,1),LessThanOrEqual(d_dom,2),In(d_year, [1999,2000,2001]),IsNotNull(d_date_sk)
22/07/26 14:21:21 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(d_dom#338),(d_dom#338 >= 1),(d_dom#338 <= 2),d_year#335 IN (1999,2000,2001),isnotnull(d_date_sk#329)
22/07/26 14:21:21 INFO FileSourceStrategy: Output Data Schema: struct<d_date_sk: int, d_year: int, d_dom: int ... 1 more fields>
22/07/26 14:21:21 INFO FileSourceStrategy: Pushed Filters: In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]),IsNotNull(s_store_sk)
22/07/26 14:21:21 INFO FileSourceStrategy: Post-Scan Filters: s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County),isnotnull(s_store_sk#666)
22/07/26 14:21:21 INFO FileSourceStrategy: Output Data Schema: struct<s_store_sk: int, s_county: string>
22/07/26 14:21:21 INFO FileSourceStrategy: Pushed Filters: IsNotNull(hd_vehicle_count),Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknown)),GreaterThan(hd_vehicle_count,0),IsNotNull(hd_demo_sk)
22/07/26 14:21:21 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(hd_vehicle_count#450),((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)),(hd_vehicle_count#450 > 0),(CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0),isnotnull(hd_demo_sk#446)
22/07/26 14:21:21 INFO FileSourceStrategy: Output Data Schema: struct<hd_demo_sk: int, hd_buy_potential: string, hd_dep_count: int, hd_vehicle_count: int ... 2 more fields>
22/07/26 14:21:21 INFO FileSourceStrategy: Pushed Filters: IsNotNull(c_customer_sk)
22/07/26 14:21:21 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(c_customer_sk#154)
22/07/26 14:21:21 INFO FileSourceStrategy: Output Data Schema: struct<c_customer_sk: int, c_salutation: string, c_first_name: string, c_last_name: string, c_preferred_cust_flag: string ... 3 more fields>
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.RemoveRedundantProjects ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289
 +- Sort [cnt#1844L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1844L DESC NULLS LAST], true, 0
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
       +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
          :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
          :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])
          :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])
          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
          :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
          :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>            :              :     :     +- Project [d_date_sk#329]
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :              :     +- Project [s_store_sk#666]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :              +- Project [hd_demo_sk#446]
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   +- Filter isnotnull(c_customer_sk#154)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                   
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289                                                                                                                                                                                                                                                                                                                                                                                                                                                         OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289
 +- Sort [cnt#1844L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Sort [cnt#1844L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Exchange rangepartitioning(cnt#1844L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#981]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
!         :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#973]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#960]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :        +- Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#964]
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                 :        +- Project [s_store_sk#666]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#968]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                    +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#977]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289
 +- Sort [cnt#1844L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Sort [cnt#1844L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1844L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#981]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Exchange rangepartitioning(cnt#1844L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1013]
       +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
          +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
             :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
             :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#973]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1005]
             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])
             :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
             :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
             :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
             :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
             :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
             :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :  +- ColumnarToRow
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#960]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#989]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :        +- Project [d_date_sk#329]
!            :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#964]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :              +- ColumnarToRow
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#995]
!            :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :        +- Project [s_store_sk#666]
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#968]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :              +- ColumnarToRow
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                 :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1001]
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#977]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                    +- Project [hd_demo_sk#446]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                  +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                          +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1010]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289
!+- Sort [cnt#1844L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- *(7) Sort [cnt#1844L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1844L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1013]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- Exchange rangepartitioning(cnt#1844L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1061]
!      +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
!         +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!            :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- *(6) Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!            :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1005]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1048]
!            :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])
!            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!            :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :  +- *(4) ColumnarToRow
             :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#989]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1024]
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :        +- *(1) Project [d_date_sk#329]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :              +- *(1) ColumnarToRow
             :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#995]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1033]
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :        +- *(2) Project [s_store_sk#666]
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                 :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :              +- *(2) ColumnarToRow
             :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1001]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1042]
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                    +- *(3) Project [hd_demo_sk#446]
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!            :                          +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                          +- *(3) ColumnarToRow
             :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1010]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1056]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- *(5) Filter isnotnull(c_customer_sk#154)
!                  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- *(5) ColumnarToRow
                      +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                                        +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@307cf289
!+- Sort [cnt#1844L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- *(7) Sort [cnt#1844L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Exchange rangepartitioning(cnt#1844L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1061]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1844L]
!         :- Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :- *(6) Filter ((cnt#1844L >= 1) AND (cnt#1844L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1844L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1048]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1859L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :     :     :  +- *(4) ColumnarToRow
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                         :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1024]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :        +- *(1) Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                             :                 :     :              +- *(1) ColumnarToRow
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                       :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1033]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                      :                 :        +- *(2) Project [s_store_sk#666]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- *(2) ColumnarToRow
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1042]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                    +- *(3) Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                          +- *(3) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1056]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(5) Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- *(5) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
          
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.722E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.789E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.487E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.214E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.602E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 2
Total time: 3.3662E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.76E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.797E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.275E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 3
Total time: 6.3684E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.17E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.929E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.482E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.7852E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.695E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.721E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.284E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_113 stored as values in memory (estimated size 293.7 KiB, free 342.3 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_114 stored as values in memory (estimated size 293.1 KiB, free 342.0 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_115 stored as values in memory (estimated size 292.8 KiB, free 341.8 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_116 stored as values in memory (estimated size 293.4 KiB, free 341.5 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_115_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 341.4 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_114_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 341.4 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_113_piece0 stored as bytes in memory (estimated size 25.1 KiB, free 341.4 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_115_piece0 in memory on szcdoc01:37657 (size: 24.9 KiB, free: 362.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_114_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 362.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_113_piece0 in memory on szcdoc01:37657 (size: 25.1 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 114 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO SparkContext: Created broadcast 113 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO SparkContext: Created broadcast 115 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_116_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 341.4 MiB)
22/07/26 14:21:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 6037354 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4203787 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 9766600 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_116_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 116 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4225251 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:21 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO DAGScheduler: Got job 54 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:21 INFO DAGScheduler: Final stage: ResultStage 81 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:21 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:21 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:21 INFO DAGScheduler: Submitting ResultStage 81 (MapPartitionsRDD[258] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_117 stored as values in memory (estimated size 14.5 KiB, free 341.4 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_117_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 341.4 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_117_piece0 in memory on szcdoc01:37657 (size: 5.9 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 117 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 81 (MapPartitionsRDD[258] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 81.0 with 1 tasks resource profile 0
22/07/26 14:21:21 INFO DAGScheduler: Got job 55 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:21 INFO DAGScheduler: Final stage: ResultStage 82 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:21 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 81.0 (TID 86) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:21 INFO DAGScheduler: Submitting ResultStage 82 (MapPartitionsRDD[259] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 81.0 (TID 86)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_118 stored as values in memory (estimated size 14.7 KiB, free 341.3 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_118_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 341.3 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_118_piece0 in memory on szcdoc01:37657 (size: 6.1 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer/part-00000-16283de9-1d2e-49c8-993a-bc0ba4e0a35b-c000.snappy.parquet, range: 0-5572296, partition values: [empty row]
22/07/26 14:21:21 INFO SparkContext: Created broadcast 118 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 82 (MapPartitionsRDD[259] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 82.0 with 1 tasks resource profile 0
22/07/26 14:21:21 INFO DAGScheduler: Got job 56 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:21 INFO DAGScheduler: Final stage: ResultStage 83 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:21 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:21 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:21 INFO DAGScheduler: Submitting ResultStage 83 (MapPartitionsRDD[261] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_119 stored as values in memory (estimated size 14.3 KiB, free 341.3 MiB)
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_119_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 341.3 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_119_piece0 in memory on szcdoc01:37657 (size: 6.0 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 119 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 83 (MapPartitionsRDD[261] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 83.0 with 1 tasks resource profile 0
22/07/26 14:21:21 INFO DAGScheduler: Got job 57 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:21 INFO DAGScheduler: Final stage: ResultStage 84 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:21 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:21 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:21 INFO DAGScheduler: Submitting ResultStage 84 (MapPartitionsRDD[253] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_120 stored as values in memory (estimated size 16.3 KiB, free 341.3 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_120_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 341.3 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_120_piece0 in memory on szcdoc01:37657 (size: 6.8 KiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 120 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 84 (MapPartitionsRDD[253] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 84.0 with 1 tasks resource profile 0
22/07/26 14:21:21 INFO MemoryStore: Block taskresult_86 stored as bytes in memory (estimated size 2.8 MiB, free 338.5 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added taskresult_86 in memory on szcdoc01:37657 (size: 2.8 MiB, free: 359.9 MiB)
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 81.0 (TID 86). 2942684 bytes result sent via BlockManager)
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 82.0 (TID 87) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 82.0 (TID 87)
22/07/26 14:21:21 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim/part-00000-a413da45-d7c8-4f70-a93b-7e518b0efa89-c000.snappy.parquet, range: 0-1843050, partition values: [empty row]
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 81.0 (TID 86) in 102 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 81.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO BlockManagerInfo: Removed taskresult_86 on szcdoc01:37657 in memory (size: 2.8 MiB, free: 362.7 MiB)
22/07/26 14:21:21 INFO DAGScheduler: ResultStage 81 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.107 s
22/07/26 14:21:21 INFO DAGScheduler: Job 54 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 81: Stage finished
22/07/26 14:21:21 INFO DAGScheduler: Job 54 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.108621 s
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.3264E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 82.0 (TID 87). 2124 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 83.0 (TID 88) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4949 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 83.0 (TID 88)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 82.0 (TID 87) in 20 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 82.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ResultStage 82 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.110 s
22/07/26 14:21:21 INFO DAGScheduler: Job 55 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 82: Stage finished
22/07/26 14:21:21 INFO DAGScheduler: Job 55 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.116382 s
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.659E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store/part-00000-995b273e-5695-4f66-bbbf-e1737ae46f7e-c000.snappy.parquet, range: 0-9483, partition values: [empty row]
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_121 stored as values in memory (estimated size 1028.0 KiB, free 340.3 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_121_piece0 stored as bytes in memory (estimated size 1446.0 B, free 340.3 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_121_piece0 in memory on szcdoc01:37657 (size: 1446.0 B, free: 362.7 MiB)
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:21 INFO SparkContext: Created broadcast 121 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 83.0 (TID 88). 1872 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 84.0 (TID 89) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4966 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 84.0 (TID 89)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 83.0 (TID 88) in 15 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 83.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ResultStage 83 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.120 s
22/07/26 14:21:21 INFO DAGScheduler: Job 56 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 83: Stage finished
22/07/26 14:21:21 INFO DAGScheduler: Job 56 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.131120 s
22/07/26 14:21:21 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics/part-00000-329cd03e-c442-4b83-aa62-907c29e73e1c-c000.snappy.parquet, range: 0-30947, partition values: [empty row]
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.977E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_122 stored as values in memory (estimated size 1024.1 KiB, free 339.3 MiB)
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_122_piece0 stored as bytes in memory (estimated size 325.0 B, free 339.3 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_122_piece0 in memory on szcdoc01:37657 (size: 325.0 B, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 122 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 84.0 (TID 89). 1705 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 84.0 (TID 89) in 11 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 84.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ResultStage 84 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.127 s
22/07/26 14:21:21 INFO DAGScheduler: Job 57 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 84: Stage finished
22/07/26 14:21:21 INFO DAGScheduler: Job 57 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.141494 s
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_123 stored as values in memory (estimated size 24.0 B, free 339.3 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_123_piece0 stored as bytes in memory (estimated size 120.0 B, free 339.3 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_123_piece0 in memory on szcdoc01:37657 (size: 120.0 B, free: 362.7 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 123 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_124 stored as values in memory (estimated size 16.8 MiB, free 322.5 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_124_piece0 stored as bytes in memory (estimated size 3.4 MiB, free 319.2 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_124_piece0 in memory on szcdoc01:37657 (size: 3.4 MiB, free: 359.3 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 124 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 8.303E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.927E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.263E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.2E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_125 stored as values in memory (estimated size 293.7 KiB, free 318.9 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_125_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 318.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_125_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 359.3 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 125 from $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 124086532 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.5332E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:21 INFO DAGScheduler: Registering RDD 265 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 26
22/07/26 14:21:21 INFO DAGScheduler: Got job 58 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 4 output partitions
22/07/26 14:21:21 INFO DAGScheduler: Final stage: ResultStage 86 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 85)
22/07/26 14:21:21 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 85)
22/07/26 14:21:21 INFO DAGScheduler: Submitting ShuffleMapStage 85 (MapPartitionsRDD[265] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_126 stored as values in memory (estimated size 45.9 KiB, free 318.8 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_126_piece0 stored as bytes in memory (estimated size 19.5 KiB, free 318.8 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_126_piece0 in memory on szcdoc01:37657 (size: 19.5 KiB, free: 359.3 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 126 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 85 (MapPartitionsRDD[265] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 85.0 with 1 tasks resource profile 0
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 85.0 (TID 90) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 85.0 (TID 90)
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.9661E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.422E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.999E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.703E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.833E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.536E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.084E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales/part-00000-83a64231-9071-4db5-b73a-3b9af3882d7f-c000.snappy.parquet, range: 0-119892228, partition values: [empty row]
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:21 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:21 INFO BlockManagerInfo: Removed broadcast_117_piece0 on szcdoc01:37657 in memory (size: 5.9 KiB, free: 359.3 MiB)
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 85.0 (TID 90). 5452 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 85.0 (TID 90) in 252 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 85.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ShuffleMapStage 85 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.259 s
22/07/26 14:21:21 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:21 INFO DAGScheduler: running: Set()
22/07/26 14:21:21 INFO DAGScheduler: waiting: Set(ResultStage 86)
22/07/26 14:21:21 INFO DAGScheduler: failed: Set()
22/07/26 14:21:21 INFO DAGScheduler: Submitting ResultStage 86 (MapPartitionsRDD[270] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_127 stored as values in memory (estimated size 47.7 KiB, free 318.8 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_127_piece0 stored as bytes in memory (estimated size 21.5 KiB, free 318.7 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_127_piece0 in memory on szcdoc01:37657 (size: 21.5 KiB, free: 359.3 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 127 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 4 missing tasks from ResultStage 86 (MapPartitionsRDD[270] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 86.0 with 4 tasks resource profile 0
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 86.0 (TID 91) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 86.0 (TID 91)
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.315E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.699E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.084E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.906E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.384E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 86.0 (TID 91). 7730 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 1.0 in stage 86.0 (TID 92) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 1.0 in stage 86.0 (TID 92)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 86.0 (TID 91) in 9 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.431E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.213E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.271E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.961E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.996E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 1.0 in stage 86.0 (TID 92). 7730 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 2.0 in stage 86.0 (TID 93) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 2.0 in stage 86.0 (TID 93)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 1.0 in stage 86.0 (TID 92) in 8 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.794E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.911E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.928E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.479E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.124E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 2.0 in stage 86.0 (TID 93). 7730 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 3.0 in stage 86.0 (TID 94) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO TaskSetManager: Finished task 2.0 in stage 86.0 (TID 93) in 8 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:21 INFO Executor: Running task 3.0 in stage 86.0 (TID 94)
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.813E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.876E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.394E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.997E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.89E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 3.0 in stage 86.0 (TID 94). 7730 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Finished task 3.0 in stage 86.0 (TID 94) in 8 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 86.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ResultStage 86 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.037 s
22/07/26 14:21:21 INFO DAGScheduler: Job 58 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 86: Stage finished
22/07/26 14:21:21 INFO DAGScheduler: Job 58 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.299747 s
22/07/26 14:21:21 INFO OverwriteByExpressionExec: Start processing data source write support: org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1. The input RDD has 1 partitions.
22/07/26 14:21:21 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:21 INFO DAGScheduler: Registering RDD 271 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 27
22/07/26 14:21:21 INFO DAGScheduler: Got job 59 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 1 output partitions
22/07/26 14:21:21 INFO DAGScheduler: Final stage: ResultStage 89 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 88)
22/07/26 14:21:21 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 88)
22/07/26 14:21:21 INFO DAGScheduler: Submitting ShuffleMapStage 88 (MapPartitionsRDD[271] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_128 stored as values in memory (estimated size 47.4 KiB, free 318.7 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_128_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 318.7 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_128_piece0 in memory on szcdoc01:37657 (size: 21.4 KiB, free: 359.2 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 128 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 4 missing tasks from ShuffleMapStage 88 (MapPartitionsRDD[271] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 88.0 with 4 tasks resource profile 0
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 88.0 (TID 95) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 88.0 (TID 95)
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.0401E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.237E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.332E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.755E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.056E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.0719E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 88.0 (TID 95). 7773 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 1.0 in stage 88.0 (TID 96) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 1.0 in stage 88.0 (TID 96)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 88.0 (TID 95) in 11 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.8237E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.997E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.086E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.664E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.899E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.675E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 1.0 in stage 88.0 (TID 96). 7773 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 2.0 in stage 88.0 (TID 97) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 2.0 in stage 88.0 (TID 97)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 1.0 in stage 88.0 (TID 96) in 8 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.3949E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.184E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.737E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.429E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.239E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.61E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 2.0 in stage 88.0 (TID 97). 7773 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Starting task 3.0 in stage 88.0 (TID 98) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 3.0 in stage 88.0 (TID 98)
22/07/26 14:21:21 INFO TaskSetManager: Finished task 2.0 in stage 88.0 (TID 97) in 10 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.226E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.712E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.191E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.031E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.057E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.086E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO Executor: Finished task 3.0 in stage 88.0 (TID 98). 7773 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Finished task 3.0 in stage 88.0 (TID 98) in 9 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 88.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ShuffleMapStage 88 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.046 s
22/07/26 14:21:21 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:21 INFO DAGScheduler: running: Set()
22/07/26 14:21:21 INFO DAGScheduler: waiting: Set(ResultStage 89)
22/07/26 14:21:21 INFO DAGScheduler: failed: Set()
22/07/26 14:21:21 INFO DAGScheduler: Submitting ResultStage 89 (MapPartitionsRDD[273] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_129 stored as values in memory (estimated size 41.6 KiB, free 318.6 MiB)
22/07/26 14:21:21 INFO MemoryStore: Block broadcast_129_piece0 stored as bytes in memory (estimated size 19.3 KiB, free 318.6 MiB)
22/07/26 14:21:21 INFO BlockManagerInfo: Added broadcast_129_piece0 in memory on szcdoc01:37657 (size: 19.3 KiB, free: 359.2 MiB)
22/07/26 14:21:21 INFO SparkContext: Created broadcast 129 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 89 (MapPartitionsRDD[273] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:21 INFO TaskSchedulerImpl: Adding task set 89.0 with 1 tasks resource profile 0
22/07/26 14:21:21 INFO TaskSetManager: Starting task 0.0 in stage 89.0 (TID 99) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:21 INFO Executor: Running task 0.0 in stage 89.0 (TID 99)
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.0828E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.1063E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:21 INFO DataWritingSparkTask: Writer for partition 0 is committing.
22/07/26 14:21:21 INFO DataWritingSparkTask: Committed partition 0 (task 99, attempt 0, stage 89.0)
22/07/26 14:21:21 INFO Executor: Finished task 0.0 in stage 89.0 (TID 99). 8551 bytes result sent to driver
22/07/26 14:21:21 INFO TaskSetManager: Finished task 0.0 in stage 89.0 (TID 99) in 8 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:21 INFO TaskSchedulerImpl: Removed TaskSet 89.0, whose tasks have all completed, from pool 
22/07/26 14:21:21 INFO DAGScheduler: ResultStage 89 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.013 s
22/07/26 14:21:21 INFO DAGScheduler: Job 59 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 89: Stage finished
22/07/26 14:21:21 INFO DAGScheduler: Job 59 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.061264 s
22/07/26 14:21:21 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 is committing.
22/07/26 14:21:21 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 committed.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1860]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1860]
          :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1860]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1860]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                                                                                                                                                     :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                                                                                                                                                       :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1860]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$Division ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$CaseWhenCoercion ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= 1) AND (cnt#1860L <= 5)))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= 1) AND (cnt#1860L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= 1) AND (cnt#1860L <= 5)))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= 1) AND (cnt#1860L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Sort [cnt#1860L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1860L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Sort [cnt#1860L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1860]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1860L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1860L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:21 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 339
Total time: 0.043946322 seconds
Total number of effective runs: 13
Total time of effective runs: 0.018213624 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001170226 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ReorderJoin ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
             :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                        :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                     :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                          :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :- Filter ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint)))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!            :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                      :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))                                                                                                                                                                                                                                                                                                                                                                         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                           :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!         :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                           :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                  :           :     :     +- Project [d_date_sk#329]
!         :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!         +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.NullPropagation ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
          :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ConstantFolding ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))                                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1860L >= cast(1 as bigint)) AND (cnt#1860L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                       :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.InferFiltersFromConstraints ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Infer Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter (((cnt#1860L >= 1) AND (cnt#1860L <= 5)) AND isnotnull(ss_customer_sk#1157))
!         :  +- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Project [d_date_sk#329]
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     +- Project [s_store_sk#666]
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter (((cnt#1860L >= 1) AND (cnt#1860L <= 5)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
          :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Project [d_date_sk#329]
          :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
          :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [hd_demo_sk#446]
          :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                             +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                             :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     +- Project [s_store_sk#666]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           +- Project [hd_demo_sk#446]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                +- Filter isnotnull(c_customer_sk#154)
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                 
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization after Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!         :  +- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    +- Filter isnotnull(c_customer_sk#154)
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.RewritePredicateSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch RewriteSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1860L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1860L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1860L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 309
Total time: 0.053997923 seconds
Total number of effective runs: 11
Total time of effective runs: 0.00674708 seconds
      
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(ss_sold_date_sk),IsNotNull(ss_store_sk),IsNotNull(ss_hdemo_sk),IsNotNull(ss_customer_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(ss_sold_date_sk#1154),isnotnull(ss_store_sk#1161),isnotnull(ss_hdemo_sk#1159),isnotnull(ss_customer_sk#1157)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<ss_sold_date_sk: int, ss_customer_sk: int, ss_hdemo_sk: int, ss_store_sk: int, ss_ticket_number: int ... 3 more fields>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(d_dom),GreaterThanOrEqual(d_dom,1),LessThanOrEqual(d_dom,2),In(d_year, [1999,2000,2001]),IsNotNull(d_date_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(d_dom#338),(d_dom#338 >= 1),(d_dom#338 <= 2),d_year#335 IN (1999,2000,2001),isnotnull(d_date_sk#329)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<d_date_sk: int, d_year: int, d_dom: int ... 1 more fields>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]),IsNotNull(s_store_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County),isnotnull(s_store_sk#666)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<s_store_sk: int, s_county: string>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(hd_vehicle_count),Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknown)),GreaterThan(hd_vehicle_count,0),IsNotNull(hd_demo_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(hd_vehicle_count#450),((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)),(hd_vehicle_count#450 > 0),(CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0),isnotnull(hd_demo_sk#446)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<hd_demo_sk: int, hd_buy_potential: string, hd_dep_count: int, hd_vehicle_count: int ... 2 more fields>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(c_customer_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(c_customer_sk#154)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<c_customer_sk: int, c_salutation: string, c_first_name: string, c_last_name: string, c_preferred_cust_flag: string ... 3 more fields>
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.RemoveRedundantProjects ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c
 +- Sort [cnt#1860L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1860L DESC NULLS LAST], true, 0
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
       +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
          :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
          :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])
          :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])
          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
          :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
          :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>            :              :     :     +- Project [d_date_sk#329]
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :              :     +- Project [s_store_sk#666]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :              +- Project [hd_demo_sk#446]
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   +- Filter isnotnull(c_customer_sk#154)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                   
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c                                                                                                                                                                                                                                                                                                                                                                                                                                                         OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c
 +- Sort [cnt#1860L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Sort [cnt#1860L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Exchange rangepartitioning(cnt#1860L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1190]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
!         :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1182]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1169]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :        +- Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1173]
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                 :        +- Project [s_store_sk#666]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1177]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                    +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1186]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c
 +- Sort [cnt#1860L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Sort [cnt#1860L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1860L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1190]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Exchange rangepartitioning(cnt#1860L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1222]
       +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
          +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
             :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
             :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1182]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1214]
             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])
             :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
             :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
             :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
             :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
             :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
             :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :  +- ColumnarToRow
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1169]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1198]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :        +- Project [d_date_sk#329]
!            :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1173]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :     :              +- ColumnarToRow
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1204]
!            :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :        +- Project [s_store_sk#666]
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1177]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :              +- ColumnarToRow
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                 :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1210]
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1186]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                    +- Project [hd_demo_sk#446]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                  +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                          +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1219]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c
!+- Sort [cnt#1860L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- *(7) Sort [cnt#1860L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1860L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1222]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- Exchange rangepartitioning(cnt#1860L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1270]
!      +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
!         +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!            :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- *(6) Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!            :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1214]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1257]
!            :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])
!            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!            :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :  +- *(4) ColumnarToRow
             :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1198]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1233]
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :        +- *(1) Project [d_date_sk#329]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :              +- *(1) ColumnarToRow
             :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1204]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1242]
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :        +- *(2) Project [s_store_sk#666]
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                 :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :              +- *(2) ColumnarToRow
             :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1210]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1251]
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                    +- *(3) Project [hd_demo_sk#446]
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!            :                          +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                          +- *(3) ColumnarToRow
             :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1219]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1265]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- *(5) Filter isnotnull(c_customer_sk#154)
!                  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- *(5) ColumnarToRow
                      +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                                        +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@3be4e71c
!+- Sort [cnt#1860L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- *(7) Sort [cnt#1860L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Exchange rangepartitioning(cnt#1860L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1270]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1860L]
!         :- Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :- *(6) Filter ((cnt#1860L >= 1) AND (cnt#1860L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1860L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1257]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1875L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :     :     :  +- *(4) ColumnarToRow
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                         :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1233]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :        +- *(1) Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                             :                 :     :              +- *(1) ColumnarToRow
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                       :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1242]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                      :                 :        +- *(2) Project [s_store_sk#666]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- *(2) ColumnarToRow
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1251]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                    +- *(3) Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                          +- *(3) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1265]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(5) Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- *(5) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.5274E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.925E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.792E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.28E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.614E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.7068E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.339E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.605E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.043E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.311E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.869E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.885E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.029E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.747E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_130 stored as values in memory (estimated size 292.8 KiB, free 318.3 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_131 stored as values in memory (estimated size 293.4 KiB, free 318.0 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_132 stored as values in memory (estimated size 293.1 KiB, free 317.7 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_130_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 317.7 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_131_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 317.7 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_130_piece0 in memory on szcdoc01:37657 (size: 24.9 KiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_131_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 130 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO SparkContext: Created broadcast 131 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_132_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 317.7 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_132_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4225251 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4203787 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:22 INFO SparkContext: Created broadcast 132 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 6037354 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.071E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_133 stored as values in memory (estimated size 293.7 KiB, free 317.4 MiB)
22/07/26 14:21:22 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO DAGScheduler: Got job 60 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:22 INFO DAGScheduler: Final stage: ResultStage 90 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:22 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:22 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:22 INFO DAGScheduler: Submitting ResultStage 90 (MapPartitionsRDD[287] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_133_piece0 stored as bytes in memory (estimated size 25.1 KiB, free 317.4 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_133_piece0 in memory on szcdoc01:37657 (size: 25.1 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_134 stored as values in memory (estimated size 16.3 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 133 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_134_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 9766600 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_134_piece0 in memory on szcdoc01:37657 (size: 6.8 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 134 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 90 (MapPartitionsRDD[287] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 90.0 with 1 tasks resource profile 0
22/07/26 14:21:22 INFO DAGScheduler: Got job 61 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:22 INFO DAGScheduler: Final stage: ResultStage 91 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:22 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:22 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 90.0 (TID 100) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4966 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO DAGScheduler: Submitting ResultStage 91 (MapPartitionsRDD[286] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_135 stored as values in memory (estimated size 14.7 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 90.0 (TID 100)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_135_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_135_piece0 in memory on szcdoc01:37657 (size: 6.1 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 135 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 91 (MapPartitionsRDD[286] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 91.0 with 1 tasks resource profile 0
22/07/26 14:21:22 INFO DAGScheduler: Got job 62 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:22 INFO DAGScheduler: Final stage: ResultStage 92 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:22 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:22 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:22 INFO DAGScheduler: Submitting ResultStage 92 (MapPartitionsRDD[285] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:22 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics/part-00000-329cd03e-c442-4b83-aa62-907c29e73e1c-c000.snappy.parquet, range: 0-30947, partition values: [empty row]
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.436E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.814E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_136 stored as values in memory (estimated size 14.3 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_136_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_136_piece0 in memory on szcdoc01:37657 (size: 6.0 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:22 INFO SparkContext: Created broadcast 136 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 92 (MapPartitionsRDD[285] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 92.0 with 1 tasks resource profile 0
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:22 INFO DAGScheduler: Got job 63 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:22 INFO DAGScheduler: Final stage: ResultStage 93 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:22 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:22 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:22 INFO DAGScheduler: Submitting ResultStage 93 (MapPartitionsRDD[291] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_137 stored as values in memory (estimated size 14.5 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 90.0 (TID 100). 1705 bytes result sent to driver
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_137_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 317.3 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_137_piece0 in memory on szcdoc01:37657 (size: 5.9 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 91.0 (TID 101) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO SparkContext: Created broadcast 137 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 93 (MapPartitionsRDD[291] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 90.0 (TID 100) in 12 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 93.0 with 1 tasks resource profile 0
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 90.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 91.0 (TID 101)
22/07/26 14:21:22 INFO DAGScheduler: ResultStage 90 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.017 s
22/07/26 14:21:22 INFO DAGScheduler: Job 60 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 90: Stage finished
22/07/26 14:21:22 INFO DAGScheduler: Job 60 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.019216 s
22/07/26 14:21:22 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim/part-00000-a413da45-d7c8-4f70-a93b-7e518b0efa89-c000.snappy.parquet, range: 0-1843050, partition values: [empty row]
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_138 stored as values in memory (estimated size 24.0 B, free 317.3 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_138_piece0 stored as bytes in memory (estimated size 120.0 B, free 317.3 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_138_piece0 in memory on szcdoc01:37657 (size: 120.0 B, free: 359.1 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 138 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 91.0 (TID 101). 2124 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 92.0 (TID 102) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4949 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 92.0 (TID 102)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 91.0 (TID 101) in 19 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 91.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO DAGScheduler: ResultStage 91 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.032 s
22/07/26 14:21:22 INFO DAGScheduler: Job 61 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 91: Stage finished
22/07/26 14:21:22 INFO DAGScheduler: Job 61 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.037902 s
22/07/26 14:21:22 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store/part-00000-995b273e-5695-4f66-bbbf-e1737ae46f7e-c000.snappy.parquet, range: 0-9483, partition values: [empty row]
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.2406E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_139 stored as values in memory (estimated size 1028.0 KiB, free 316.3 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_139_piece0 stored as bytes in memory (estimated size 1446.0 B, free 316.3 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_139_piece0 in memory on szcdoc01:37657 (size: 1446.0 B, free: 359.1 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 139 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 92.0 (TID 102). 1872 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 93.0 (TID 103) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 93.0 (TID 103)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 92.0 (TID 102) in 13 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 92.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO DAGScheduler: ResultStage 92 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.041 s
22/07/26 14:21:22 INFO DAGScheduler: Job 62 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 92: Stage finished
22/07/26 14:21:22 INFO DAGScheduler: Job 62 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.050973 s
22/07/26 14:21:22 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer/part-00000-16283de9-1d2e-49c8-993a-bc0ba4e0a35b-c000.snappy.parquet, range: 0-5572296, partition values: [empty row]
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.2072E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_140 stored as values in memory (estimated size 1024.1 KiB, free 315.3 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_140_piece0 stored as bytes in memory (estimated size 325.0 B, free 315.3 MiB)
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_140_piece0 in memory on szcdoc01:37657 (size: 325.0 B, free: 359.1 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 140 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_135_piece0 on szcdoc01:37657 in memory (size: 6.1 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_129_piece0 on szcdoc01:37657 in memory (size: 19.3 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_127_piece0 on szcdoc01:37657 in memory (size: 21.5 KiB, free: 359.1 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_136_piece0 on szcdoc01:37657 in memory (size: 6.0 KiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_134_piece0 on szcdoc01:37657 in memory (size: 6.8 KiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_128_piece0 on szcdoc01:37657 in memory (size: 21.4 KiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block taskresult_103 stored as bytes in memory (estimated size 2.8 MiB, free 312.7 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added taskresult_103 in memory on szcdoc01:37657 (size: 2.8 MiB, free: 356.4 MiB)
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 93.0 (TID 103). 2942727 bytes result sent via BlockManager)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 93.0 (TID 103) in 98 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 93.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO BlockManagerInfo: Removed taskresult_103 on szcdoc01:37657 in memory (size: 2.8 MiB, free: 359.2 MiB)
22/07/26 14:21:22 INFO DAGScheduler: ResultStage 93 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.132 s
22/07/26 14:21:22 INFO DAGScheduler: Job 63 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 93: Stage finished
22/07/26 14:21:22 INFO DAGScheduler: Job 63 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.136776 s
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.3401E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_141 stored as values in memory (estimated size 16.8 MiB, free 298.8 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_141_piece0 stored as bytes in memory (estimated size 3.4 MiB, free 295.4 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_141_piece0 in memory on szcdoc01:37657 (size: 3.4 MiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 141 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.755E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.126E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.821E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.785E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_142 stored as values in memory (estimated size 293.7 KiB, free 295.1 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_142_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 295.1 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_142_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 142 from $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 124086532 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.0171E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:22 INFO DAGScheduler: Registering RDD 295 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 28
22/07/26 14:21:22 INFO DAGScheduler: Got job 64 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 4 output partitions
22/07/26 14:21:22 INFO DAGScheduler: Final stage: ResultStage 95 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:22 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 94)
22/07/26 14:21:22 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 94)
22/07/26 14:21:22 INFO DAGScheduler: Submitting ShuffleMapStage 94 (MapPartitionsRDD[295] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_143 stored as values in memory (estimated size 45.9 KiB, free 295.0 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_143_piece0 stored as bytes in memory (estimated size 19.6 KiB, free 295.0 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_143_piece0 in memory on szcdoc01:37657 (size: 19.6 KiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 143 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 94 (MapPartitionsRDD[295] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 94.0 with 1 tasks resource profile 0
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 94.0 (TID 104) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 94.0 (TID 104)
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.6456E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.675E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.409E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.455E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.687E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.762E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.251E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales/part-00000-83a64231-9071-4db5-b73a-3b9af3882d7f-c000.snappy.parquet, range: 0-119892228, partition values: [empty row]
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:22 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 94.0 (TID 104). 5409 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 94.0 (TID 104) in 207 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 94.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO DAGScheduler: ShuffleMapStage 94 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.212 s
22/07/26 14:21:22 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:22 INFO DAGScheduler: running: Set()
22/07/26 14:21:22 INFO DAGScheduler: waiting: Set(ResultStage 95)
22/07/26 14:21:22 INFO DAGScheduler: failed: Set()
22/07/26 14:21:22 INFO DAGScheduler: Submitting ResultStage 95 (MapPartitionsRDD[300] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_144 stored as values in memory (estimated size 47.7 KiB, free 295.0 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_144_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 295.0 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_144_piece0 in memory on szcdoc01:37657 (size: 21.4 KiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 144 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 4 missing tasks from ResultStage 95 (MapPartitionsRDD[300] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 95.0 with 4 tasks resource profile 0
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 95.0 (TID 105) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 95.0 (TID 105)
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.996E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.213E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.343E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.635E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.812E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 95.0 (TID 105). 7730 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 1.0 in stage 95.0 (TID 106) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 1.0 in stage 95.0 (TID 106)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 95.0 (TID 105) in 8 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.376E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.465E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.302E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.76E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.558E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 1.0 in stage 95.0 (TID 106). 7730 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 2.0 in stage 95.0 (TID 107) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 2.0 in stage 95.0 (TID 107)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 1.0 in stage 95.0 (TID 106) in 7 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.842E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.102E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.132E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.128E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.16E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 2.0 in stage 95.0 (TID 107). 7730 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 3.0 in stage 95.0 (TID 108) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 3.0 in stage 95.0 (TID 108)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 2.0 in stage 95.0 (TID 107) in 9 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.943E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.343E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.142E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.47E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.571E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 3.0 in stage 95.0 (TID 108). 7730 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Finished task 3.0 in stage 95.0 (TID 108) in 7 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 95.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO DAGScheduler: ResultStage 95 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.035 s
22/07/26 14:21:22 INFO DAGScheduler: Job 64 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 95: Stage finished
22/07/26 14:21:22 INFO DAGScheduler: Job 64 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.250441 s
22/07/26 14:21:22 INFO OverwriteByExpressionExec: Start processing data source write support: org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1. The input RDD has 1 partitions.
22/07/26 14:21:22 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:22 INFO DAGScheduler: Registering RDD 301 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 29
22/07/26 14:21:22 INFO DAGScheduler: Got job 65 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 1 output partitions
22/07/26 14:21:22 INFO DAGScheduler: Final stage: ResultStage 98 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:22 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 97)
22/07/26 14:21:22 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 97)
22/07/26 14:21:22 INFO DAGScheduler: Submitting ShuffleMapStage 97 (MapPartitionsRDD[301] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_145 stored as values in memory (estimated size 47.5 KiB, free 294.9 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_145_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 294.9 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_145_piece0 in memory on szcdoc01:37657 (size: 21.4 KiB, free: 355.7 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 145 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 4 missing tasks from ShuffleMapStage 97 (MapPartitionsRDD[301] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 97.0 with 4 tasks resource profile 0
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 97.0 (TID 109) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 97.0 (TID 109)
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.6878E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.471E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.664E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.259E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.583E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.686E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 97.0 (TID 109). 7773 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 1.0 in stage 97.0 (TID 110) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 1.0 in stage 97.0 (TID 110)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 97.0 (TID 109) in 8 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.713E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.97E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.628E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.361E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.348E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.458E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 1.0 in stage 97.0 (TID 110). 7773 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 2.0 in stage 97.0 (TID 111) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 2.0 in stage 97.0 (TID 111)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 1.0 in stage 97.0 (TID 110) in 10 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.2292E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.142E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.088E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.268E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.706E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.578E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 2.0 in stage 97.0 (TID 111). 7773 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Starting task 3.0 in stage 97.0 (TID 112) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 3.0 in stage 97.0 (TID 112)
22/07/26 14:21:22 INFO TaskSetManager: Finished task 2.0 in stage 97.0 (TID 111) in 7 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.274E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.312E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.793E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.177E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.95E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.9E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO Executor: Finished task 3.0 in stage 97.0 (TID 112). 7773 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Finished task 3.0 in stage 97.0 (TID 112) in 8 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 97.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO DAGScheduler: ShuffleMapStage 97 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.039 s
22/07/26 14:21:22 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:22 INFO DAGScheduler: running: Set()
22/07/26 14:21:22 INFO DAGScheduler: waiting: Set(ResultStage 98)
22/07/26 14:21:22 INFO DAGScheduler: failed: Set()
22/07/26 14:21:22 INFO DAGScheduler: Submitting ResultStage 98 (MapPartitionsRDD[303] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_146 stored as values in memory (estimated size 41.6 KiB, free 294.9 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_146_piece0 stored as bytes in memory (estimated size 19.4 KiB, free 294.8 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Added broadcast_146_piece0 in memory on szcdoc01:37657 (size: 19.4 KiB, free: 355.7 MiB)
22/07/26 14:21:22 INFO SparkContext: Created broadcast 146 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 98 (MapPartitionsRDD[303] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:22 INFO TaskSchedulerImpl: Adding task set 98.0 with 1 tasks resource profile 0
22/07/26 14:21:22 INFO TaskSetManager: Starting task 0.0 in stage 98.0 (TID 113) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:22 INFO Executor: Running task 0.0 in stage 98.0 (TID 113)
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:22 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 8.262E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 9.814E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO DataWritingSparkTask: Writer for partition 0 is committing.
22/07/26 14:21:22 INFO DataWritingSparkTask: Committed partition 0 (task 113, attempt 0, stage 98.0)
22/07/26 14:21:22 INFO Executor: Finished task 0.0 in stage 98.0 (TID 113). 8551 bytes result sent to driver
22/07/26 14:21:22 INFO TaskSetManager: Finished task 0.0 in stage 98.0 (TID 113) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:22 INFO TaskSchedulerImpl: Removed TaskSet 98.0, whose tasks have all completed, from pool 
22/07/26 14:21:22 INFO DAGScheduler: ResultStage 98 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.011 s
22/07/26 14:21:22 INFO DAGScheduler: Job 65 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 98: Stage finished
22/07/26 14:21:22 INFO DAGScheduler: Job 65 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.052980 s
22/07/26 14:21:22 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 is committing.
22/07/26 14:21:22 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 committed.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1876]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1876]
          :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1876]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1876]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                                                                                                                                                     :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                                                                                                                                                       :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveFunctions ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1876]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$Division ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (hd_dep_count#449 / hd_vehicle_count#450) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]
          :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$CaseWhenCoercion ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))
       +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- 'Join Inner
          :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- 'SubqueryAlias dj
          :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]
!         :     +- 'Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > 1)) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                   :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                     :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                           +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= 1) AND (cnt#1876L <= 5)))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
    +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= 1) AND (cnt#1876L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= 1) AND (cnt#1876L <= 5)))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.TypeCoercion$ImplicitTypeCasts ===
 'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   'Sort ['cnt DESC NULLS LAST], true
 +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]
!   +- 'Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= 1) AND (cnt#1876L <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_143_piece0 on szcdoc01:37657 in memory (size: 19.6 KiB, free: 355.7 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_146_piece0 on szcdoc01:37657 in memory (size: 19.4 KiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_144_piece0 on szcdoc01:37657 in memory (size: 21.4 KiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_145_piece0 on szcdoc01:37657 in memory (size: 21.4 KiB, free: 355.8 MiB)
22/07/26 14:21:22 INFO BlockManagerInfo: Removed broadcast_137_piece0 on szcdoc01:37657 in memory (size: 5.9 KiB, free: 355.8 MiB)
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Sort [cnt#1876L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.ResolveTimeZone ===
 Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1876L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Resolution ===
!'Sort ['cnt DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Sort [cnt#1876L DESC NULLS LAST], true
!+- 'Project ['c_last_name, 'c_first_name, 'c_salutation, 'c_preferred_cust_flag, 'ss_ticket_number, 'cnt]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
!   +- 'Filter (('ss_customer_sk = 'c_customer_sk) AND (('cnt >= 1) AND ('cnt <= 5)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
!      +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Join Inner
!         :- 'SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- SubqueryAlias dj
!         :  +- 'Aggregate ['ss_ticket_number, 'ss_customer_sk], ['ss_ticket_number, 'ss_customer_sk, 'count(1) AS cnt#1876]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!         :     +- 'Filter ((((('store_sales.ss_sold_date_sk = 'date_dim.d_date_sk) AND ('store_sales.ss_store_sk = 'store.s_store_sk)) AND ('store_sales.ss_hdemo_sk = 'household_demographics.hd_demo_sk)) AND ((('date_dim.d_dom >= 1) AND ('date_dim.d_dom <= 2)) AND (('household_demographics.hd_buy_potential = >10000) OR ('household_demographics.hd_buy_potential = unknown)))) AND ((('household_demographics.hd_vehicle_count > 0) AND (CASE WHEN ('household_demographics.hd_vehicle_count > 0) THEN ('household_demographics.hd_dep_count / 'household_demographics.hd_vehicle_count) ELSE null END > 1)) AND ('date_dim.d_year IN (1999,(1999 + 1),(1999 + 2)) AND 'store.s_county IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!         :        +- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner
!         :           :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :- Join Inner
!         :           :  :- 'Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :  :- Join Inner
!         :           :  :  :- 'UnresolvedRelation [store_sales], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
!         :           :  :  +- 'UnresolvedRelation [date_dim], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :  +- 'UnresolvedRelation [store], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  :  +- SubqueryAlias date_dim
!         :           +- 'UnresolvedRelation [household_demographics], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         +- 'UnresolvedRelation [customer], [], false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :  +- SubqueryAlias store
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- SubqueryAlias household_demographics
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- SubqueryAlias customer
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.CleanupAliases ===
 Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1876L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Cleanup ===
 Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Sort [cnt#1876L DESC NULLS LAST], true
 +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
       +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
          :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :- SubqueryAlias dj
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
          :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner
          :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Join Inner
          :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  :- Join Inner
          :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  :  :- SubqueryAlias store_sales
          :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                  :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  :  +- SubqueryAlias date_dim
          :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                               :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :  +- SubqueryAlias store
          :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                    :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- SubqueryAlias household_demographics
          :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- SubqueryAlias customer
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 339
Total time: 0.034297262 seconds
Total number of effective runs: 13
Total time of effective runs: 0.013319885 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Substitution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Disable Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Simple Sanity Check has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Resolution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Apply Char Padding has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Post-Hoc Resolution has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Normalize Alter Table has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Remove Unresolved Hints has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Nondeterministic has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch UDF has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch UpdateNullability has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Cleanup has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 86
Total time: 0.001010704 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Eliminate Distinct has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.analysis.EliminateSubqueryAliases ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Finish Analysis ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- Join Inner
!            :- SubqueryAlias dj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!            :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
!            :     +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :     +- Join Inner
!            :        +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        :- Join Inner
!            :           :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        :  :- Join Inner
!            :           :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :           :  :  :- SubqueryAlias store_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :           :  :  :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :           :  :  +- SubqueryAlias date_dim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :           :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            :           :  +- SubqueryAlias store                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
!            :           :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                           
!            :           +- SubqueryAlias household_demographics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            :              +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
!            +- SubqueryAlias customer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Union has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch OptimizeLimitZero has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch LocalRelation early has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Pullup Correlated Expressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Subquery has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Replace Operators has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Aggregate has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ReorderJoin ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))
          +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner
             :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))               :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                        :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                     :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                          :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                              
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                        +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :- Filter ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint)))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!            :  +- Join Inner, ((((ss_hdemo_sk#1159 = hd_demo_sk#446) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                      :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :     :- Join Inner, ((ss_store_sk#1161 = s_store_sk#666) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))                                                                                                                                                                                                                                                                                                                                                                         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :     :  :- Join Inner, ((((ss_sold_date_sk#1154 = d_date_sk#329) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :     :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            :     :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!            :     :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!            :     +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                           :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ColumnPruning ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                            +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                        :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!         :     +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        :- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :        :  :- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :        :  :  +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :  :     +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :        :  +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :        :     +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                           :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :        +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                  :           :     :     +- Project [d_date_sk#329]
!         :           +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
!         +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.NullPropagation ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint)))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
          :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double)))                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.ConstantFolding ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint)))                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,(1999 + 1),(1999 + 2)))                                                                                                                                                                                                                                                                                                                                                                                                        :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :           :     +- Project [s_store_sk#666]
          :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > cast(1 as double)))                                                                                                                                                                                                                                        :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization before Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
!      +- Filter ((ss_customer_sk#1157 = c_customer_sk#154) AND ((cnt#1876L >= cast(1 as bigint)) AND (cnt#1876L <= cast(5 as bigint))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!            :- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!            :  +- Filter (((((ss_sold_date_sk#1154 = d_date_sk#329) AND (ss_store_sk#1161 = s_store_sk#666)) AND (ss_hdemo_sk#1159 = hd_demo_sk#446)) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)))) AND (((hd_vehicle_count#450 > 0) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE cast(null as double) END > cast(1 as double))) AND (d_year#335 IN (1999,(1999 + 1),(1999 + 2)) AND s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))            :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :     +- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!            :        :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :        :  :- Join Inner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!            :        :  :  :- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet                                                                                                                     :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        :  :  +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                                                                                                                                  :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!            :        :  +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                                                                                                                       :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :        +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.InferFiltersFromConstraints ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Infer Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                        +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :- Filter isnotnull(ss_customer_sk#1157)
!         :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                    :  +- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!         :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!         :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Filter isnotnull(ss_hdemo_sk#1159)
!         :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                        :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :              :        :- Filter isnotnull(ss_store_sk#1161)
!         :           :     :     :  +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :        +- Filter (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))                                                                                                                                                                                                                                                                                                                                                                                                                    :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)
!         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :        +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                        :              :        :        +- Filter isnotnull(d_date_sk#329)
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                              :              :        :           +- Project [d_date_sk#329]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))
!         :              +- Filter ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))                                                                                                                                                                                                                                                      :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                               :              :        +- Filter isnotnull(s_store_sk#666)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       :              :           +- Project [s_store_sk#666]
!            +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              +- Filter isnotnull(hd_demo_sk#446)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter (((cnt#1876L >= 1) AND (cnt#1876L <= 5)) AND isnotnull(ss_customer_sk#1157))
!         :  +- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Project [d_date_sk#329]
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :     +- Project [s_store_sk#666]
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter (((cnt#1876L >= 1) AND (cnt#1876L <= 5)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                     :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter (isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159))                                                                                                                                                                                                                                                                                                                                                                                                                                                  :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)
          :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Project [d_date_sk#329]
          :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
          :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [hd_demo_sk#446]
          :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                             +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.PushDownPredicates ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                              +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :           :     :- Filter ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                             :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :           :     :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :        :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :           :     :        :  +- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :           :     :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :           :     :           +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :           :     :              +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     +- Project [s_store_sk#666]
!         :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                              :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    :           +- Project [hd_demo_sk#446]
!         :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                      :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                     +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                +- Filter isnotnull(c_customer_sk#154)
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                 
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Operator Optimization after Inferring Filters ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
!         :- Filter isnotnull(ss_customer_sk#1157)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!         :  +- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
!         :     +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
!         :           +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :- Filter isnotnull(ss_hdemo_sk#1159)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
!         :              :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
!         :              :        :- Filter isnotnull(ss_store_sk#1161)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :        :  +- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))
!         :              :        :     +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
!         :              :        :        :- Filter isnotnull(ss_sold_date_sk#1154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :     :     +- Project [d_date_sk#329]
!         :              :        :        :  +- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                            :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))
!         :              :        :        :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
!         :              :        :        +- Filter isnotnull(d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     +- Project [s_store_sk#666]
!         :              :        :           +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        :              +- Filter (isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)))                                                                                                                                                                                                                                                                                                                                                                                         :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
!         :              :        :                 +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                      :           +- Project [hd_demo_sk#446]
!         :              :        +- Filter isnotnull(s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))
!         :              :           +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
!         :              :              +- Filter s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County)                                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
!         :              :                 +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                    +- Filter isnotnull(c_customer_sk#154)
!         :              +- Filter isnotnull(hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
!         :                 +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
!         :                    +- Filter (isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)))                                                                                                                                                                                                             
!         :                       +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                            
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
!            +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                       
!               +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                       
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Push extra predicate through join has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Early Filter and Projection Push-Down has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Join Reorder has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Eliminate Sorts has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Decimal Optimizations has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Distinct Aggregate Rewrite has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Object Expressions Optimization has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch LocalRelation has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Check Cartesian Products has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.catalyst.optimizer.RewritePredicateSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch RewriteSubquery ===
 OverwriteByExpression RelationV2[] noop-table, true, true                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression RelationV2[] noop-table, true, true
 +- Sort [cnt#1876L DESC NULLS LAST], true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Sort [cnt#1876L DESC NULLS LAST], true
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                           +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Join Inner, (ss_customer_sk#1157 = c_customer_sk#154)
          :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
          :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                       :  +- Aggregate [ss_ticket_number#1163, ss_customer_sk#1157], [ss_ticket_number#1163, ss_customer_sk#1157, count(1) AS cnt#1876L]
          :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :     +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- Join Inner, (ss_hdemo_sk#1159 = hd_demo_sk#446)
          :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                   :           :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           :  +- Join Inner, (ss_store_sk#1161 = s_store_sk#666)
          :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)                                                                                                                                                                                                                                                                                                                                                                                                                                                              :           :     :  +- Join Inner, (ss_sold_date_sk#1154 = d_date_sk#329)
          :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                               :           :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#1154) AND ((isnotnull(ss_store_sk#1161) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157)))                                                                                                                                                                                                                                                                                                                                                           :           :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
          :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet            :           :     :     :     +- Relation[ss_sold_date_sk#1154,ss_sold_time_sk#1155,ss_item_sk#1156,ss_customer_sk#1157,ss_cdemo_sk#1158,ss_hdemo_sk#1159,ss_addr_sk#1160,ss_store_sk#1161,ss_promo_sk#1162,ss_ticket_number#1163,ss_quantity#1164,ss_wholesale_cost#1165,ss_list_price#1166,ss_sales_price#1167,ss_ext_discount_amt#1168,ss_ext_sales_price#1169,ss_ext_wholesale_cost#1170,ss_ext_list_price#1171,ss_ext_tax#1172,ss_coupon_amt#1173,ss_net_paid#1174,ss_net_paid_inc_tax#1175,ss_net_profit#1176] parquet
          :           :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :           :     :     +- Project [d_date_sk#329]
!         :           :     :        +- Filter ((isnotnull(d_dom#338) AND (((d_dom#338 >= 1) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001))) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                             :           :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
          :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet                                                                                         :           :     :           +- Relation[d_date_sk#329,d_date_id#330,d_date#331,d_month_seq#332,d_week_seq#333,d_quarter_seq#334,d_year#335,d_dow#336,d_moy#337,d_dom#338,d_qoy#339,d_fy_year#340,d_fy_quarter_seq#341,d_fy_week_seq#342,d_day_name#343,d_quarter_name#344,d_holiday#345,d_weekend#346,d_following_holiday#347,d_first_dom#348,d_last_dom#349,d_same_day_ly#350,d_same_day_lq#351,d_current_day#352,... 4 more fields] parquet
          :           :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :           :     +- Project [s_store_sk#666]
          :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                           :           :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
          :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet                                 :           :           +- Relation[s_store_sk#666,s_store_id#667,s_rec_start_date#668,s_rec_end_date#669,s_closed_date_sk#670,s_store_name#671,s_number_employees#672,s_floor_space#673,s_hours#674,s_manager#675,s_market_id#676,s_geography_class#677,s_market_desc#678,s_market_manager#679,s_division_id#680,s_division_name#681,s_company_id#682,s_company_name#683,s_street_number#684,s_street_name#685,s_street_type#686,s_suite_number#687,s_city#688,s_county#689,... 5 more fields] parquet
          :           +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :           +- Project [hd_demo_sk#446]
!         :              +- Filter ((isnotnull(hd_vehicle_count#450) AND ((((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0))) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                   :              +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
          :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Relation[hd_demo_sk#446,hd_income_band_sk#447,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] parquet
          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                          +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]
             +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Filter isnotnull(c_customer_sk#154)
                +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet                                                                                                                                             +- Relation[c_customer_sk#154,c_customer_id#155,c_current_cdemo_sk#156,c_current_hdemo_sk#157,c_current_addr_sk#158,c_first_shipto_date_sk#159,c_first_sales_date_sk#160,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164,c_birth_day#165,c_birth_month#166,c_birth_year#167,c_birth_country#168,c_login#169,c_email_address#170,c_last_review_date#171] parquet
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch NormalizeFloatingNumbers has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch ReplaceUpdateFieldsExpression has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Optimize Metadata Only Query has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch PartitionPruning has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Pushdown Filters from PartitionPruning has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Cleanup filters that cannot be pushed down has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch Extract Python UDFs has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch User Provided Optimizers has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 309
Total time: 0.050443001 seconds
Total number of effective runs: 11
Total time of effective runs: 0.006172751 seconds
      
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(ss_sold_date_sk),IsNotNull(ss_store_sk),IsNotNull(ss_hdemo_sk),IsNotNull(ss_customer_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(ss_sold_date_sk#1154),isnotnull(ss_store_sk#1161),isnotnull(ss_hdemo_sk#1159),isnotnull(ss_customer_sk#1157)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<ss_sold_date_sk: int, ss_customer_sk: int, ss_hdemo_sk: int, ss_store_sk: int, ss_ticket_number: int ... 3 more fields>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(d_dom),GreaterThanOrEqual(d_dom,1),LessThanOrEqual(d_dom,2),In(d_year, [1999,2000,2001]),IsNotNull(d_date_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(d_dom#338),(d_dom#338 >= 1),(d_dom#338 <= 2),d_year#335 IN (1999,2000,2001),isnotnull(d_date_sk#329)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<d_date_sk: int, d_year: int, d_dom: int ... 1 more fields>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]),IsNotNull(s_store_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County),isnotnull(s_store_sk#666)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<s_store_sk: int, s_county: string>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(hd_vehicle_count),Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknown)),GreaterThan(hd_vehicle_count,0),IsNotNull(hd_demo_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(hd_vehicle_count#450),((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown)),(hd_vehicle_count#450 > 0),(CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0),isnotnull(hd_demo_sk#446)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<hd_demo_sk: int, hd_buy_potential: string, hd_dep_count: int, hd_vehicle_count: int ... 2 more fields>
22/07/26 14:21:22 INFO FileSourceStrategy: Pushed Filters: IsNotNull(c_customer_sk)
22/07/26 14:21:22 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(c_customer_sk#154)
22/07/26 14:21:22 INFO FileSourceStrategy: Output Data Schema: struct<c_customer_sk: int, c_salutation: string, c_first_name: string, c_last_name: string, c_preferred_cust_flag: string ... 3 more fields>
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.RemoveRedundantProjects ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187
 +- Sort [cnt#1876L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Sort [cnt#1876L DESC NULLS LAST], true, 0
    +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
       +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
          :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
          :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])
          :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])
          :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
          :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
          :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
          :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
          :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
          :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>            :              :     :     +- Project [d_date_sk#329]
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :              :     +- Project [s_store_sk#666]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :              +- Project [hd_demo_sk#446]
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   +- Filter isnotnull(c_customer_sk#154)
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                   
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.exchange.EnsureRequirements ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187                                                                                                                                                                                                                                                                                                                                                                                                                                                         OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187
 +- Sort [cnt#1876L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +- Sort [cnt#1876L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- Exchange rangepartitioning(cnt#1876L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1399]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
!         :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1391]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                      :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1378]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :        +- Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                          :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1382]
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                 :        +- Project [s_store_sk#666]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                   :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!         +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1386]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                    +- Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1395]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.ApplyColumnarRulesAndInsertTransitions ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187                                                                                                                                                                                                                                                                                                                                                                                                                                                               OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187
 +- Sort [cnt#1876L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Sort [cnt#1876L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1876L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1399]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- Exchange rangepartitioning(cnt#1876L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1431]
       +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
          +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
             :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
             :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1391]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1423]
             :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])
             :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]
             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
             :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
             :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
             :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
             :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
             :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :  +- ColumnarToRow
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1378]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1407]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :        +- Project [d_date_sk#329]
!            :                 :     :              +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1382]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :     :              +- ColumnarToRow
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1413]
!            :                 :              +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :        +- Project [s_store_sk#666]
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1386]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :              +- ColumnarToRow
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                 :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                          +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1419]
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1395]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                    +- Project [hd_demo_sk#446]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                  +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                          +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1428]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Applying Rule org.apache.spark.sql.execution.CollapseCodegenStages ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187
!+- Sort [cnt#1876L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- *(7) Sort [cnt#1876L DESC NULLS LAST], true, 0
!   +- Exchange rangepartitioning(cnt#1876L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1431]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +- Exchange rangepartitioning(cnt#1876L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1479]
!      +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
!         +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!            :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :- *(6) Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!            :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])
!            :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1423]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1466]
!            :        +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])
!            :           +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!            :              +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!            :                 :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!            :                 :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!            :                 :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!            :                 :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!            :                 :     :     :- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!            :                 :     :     :  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :  +- *(4) ColumnarToRow
             :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1407]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1442]
!            :                 :     :        +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                 :     :        +- *(1) Project [d_date_sk#329]
!            :                 :     :           +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!            :                 :     :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           :                 :     :              +- *(1) ColumnarToRow
             :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                   :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1413]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1451]
!            :                 :        +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :        +- *(2) Project [s_store_sk#666]
!            :                 :           +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            :                 :              +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :              +- *(2) ColumnarToRow
             :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                       :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1419]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1460]
!            :                    +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  :                    +- *(3) Project [hd_demo_sk#446]
!            :                       +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                    :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!            :                          +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :                          +- *(3) ColumnarToRow
             :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1428]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1474]
!               +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +- *(5) Filter isnotnull(c_customer_sk#154)
!                  +- ColumnarToRow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +- *(5) ColumnarToRow
                      +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                                        +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
           
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Result of Batch Preparations ===
 OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187                                                                                                                                                                                                                                                                                                                                                                                                                                                            OverwriteByExpression org.apache.spark.sql.execution.datasources.noop.NoopTable$@15db4dc, [AlwaysTrue()], [], org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$2930/660782448@4528c187
!+- Sort [cnt#1876L DESC NULLS LAST], true, 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +- *(7) Sort [cnt#1876L DESC NULLS LAST], true, 0
!   +- Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +- Exchange rangepartitioning(cnt#1876L DESC NULLS LAST, 4), ENSURE_REQUIREMENTS, [id=#1479]
!      +- BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +- *(6) Project [c_last_name#163, c_first_name#162, c_salutation#161, c_preferred_cust_flag#164, ss_ticket_number#1163, cnt#1876L]
!         :- Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(6) BroadcastHashJoin [ss_customer_sk#1157], [c_customer_sk#154], Inner, BuildRight, false
!         :  +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :- *(6) Filter ((cnt#1876L >= 1) AND (cnt#1876L <= 5))
!         :     +- HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :  +- *(6) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, cnt#1876L])
!         :        +- Project [ss_customer_sk#1157, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :     +- Exchange hashpartitioning(ss_ticket_number#1163, ss_customer_sk#1157, 4), ENSURE_REQUIREMENTS, [id=#1466]
!         :           +- BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :        +- *(4) HashAggregate(keys=[ss_ticket_number#1163, ss_customer_sk#1157], functions=[partial_count(1)], output=[ss_ticket_number#1163, ss_customer_sk#1157, count#1891L])
!         :              :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       :           +- *(4) Project [ss_customer_sk#1157, ss_ticket_number#1163]
!         :              :  +- BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :              +- *(4) BroadcastHashJoin [ss_hdemo_sk#1159], [hd_demo_sk#446], Inner, BuildRight, false
!         :              :     :- Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_ticket_number#1163]
!         :              :     :  +- BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :  +- *(4) BroadcastHashJoin [ss_store_sk#1161], [s_store_sk#666], Inner, BuildRight, false
!         :              :     :     :- Project [ss_sold_date_sk#1154, ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :                 :     :- *(4) Project [ss_customer_sk#1157, ss_hdemo_sk#1159, ss_store_sk#1161, ss_ticket_number#1163]
!         :              :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#1154], [d_date_sk#329], Inner, BuildRight, false
!         :              :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>               :                 :     :     :- *(4) Filter (((isnotnull(ss_sold_date_sk#1154) AND isnotnull(ss_store_sk#1161)) AND isnotnull(ss_hdemo_sk#1159)) AND isnotnull(ss_customer_sk#1157))
!         :              :     :     +- Project [d_date_sk#329]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          :                 :     :     :  +- *(4) ColumnarToRow
!         :              :     :        +- Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :     :     :     +- FileScan parquet [ss_sold_date_sk#1154,ss_customer_sk#1157,ss_hdemo_sk#1159,ss_store_sk#1161,ss_ticket_number#1163] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#1154), isnotnull(ss_store_sk#1161), isnotnull(ss_hdemo_sk#1159), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_store_sk:int,ss_ticket_number:int>
!         :              :     :           +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>                                                                                                                                         :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1442]
!         :              :     +- Project [s_store_sk#666]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :        +- *(1) Project [d_date_sk#329]
!         :              :        +- Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               :                 :     :           +- *(1) Filter ((((isnotnull(d_dom#338) AND (d_dom#338 >= 1)) AND (d_dom#338 <= 2)) AND d_year#335 IN (1999,2000,2001)) AND isnotnull(d_date_sk#329))
!         :              :           +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>                                                                                                                                                             :                 :     :              +- *(1) ColumnarToRow
!         :              +- Project [hd_demo_sk#446]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :                 :     :                 +- FileScan parquet [d_date_sk#329,d_year#335,d_dom#338] Batched: true, DataFilters: [isnotnull(d_dom#338), (d_dom#338 >= 1), (d_dom#338 <= 2), d_year#335 IN (1999,2000,2001), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_dom), GreaterThanOrEqual(d_dom,1), LessThanOrEqual(d_dom,2), In(d_year, [1999,2000,2..., ReadSchema: struct<d_date_sk:int,d_year:int,d_dom:int>
!         :                 +- Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))                                                                                                                                                                                                                                                                                                                       :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1451]
!         :                    +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>                                                      :                 :        +- *(2) Project [s_store_sk#666]
!         +- Project [c_customer_sk#154, c_salutation#161, c_first_name#162, c_last_name#163, c_preferred_cust_flag#164]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 :                 :           +- *(2) Filter (s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#666))
!            +- Filter isnotnull(c_customer_sk#154)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      :                 :              +- *(2) ColumnarToRow
!               +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...                                                                                                                                                                                               :                 :                 +- FileScan parquet [s_store_sk#666,s_county#689] Batched: true, DataFilters: [s_county#689 IN (Williamson County,Franklin Parish,Bronx County,Orange County), isnotnull(s_stor..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/store], PartitionFilters: [], PushedFilters: [In(s_county, [Williamson County,Franklin Parish,Bronx County,Orange County]), IsNotNull(s_store_..., ReadSchema: struct<s_store_sk:int,s_county:string>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#1460]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                    +- *(3) Project [hd_demo_sk#446]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                       +- *(3) Filter ((((isnotnull(hd_vehicle_count#450) AND ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unknown))) AND (hd_vehicle_count#450 > 0)) AND (CASE WHEN (hd_vehicle_count#450 > 0) THEN (cast(hd_dep_count#449 as double) / cast(hd_vehicle_count#450 as double)) ELSE null END > 1.0)) AND isnotnull(hd_demo_sk#446))
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                          +- *(3) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :                             +- FileScan parquet [hd_demo_sk#446,hd_buy_potential#448,hd_dep_count#449,hd_vehicle_count#450] Batched: true, DataFilters: [isnotnull(hd_vehicle_count#450), ((hd_buy_potential#448 = >10000) OR (hd_buy_potential#448 = unk..., Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_vehicle_count), Or(EqualTo(hd_buy_potential,>10000),EqualTo(hd_buy_potential,unknow..., ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_count:int>
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#1474]
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +- *(5) Filter isnotnull(c_customer_sk#154)
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +- *(5) ColumnarToRow
!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +- FileScan parquet [c_customer_sk#154,c_salutation#161,c_first_name#162,c_last_name#163,c_preferred_cust_flag#164] Batched: true, DataFilters: [isnotnull(c_customer_sk#154)], Format: Parquet, Location: InMemoryFileIndex[file:/data/app/spark-tpcds-datagen/tpcds-data-1g/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_c...
          
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 4
Total time: 4.5062E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 4
Total time: 4.5062E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.072E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.546E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.37E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.331E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.638E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 4
Total time: 4.5062E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.0834E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.696E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.805E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.84E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.574E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 8.56E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.719E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.313E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:22 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.763E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_147 stored as values in memory (estimated size 293.7 KiB, free 294.5 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_148 stored as values in memory (estimated size 292.8 KiB, free 294.5 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_150 stored as values in memory (estimated size 293.1 KiB, free 294.0 MiB)
22/07/26 14:21:22 INFO MemoryStore: Block broadcast_149 stored as values in memory (estimated size 293.4 KiB, free 294.0 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_147_piece0 stored as bytes in memory (estimated size 25.1 KiB, free 293.9 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_148_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 293.9 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_147_piece0 in memory on szcdoc01:37657 (size: 25.1 KiB, free: 355.8 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_148_piece0 in memory on szcdoc01:37657 (size: 24.9 KiB, free: 355.8 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 147 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO SparkContext: Created broadcast 148 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 9766600 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4203787 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_150_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 293.9 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_150_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 150 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_149_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 293.9 MiB)
22/07/26 14:21:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 6037354 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_149_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 149 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4225251 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:23 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO DAGScheduler: Got job 66 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:23 INFO DAGScheduler: Final stage: ResultStage 99 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:23 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:23 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:23 INFO DAGScheduler: Submitting ResultStage 99 (MapPartitionsRDD[316] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_151 stored as values in memory (estimated size 14.5 KiB, free 293.9 MiB)
22/07/26 14:21:23 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_151_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_151_piece0 in memory on szcdoc01:37657 (size: 5.9 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 151 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 99 (MapPartitionsRDD[316] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 99.0 with 1 tasks resource profile 0
22/07/26 14:21:23 INFO DAGScheduler: Got job 67 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:23 INFO DAGScheduler: Final stage: ResultStage 100 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:23 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:23 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 99.0 (TID 114) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO DAGScheduler: Submitting ResultStage 100 (MapPartitionsRDD[319] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 99.0 (TID 114)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_152 stored as values in memory (estimated size 14.7 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_152_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/customer/part-00000-16283de9-1d2e-49c8-993a-bc0ba4e0a35b-c000.snappy.parquet, range: 0-5572296, partition values: [empty row]
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_152_piece0 in memory on szcdoc01:37657 (size: 6.1 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 152 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 100 (MapPartitionsRDD[319] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 100.0 with 1 tasks resource profile 0
22/07/26 14:21:23 INFO DAGScheduler: Got job 68 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:23 INFO DAGScheduler: Final stage: ResultStage 101 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:23 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:23 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:23 INFO DAGScheduler: Submitting ResultStage 101 (MapPartitionsRDD[315] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_153 stored as values in memory (estimated size 14.3 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_153_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_153_piece0 in memory on szcdoc01:37657 (size: 6.0 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 153 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 101 (MapPartitionsRDD[315] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 101.0 with 1 tasks resource profile 0
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: noteq(c_customer_sk, null)
22/07/26 14:21:23 INFO DAGScheduler: Got job 69 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) with 1 output partitions
22/07/26 14:21:23 INFO DAGScheduler: Final stage: ResultStage 102 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266)
22/07/26 14:21:23 INFO DAGScheduler: Parents of final stage: List()
22/07/26 14:21:23 INFO DAGScheduler: Missing parents: List()
22/07/26 14:21:23 INFO DAGScheduler: Submitting ResultStage 102 (MapPartitionsRDD[321] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266), which has no missing parents
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_154 stored as values in memory (estimated size 16.3 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_154_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 293.8 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_154_piece0 in memory on szcdoc01:37657 (size: 6.8 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 154 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 102 (MapPartitionsRDD[321] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 102.0 with 1 tasks resource profile 0
22/07/26 14:21:23 INFO MemoryStore: Block taskresult_114 stored as bytes in memory (estimated size 2.8 MiB, free 291.0 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added taskresult_114 in memory on szcdoc01:37657 (size: 2.8 MiB, free: 352.9 MiB)
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 99.0 (TID 114). 2942684 bytes result sent via BlockManager)
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 100.0 (TID 115) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4952 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 100.0 (TID 115)
22/07/26 14:21:23 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/date_dim/part-00000-a413da45-d7c8-4f70-a93b-7e518b0efa89-c000.snappy.parquet, range: 0-1843050, partition values: [empty row]
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(and(noteq(d_dom, null), gteq(d_dom, 1)), lteq(d_dom, 2)), or(or(eq(d_year, 1999), eq(d_year, 2000)), eq(d_year, 2001))), noteq(d_date_sk, null))
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 99.0 (TID 114) in 81 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 99.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO BlockManagerInfo: Removed taskresult_114 on szcdoc01:37657 in memory (size: 2.8 MiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO DAGScheduler: ResultStage 99 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.084 s
22/07/26 14:21:23 INFO DAGScheduler: Job 66 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 99: Stage finished
22/07/26 14:21:23 INFO DAGScheduler: Job 66 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.085501 s
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 100.0 (TID 115). 2124 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 101.0 (TID 116) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4949 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 100.0 (TID 115) in 14 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 101.0 (TID 116)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 100.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.5065E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO DAGScheduler: ResultStage 100 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.084 s
22/07/26 14:21:23 INFO DAGScheduler: Job 67 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 100: Stage finished
22/07/26 14:21:23 INFO DAGScheduler: Job 67 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.088535 s
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.0267E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store/part-00000-995b273e-5695-4f66-bbbf-e1737ae46f7e-c000.snappy.parquet, range: 0-9483, partition values: [empty row]
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_155 stored as values in memory (estimated size 1028.0 KiB, free 292.8 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_155_piece0 stored as bytes in memory (estimated size 1446.0 B, free 292.8 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_155_piece0 in memory on szcdoc01:37657 (size: 1446.0 B, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 155 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_132_piece0 on szcdoc01:37657 in memory (size: 25.0 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_130_piece0 on szcdoc01:37657 in memory (size: 24.9 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_139_piece0 on szcdoc01:37657 in memory (size: 1446.0 B, free: 355.7 MiB)
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(or(or(or(eq(s_county, Binary{"Williamson County"}), eq(s_county, Binary{"Franklin Parish"})), eq(s_county, Binary{"Bronx County"})), eq(s_county, Binary{"Orange County"})), noteq(s_store_sk, null))
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_152_piece0 on szcdoc01:37657 in memory (size: 6.1 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_141_piece0 on szcdoc01:37657 in memory (size: 3.4 MiB, free: 359.1 MiB)
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 101.0 (TID 116). 1915 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 102.0 (TID 117) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4966 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_142_piece0 on szcdoc01:37657 in memory (size: 25.0 KiB, free: 359.1 MiB)
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 101.0 (TID 116) in 24 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 101.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO DAGScheduler: ResultStage 101 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.104 s
22/07/26 14:21:23 INFO DAGScheduler: Job 68 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 101: Stage finished
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 102.0 (TID 117)
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_131_piece0 on szcdoc01:37657 in memory (size: 25.0 KiB, free: 359.1 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_138_piece0 on szcdoc01:37657 in memory (size: 120.0 B, free: 359.1 MiB)
22/07/26 14:21:23 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/household_demographics/part-00000-329cd03e-c442-4b83-aa62-907c29e73e1c-c000.snappy.parquet, range: 0-30947, partition values: [empty row]
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_151_piece0 on szcdoc01:37657 in memory (size: 5.9 KiB, free: 359.2 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_140_piece0 on szcdoc01:37657 in memory (size: 325.0 B, free: 359.2 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Removed broadcast_133_piece0 on szcdoc01:37657 in memory (size: 25.1 KiB, free: 359.2 MiB)
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:23 INFO DAGScheduler: Job 68 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.115806 s
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.2554E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(hd_vehicle_count, null), or(eq(hd_buy_potential, Binary{">10000"}), eq(hd_buy_potential, Binary{"unknown"}))), gt(hd_vehicle_count, 0)), noteq(hd_demo_sk, null))
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_156 stored as values in memory (estimated size 1024.1 KiB, free 315.5 MiB)
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 102.0 (TID 117). 1705 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 102.0 (TID 117) in 10 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 102.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_156_piece0 stored as bytes in memory (estimated size 325.0 B, free 315.5 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_156_piece0 in memory on szcdoc01:37657 (size: 325.0 B, free: 359.2 MiB)
22/07/26 14:21:23 INFO DAGScheduler: ResultStage 102 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:266) finished in 0.110 s
22/07/26 14:21:23 INFO DAGScheduler: Job 69 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:23 INFO SparkContext: Created broadcast 156 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 102: Stage finished
22/07/26 14:21:23 INFO DAGScheduler: Job 69 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266, took 0.118168 s
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_157 stored as values in memory (estimated size 24.0 B, free 315.5 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_157_piece0 stored as bytes in memory (estimated size 120.0 B, free 315.5 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_157_piece0 in memory on szcdoc01:37657 (size: 120.0 B, free: 359.2 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 157 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_158 stored as values in memory (estimated size 16.8 MiB, free 298.7 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_158_piece0 stored as bytes in memory (estimated size 3.4 MiB, free 295.4 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_158_piece0 in memory on szcdoc01:37657 (size: 3.4 MiB, free: 355.8 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 158 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:266
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 7.284E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.882E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.639E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.575E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_159 stored as values in memory (estimated size 293.7 KiB, free 295.1 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_159_piece0 stored as bytes in memory (estimated size 25.0 KiB, free 295.1 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_159_piece0 in memory on szcdoc01:37657 (size: 25.0 KiB, free: 355.8 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 159 from $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 124086532 bytes, open cost is considered as scanning 4194304 bytes.
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.0352E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:23 INFO DAGScheduler: Registering RDD 325 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 30
22/07/26 14:21:23 INFO DAGScheduler: Got job 70 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 4 output partitions
22/07/26 14:21:23 INFO DAGScheduler: Final stage: ResultStage 104 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:23 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 103)
22/07/26 14:21:23 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 103)
22/07/26 14:21:23 INFO DAGScheduler: Submitting ShuffleMapStage 103 (MapPartitionsRDD[325] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_160 stored as values in memory (estimated size 45.9 KiB, free 295.0 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_160_piece0 stored as bytes in memory (estimated size 19.6 KiB, free 295.0 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_160_piece0 in memory on szcdoc01:37657 (size: 19.6 KiB, free: 355.8 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 160 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 103 (MapPartitionsRDD[325] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 103.0 with 1 tasks resource profile 0
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 103.0 (TID 118) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4944 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 103.0 (TID 118)
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.4752E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.556E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.423E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.541E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.786E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.973E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.254E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO FileScanRDD: Reading File path: file:///data/app/spark-tpcds-datagen/tpcds-data-1g/store_sales/part-00000-83a64231-9071-4db5-b73a-3b9af3882d7f-c000.snappy.parquet, range: 0-119892228, partition values: [empty row]
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:23 INFO FilterCompat: Filtering using predicate: and(and(and(noteq(ss_sold_date_sk, null), noteq(ss_store_sk, null)), noteq(ss_hdemo_sk, null)), noteq(ss_customer_sk, null))
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 103.0 (TID 118). 5409 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 103.0 (TID 118) in 211 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 103.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO DAGScheduler: ShuffleMapStage 103 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.214 s
22/07/26 14:21:23 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:23 INFO DAGScheduler: running: Set()
22/07/26 14:21:23 INFO DAGScheduler: waiting: Set(ResultStage 104)
22/07/26 14:21:23 INFO DAGScheduler: failed: Set()
22/07/26 14:21:23 INFO DAGScheduler: Submitting ResultStage 104 (MapPartitionsRDD[330] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_161 stored as values in memory (estimated size 47.7 KiB, free 295.0 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_161_piece0 stored as bytes in memory (estimated size 21.5 KiB, free 294.9 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_161_piece0 in memory on szcdoc01:37657 (size: 21.5 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 161 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 4 missing tasks from ResultStage 104 (MapPartitionsRDD[330] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 104.0 with 4 tasks resource profile 0
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 104.0 (TID 119) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 104.0 (TID 119)
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.985E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 6.104E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.559E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.934E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.56E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 104.0 (TID 119). 7730 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 1.0 in stage 104.0 (TID 120) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 1.0 in stage 104.0 (TID 120)
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 104.0 (TID 119) in 8 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.632E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.302E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.07E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.738E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.924E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 1.0 in stage 104.0 (TID 120). 7730 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 2.0 in stage 104.0 (TID 121) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 2.0 in stage 104.0 (TID 121)
22/07/26 14:21:23 INFO TaskSetManager: Finished task 1.0 in stage 104.0 (TID 120) in 8 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.813E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.467E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.666E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.261E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.669E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 2.0 in stage 104.0 (TID 121). 7730 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 3.0 in stage 104.0 (TID 122) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 3.0 in stage 104.0 (TID 122)
22/07/26 14:21:23 INFO TaskSetManager: Finished task 2.0 in stage 104.0 (TID 121) in 8 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.591E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.444E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.281E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.131E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.065E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 3.0 in stage 104.0 (TID 122). 7730 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Finished task 3.0 in stage 104.0 (TID 122) in 8 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 104.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO DAGScheduler: ResultStage 104 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.035 s
22/07/26 14:21:23 INFO DAGScheduler: Job 70 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 104: Stage finished
22/07/26 14:21:23 INFO DAGScheduler: Job 70 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.252202 s
22/07/26 14:21:23 INFO OverwriteByExpressionExec: Start processing data source write support: org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1. The input RDD has 1 partitions.
22/07/26 14:21:23 INFO SparkContext: Starting job: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77
22/07/26 14:21:23 INFO DAGScheduler: Registering RDD 331 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) as input to shuffle 31
22/07/26 14:21:23 INFO DAGScheduler: Got job 71 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) with 1 output partitions
22/07/26 14:21:23 INFO DAGScheduler: Final stage: ResultStage 107 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77)
22/07/26 14:21:23 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 106)
22/07/26 14:21:23 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 106)
22/07/26 14:21:23 INFO DAGScheduler: Submitting ShuffleMapStage 106 (MapPartitionsRDD[331] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_162 stored as values in memory (estimated size 47.4 KiB, free 294.9 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_162_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 294.9 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_162_piece0 in memory on szcdoc01:37657 (size: 21.4 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 162 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 4 missing tasks from ShuffleMapStage 106 (MapPartitionsRDD[331] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 106.0 with 4 tasks resource profile 0
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 106.0 (TID 123) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 106.0 (TID 123)
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.6528E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.758E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.909E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.192E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.502E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.081E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 106.0 (TID 123). 7773 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 1.0 in stage 106.0 (TID 124) (szcdoc01, executor driver, partition 1, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 106.0 (TID 123) in 9 ms on szcdoc01 (executor driver) (1/4)
22/07/26 14:21:23 INFO Executor: Running task 1.0 in stage 106.0 (TID 124)
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.3157E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.01E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.63E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.331E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.56E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.293E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 1.0 in stage 106.0 (TID 124). 7773 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 2.0 in stage 106.0 (TID 125) (szcdoc01, executor driver, partition 2, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO TaskSetManager: Finished task 1.0 in stage 106.0 (TID 124) in 8 ms on szcdoc01 (executor driver) (2/4)
22/07/26 14:21:23 INFO Executor: Running task 2.0 in stage 106.0 (TID 125)
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.3404E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.022E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 4.092E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.189E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.521E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.535E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 2.0 in stage 106.0 (TID 125). 7773 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Starting task 3.0 in stage 106.0 (TID 126) (szcdoc01, executor driver, partition 3, PROCESS_LOCAL, 4442 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 3.0 in stage 106.0 (TID 126)
22/07/26 14:21:23 INFO TaskSetManager: Finished task 2.0 in stage 106.0 (TID 125) in 8 ms on szcdoc01 (executor driver) (3/4)
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.4219E-5 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 2.058E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.999E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.37E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 1.381E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 3.624E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO Executor: Finished task 3.0 in stage 106.0 (TID 126). 7773 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Finished task 3.0 in stage 106.0 (TID 126) in 9 ms on szcdoc01 (executor driver) (4/4)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 106.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO DAGScheduler: ShuffleMapStage 106 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.039 s
22/07/26 14:21:23 INFO DAGScheduler: looking for newly runnable stages
22/07/26 14:21:23 INFO DAGScheduler: running: Set()
22/07/26 14:21:23 INFO DAGScheduler: waiting: Set(ResultStage 107)
22/07/26 14:21:23 INFO DAGScheduler: failed: Set()
22/07/26 14:21:23 INFO DAGScheduler: Submitting ResultStage 107 (MapPartitionsRDD[333] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77), which has no missing parents
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_163 stored as values in memory (estimated size 41.6 KiB, free 294.8 MiB)
22/07/26 14:21:23 INFO MemoryStore: Block broadcast_163_piece0 stored as bytes in memory (estimated size 19.3 KiB, free 294.8 MiB)
22/07/26 14:21:23 INFO BlockManagerInfo: Added broadcast_163_piece0 in memory on szcdoc01:37657 (size: 19.3 KiB, free: 355.7 MiB)
22/07/26 14:21:23 INFO SparkContext: Created broadcast 163 from broadcast at DAGScheduler.scala:1383
22/07/26 14:21:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 107 (MapPartitionsRDD[333] at $anonfun$runTpcdsQueries$5 at Benchmark.scala:77) (first 15 tasks are for partitions Vector(0))
22/07/26 14:21:23 INFO TaskSchedulerImpl: Adding task set 107.0 with 1 tasks resource profile 0
22/07/26 14:21:23 INFO TaskSetManager: Starting task 0.0 in stage 107.0 (TID 127) (szcdoc01, executor driver, partition 0, PROCESS_LOCAL, 4453 bytes) taskResourceAssignments Map()
22/07/26 14:21:23 INFO Executor: Running task 0.0 in stage 107.0 (TID 127)
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks
22/07/26 14:21:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 5.639E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 WARN PlanChangeLogger: Batch CleanExpressions has no effect.
22/07/26 14:21:23 WARN PlanChangeLogger: 
=== Metrics of Executed Rules ===
Total number of runs: 1
Total time: 8.771E-6 seconds
Total number of effective runs: 0
Total time of effective runs: 0.0 seconds
      
22/07/26 14:21:23 INFO DataWritingSparkTask: Writer for partition 0 is committing.
22/07/26 14:21:23 INFO DataWritingSparkTask: Committed partition 0 (task 127, attempt 0, stage 107.0)
22/07/26 14:21:23 INFO Executor: Finished task 0.0 in stage 107.0 (TID 127). 8551 bytes result sent to driver
22/07/26 14:21:23 INFO TaskSetManager: Finished task 0.0 in stage 107.0 (TID 127) in 7 ms on szcdoc01 (executor driver) (1/1)
22/07/26 14:21:23 INFO TaskSchedulerImpl: Removed TaskSet 107.0, whose tasks have all completed, from pool 
22/07/26 14:21:23 INFO DAGScheduler: ResultStage 107 ($anonfun$runTpcdsQueries$5 at Benchmark.scala:77) finished in 0.012 s
22/07/26 14:21:23 INFO DAGScheduler: Job 71 is finished. Cancelling potential speculative or zombie tasks for this job
22/07/26 14:21:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 107: Stage finished
22/07/26 14:21:23 INFO DAGScheduler: Job 71 finished: $anonfun$runTpcdsQueries$5 at Benchmark.scala:77, took 0.053165 s
22/07/26 14:21:23 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 is committing.
22/07/26 14:21:23 INFO OverwriteByExpressionExec: Data source write support org.apache.spark.sql.execution.datasources.noop.NoopBatchWrite$@3199c2c1 committed.
  Stopped after 3 iterations, 2586 ms

Java HotSpot(TM) 64-Bit Server VM 1.8.0_202-b08 on Linux 4.18.0-348.7.1.el8_5.x86_64
Intel(R) Xeon(R) Platinum 8255C CPU @ 2.50GHz
TPCDS Snappy:                             Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
q73                                                 794            862          72          3.9         259.5       1.0X

22/07/26 14:21:23 INFO SparkContext: Invoking stop() from shutdown hook
22/07/26 14:21:23 INFO SparkUI: Stopped Spark web UI at http://szcdoc01:4040
22/07/26 14:21:23 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
22/07/26 14:21:23 INFO MemoryStore: MemoryStore cleared
22/07/26 14:21:23 INFO BlockManager: BlockManager stopped
22/07/26 14:21:23 INFO BlockManagerMaster: BlockManagerMaster stopped
22/07/26 14:21:23 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
22/07/26 14:21:23 INFO SparkContext: Successfully stopped SparkContext
22/07/26 14:21:23 INFO ShutdownHookManager: Shutdown hook called
22/07/26 14:21:23 INFO ShutdownHookManager: Deleting directory /tmp/spark-303f82f1-048f-4390-9dab-a984bfaf236d
22/07/26 14:21:23 INFO ShutdownHookManager: Deleting directory /tmp/spark-917fad0e-8541-4cee-a581-ea7e73aeecd1
